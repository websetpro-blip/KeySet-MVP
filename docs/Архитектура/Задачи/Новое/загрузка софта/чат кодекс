РґРѕР±Р°РІСЊ РІ Р±Р»РѕРєРµ РџСЂРѕС„РёР»СЊ Chrome РІ РЅРёР¶РЅРµРј РїРѕР»Рµ РїР°РїРєСѓ, РїСЂРё РЅР°Р¶Р°С‚РёРё РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ РїР°РїРєР° РіРґРµ Р»РµР¶Р°С‚ Рё СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ РІСЃРµ РїСЂРѕС„РёР»Рё


РџРµСЂРµС€С‘Р» Рє СЂРµР°Р»РёР·Р°С†РёРё Р±СЌРєРµРЅРґвЂ‘С‡Р°СЃС‚Рё РєРЅРѕРїРєРё В«РћС‚РєСЂС‹С‚СЊ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№В» (РІС‹СЏСЃРЅСЋ, РѕС‚РєСѓРґР° Р±СЂР°С‚СЊ РїСѓС‚СЊ Рё РєР°Рє РµРіРѕ РѕС‚РґР°С‚СЊ/РѕС‚РєСЂС‹С‚СЊ).

СЃР»РµРґСѓР№ РїР°РјСЏС‚РєРµ, РґРµР»Р°Р№ РІ СЋС‚С„8


РЎРґРµР»Р°Р» РїРѕ РїР°РјСЏС‚РєРµ Рё РІ UTFвЂ‘8, С‡С‚Рѕ РёРјРµРЅРЅРѕ РёР·РјРµРЅРёР»РѕСЃСЊ:

Backend: РІ KeySet-MVP/backend/routers/accounts.py (line 1) РґРѕР±Р°РІРёР» СЌРЅРґРїРѕРёРЅС‚ POST /api/accounts/profiles-root/open, РєРѕС‚РѕСЂС‹Р№:

Р±РµСЂС‘С‚ РїСѓС‚СЊ Рє РєР°С‚Р°Р»РѕРіСѓ РїСЂРѕС„РёР»РµР№ РёР· core.app_paths.PROFILES (KeySet-MVP/runtime/profiles);
СЃРѕР·РґР°С‘С‚ РїР°РїРєСѓ РїСЂРё РЅРµРѕР±С…РѕРґРёРјРѕСЃС‚Рё Рё РѕС‚РєСЂС‹РІР°РµС‚ РµС‘ С‡РµСЂРµР· explorer (subprocess.Popen(["explorer", "<РїСѓС‚СЊ>"]));
РІРѕР·РІСЂР°С‰Р°РµС‚ { "status": "ok", "path": "<РїРѕР»РЅС‹Р№ РїСѓС‚СЊ>" }.
Frontend API: РІ KeySet-MVP/frontend/src/modules/accounts/api.ts (line 40):

РґРѕР±Р°РІР»РµРЅ С‚РёРї ProfilesRootResponse { status: string; path: string; };
РґРѕР±Р°РІР»РµРЅР° С„СѓРЅРєС†РёСЏ openProfilesRoot() (POST РЅР° /api/accounts/profiles-root/open);
СЃС‚СЂРѕРєР° РѕС€РёР±РєРё РїСЂРё Р·Р°РіСЂСѓР·РєРµ РєСѓРєРё РёСЃРїСЂР°РІР»РµРЅР° РЅР° РЅРѕСЂРјР°Р»СЊРЅС‹Р№ UTFвЂ‘8: "РќРµ СѓРґР°Р»РѕСЃСЊ Р·Р°РіСЂСѓР·РёС‚СЊ РєСѓРєРё".
UI Р°РєРєР°СѓРЅС‚РѕРІ: РІ KeySet-MVP/frontend/src/modules/accounts/components/AccountSidebar.tsx (line 1):

РёРјРїРѕСЂС‚РёСЂРѕРІР°РЅР° openProfilesRoot РёР· ../api;
РІ BasicTab РїРѕРґ РїРѕР»РµРј В«РџСЂРѕС„РёР»СЊ ChromeВ» РґРѕР±Р°РІР»РµРЅ Р±Р»РѕРє В«РџР°РїРєР° РїСЂРѕС„РёР»РµР№В» СЃ РєРЅРѕРїРєРѕР№ В«РћС‚РєСЂС‹С‚СЊ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№В», РїРѕ РєР»РёРєСѓ РІС‹Р·С‹РІР°РµС‚СЃСЏ openProfilesRoot(), РїСЂРё РѕС€РёР±РєРµ РїРѕРєР°Р·С‹РІР°РµС‚СЃСЏ alert("РќРµ СѓРґР°Р»РѕСЃСЊ РѕС‚РєСЂС‹С‚СЊ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№: ...").
РЎР±РѕСЂРєР°: РІРѕ frontend РІС‹РїРѕР»РЅРµРЅРѕ npm run build (Vite + TypeScript СЃРѕР±СЂР°Р» dist Р±РµР· РѕС€РёР±РѕРє, РєР°Рє РІ Р»РѕРіР°С…).

РћС‚С‡С‘С‚С‹:

Р’ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РћС‚С‡РµС‚/Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md РґРѕР±Р°РІР»РµРЅ Р±Р»РѕРє РїСЂРѕ РЅРѕРІС‹Р№ СЌРЅРґРїРѕРёРЅС‚, APIвЂ‘РѕР±С‘СЂС‚РєСѓ Рё РєРЅРѕРїРєСѓ В«РћС‚РєСЂС‹С‚СЊ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№В».
Р’ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РћС‚С‡РµС‚/Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md РІ СЂР°Р·РґРµР»Рµ 2.1 Р°РєРєР°СѓРЅС‚С‹ РґРѕР±Р°РІР»РµРЅ РїРѕРґРїСѓРЅРєС‚ В«Р”РѕРїРѕР»РЅРµРЅРѕ 2025вЂ‘11вЂ‘14 (Codex)В» СЃ РѕРїРёСЃР°РЅРёРµРј СЌС‚РёС… РёР·РјРµРЅРµРЅРёР№.
РўРµРїРµСЂСЊ РІ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё Р°РєРєР°СѓРЅС‚РѕРІ РІ Р±Р»РѕРєРµ В«РџСЂРѕС„РёР»СЊ ChromeВ» РјРѕР¶РЅРѕ РѕРґРЅРёРј РєР»РёРєРѕРј РѕС‚РєСЂС‹С‚СЊ РѕР±С‰СѓСЋ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№, РіРґРµ Р»РµР¶Р°С‚ Рё СЃРѕР·РґР°СЋС‚СЃСЏ РїСЂРѕС„РёР»Рё Р±СЂР°СѓР·РµСЂР°.

5 files changed
+108
-11

Undo

View all changes
accounts.py
+28
-3

Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md
+4
-0

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+42
-5

api.ts
+13
-1

AccountSidebar.tsx
+21
-2

СЃРјРѕС‚СЂРё СЃРєСЂРёРЅ, РІРѕС‚ СЌС‚Р° СЃРµСЂР°СЏ РєРЅРѕРїРєР° РЅРµ РЅСѓР¶РЅР°, РіРґРµ РёРґРµС‚ РїРѕР»Рµ РїСЂРѕС„РёР»СЏ РѕС‚ РЅРµРіРѕ СЃРїСЂР°РІР° СЃР»РµРґР°Р№ РјР°Р»РµРЅСЊРєСѓСЋ РёРєРѕРЅРєР° РєР°Рє СЃРµР№С‡Р°СЃ РЅР° СЃРµСЂРѕР№ РєРЅРѕРїРєРµ, С‡С‚РѕР±С‹ СЏ РїСЂРё РЅР°Р¶Р°С‚РёРё РЅР° СЌС‚Сѓ РїР°РїРєСѓ РѕС‚РєСЂС‹РІР°Р» РїР°РїРєСѓ - СЃРµР№С‡Р°СЃ РЅР° СЃРєСЂРёРЅРµ РѕС€РёР±РєР°


User attachment
РЎРµР№С‡Р°СЃ РїРѕРІРµРґРµРЅРёРµ С‚Р°РєРѕРµ:

РЎРµСЂР°СЏ РєРЅРѕРїРєР° В«РћС‚РєСЂС‹С‚СЊ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№В» РїРѕРґ РїРѕР»РµРј СЏ СѓР±СЂР°Р».
Р’ Р±Р»РѕРєРµ В«РџСЂРѕС„РёР»СЊ ChromeВ» С‚РµРїРµСЂСЊ СЃРїСЂР°РІР° РІРЅСѓС‚СЂРё РїРѕР»СЏ РїСЂРѕС„РёР»СЊРЅРѕРіРѕ РїСѓС‚Рё РµСЃС‚СЊ РјР°Р»РµРЅСЊРєР°СЏ РєСЂСѓРіР»Р°СЏ РєРЅРѕРїРєР° СЃ РёРєРѕРЅРєРѕР№ РїР°РїРєРё (С‚Р° Р¶Рµ СЃС‚РёР»РёСЃС‚РёРєР°, С‡С‚Рѕ Сѓ В«РіР»Р°Р·Р°В» Сѓ РїР°СЂРѕР»СЏ). РќР°Р¶Р°С‚РёРµ РїРѕ РЅРµР№ РІС‹Р·С‹РІР°РµС‚ openProfilesRoot() Рё РѕС‚РєСЂС‹РІР°РµС‚ РїР°РїРєСѓ РїСЂРѕС„РёР»РµР№.
РќР° backend РґРѕР±Р°РІР»РµРЅ РѕРґРёРЅ РѕР±СЂР°Р±РѕС‚С‡РёРє open_profiles_root, РєРѕС‚РѕСЂС‹Р№ С‚РµРїРµСЂСЊ РїСЂРёРЅРёРјР°РµС‚ РѕР±Р° РјРµС‚РѕРґР°: GET Рё POST РЅР° "/api/accounts/profiles-root/open" (РґРµРєРѕСЂР°С‚РѕСЂС‹ @router.get Рё @router.post), С‚Р°Рє С‡С‚Рѕ 405 Р±РѕР»СЊС€Рµ Р±С‹С‚СЊ РЅРµ РґРѕР»Р¶РЅРѕ, РґР°Р¶Рµ РµСЃР»Рё С„СЂРѕРЅС‚ РіРґРµвЂ‘С‚Рѕ РєСЌС€РёСЂРѕРІР°Р» СЃС‚Р°СЂС‹Р№ СЃРїРѕСЃРѕР± РІС‹Р·РѕРІР°.
Р¤СЂРѕРЅС‚РµРЅРґ РїРµСЂРµСЃРѕР±СЂР°РЅ (npm run build), РѕС‚С‡С‘С‚С‹ РѕР±РЅРѕРІР»РµРЅС‹ РїРѕРґ РЅРѕРІСѓСЋ СЃС…РµРјСѓ.
Р§С‚РѕР±С‹ СѓРІРёРґРµС‚СЊ РёР·РјРµРЅРµРЅРёСЏ Рё РёР·Р±Р°РІРёС‚СЊСЃСЏ РѕС‚ РІРѕР·РјРѕР¶РЅРѕРіРѕ РєСЌС€Р°, РїРµСЂРµР·Р°РїСѓСЃС‚Рё launcher.py Рё Р·Р°РЅРѕРІРѕ РѕС‚РєСЂРѕР№ РѕРєРЅРѕ СЃРѕС„С‚Р°.

4 files changed
+15
-17

Undo

View all changes
accounts.py
+1
-0

Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md
+1
-1

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+3
-5

AccountSidebar.tsx
+10
-11

РІРѕ РєСЂР°СЃР°РІС‡РёРє, С‚РѕР»СЊРєРѕ РїРѕС‡РµРјСѓ РЅРµ РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ РїР°РїРєР° ?


РџСЂРёС‡РёРЅР° РІ СЂРµР°Р»РёР·Р°С†РёРё РѕС‚РєСЂС‹С‚РёСЏ, СЏ РµС‘ РґРѕСЂР°Р±РѕС‚Р°Р»:

РќР° backend open_profiles_root С‚РµРїРµСЂСЊ РїРѕРґ Windows РёСЃРїРѕР»СЊР·СѓРµС‚ СЃРёСЃС‚РµРјРЅС‹Р№ os.startfile(<РїСѓС‚СЊ>), Р° РЅРµ РІС‹Р·РѕРІ explorer С‡РµСЂРµР· subprocess.Popen вЂ” С‚Р°Рє РЅР°РґС‘Р¶РЅРµРµ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ РїСЂРѕРІРѕРґРЅРёРє РёР· С„РѕРЅРѕРІРѕРіРѕ РїСЂРѕС†РµСЃСЃР° uvicorn.
Р­РЅРґРїРѕРёРЅС‚ РїСЂРёРЅРёРјР°РµС‚ Рё GET, Рё POST (/api/accounts/profiles-root/open), РїРѕСЌС‚РѕРјСѓ РѕС€РёР±РѕРє Method Not Allowed Р±РѕР»СЊС€Рµ Р±С‹С‚СЊ РЅРµ РґРѕР»Р¶РЅРѕ.
Р’ UI РїРѕвЂ‘РїСЂРµР¶РЅРµРјСѓ РєР»РёРєР°РµС€СЊ РїРѕ РёРєРѕРЅРєРµ РїР°РїРєРё СЃРїСЂР°РІР° РІ РїРѕР»Рµ В«РџСЂРѕС„РёР»СЊ ChromeВ».
РџРµСЂРµР·Р°РїСѓСЃС‚Рё KeySet-MVP/launcher.py, Р·Р°РєСЂРѕР№ СЃС‚Р°СЂРѕРµ РѕРєРЅРѕ Рё РѕС‚РєСЂРѕР№ РЅРѕРІРѕРµ; РїСЂРё СЃР»РµРґСѓСЋС‰РµРј РЅР°Р¶Р°С‚РёРё РЅР° РёРєРѕРЅРєСѓ РїР°РїРєРё РґРѕР»Р¶РµРЅ РѕС‚РєСЂС‹С‚СЊСЃСЏ KeySet-MVP/runtime/profiles РІ РїСЂРѕРІРѕРґРЅРёРєРµ.

2 files changed
+6
-2

Undo

View all changes
accounts.py
+5
-1

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+1
-1

С‚РѕР¶Рµ СЃР°РјРѕРµ, РµС‰Рµ РІРѕС‚ СЃРєСЂРёРЅ - РЅР°РїСЃС‚СЂРѕР№РєРё РїСЂРѕС„РёР»СЃСЏ РЅРµ РїРѕРґС‚СЏРіРёРІР°СЋС‚СЃСЏ


User attachment
РЎ РїР°РїРєРѕР№ Рё РїСЂРѕС„РёР»РµРј С‚СѓС‚ РґРІРµ СЂР°Р·РЅС‹Рµ РІРµС‰Рё.

РџРѕС‡РµРјСѓ РЅРµ РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ РїР°РїРєР°
РЇ СЃРµР№С‡Р°СЃ РїСЂРѕРІРµСЂРёР» Р¶РёРІРѕР№ backend РЅР° 127.0.0.1 (line 8765) вЂ” РїРѕ Р°РґСЂРµСЃСѓ
/api/accounts/profiles-root/open РѕРЅ РІРѕР·РІСЂР°С‰Р°РµС‚ 404 Not Found.
Р­С‚Рѕ Р·РЅР°С‡РёС‚, С‡С‚Рѕ СЃРµР№С‡Р°СЃ Сѓ С‚РµР±СЏ Р·Р°РїСѓС‰РµРЅР° СЃС‚Р°СЂР°СЏ СЃР±РѕСЂРєР° backend, РІ РєРѕС‚РѕСЂРѕР№ РµС‰С‘ РЅРµС‚ РЅРѕРІРѕРіРѕ СЌРЅРґРїРѕРёРЅС‚Р° profiles-root/open, РєРѕС‚РѕСЂС‹Р№ СЏ РґРѕР±Р°РІРёР» РІ KeySet-MVP/backend/routers/accounts.py.

Р§С‚РѕР±С‹ РёРєРѕРЅРєР° РїР°РїРєРё Р·Р°СЂР°Р±РѕС‚Р°Р»Р°, РЅСѓР¶РЅРѕ РёРјРµРЅРЅРѕ:

РѕСЃС‚Р°РЅРѕРІРёС‚СЊ С‚РµРєСѓС‰РёР№ СЃРѕС„С‚;
Р·Р°РїСѓСЃС‚РёС‚СЊ python launcher.py РёР· РїР°РїРєРё C:\AI\yandex\KeySet-MVP (С‚РѕР№, РіРґРµ СЏ РїСЂР°РІРёР» РєРѕРґ);
РїРѕСЃР»Рµ СЃС‚Р°СЂС‚Р° РµС‰С‘ СЂР°Р· РѕС‚РєСЂС‹С‚СЊ В«РђРєРєР°СѓРЅС‚С‹В» Рё РЅР°Р¶Р°С‚СЊ РЅР° РёРєРѕРЅРєСѓ РїР°РїРєРё СЃРїСЂР°РІР° РІ РїРѕР»Рµ В«РџСЂРѕС„РёР»СЊ ChromeВ».
Р’ РЅРѕРІРѕР№ СЃР±РѕСЂРєРµ РїРѕ РєР»РёРєСѓ РѕС‚РїСЂР°РІР»СЏРµС‚СЃСЏ Р·Р°РїСЂРѕСЃ РЅР° /api/accounts/profiles-root/open, Р° backend РІС‹Р·С‹РІР°РµС‚ os.startfile(<runtime\\profiles>), Рё РїСЂРѕРІРѕРґРЅРёРє РґРѕР»Р¶РµРЅ РѕС‚РєСЂС‹С‚СЊСЃСЏ.

РџРѕС‡РµРјСѓ Р±СЂР°СѓР·РµСЂ Р±РµР· вЂњРЅСѓР¶РЅС‹С…вЂќ РЅР°СЃС‚СЂРѕРµРє РїСЂРѕС„РёР»СЏ
РџРѕ РєРѕРґСѓ СЃРµР№С‡Р°СЃ РґРµР»Р°РµС‚СЃСЏ С‚Р°Рє:

Chrome СЃС‚Р°СЂС‚СѓРµС‚ СЃ РїСЂРѕС„РёР»РµРј РёР· Р‘Р”, РґР»СЏ РїРµСЂРІРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° СЌС‚Рѕ
C:/AI/yandex/.profiles/wordstat_main вЂ” РёРјРµРЅРЅРѕ СЌС‚РѕС‚ РїСѓС‚СЊ РїРµСЂРµРґР°С‘С‚СЃСЏ РІ --user-data-dir=....
РџСЂРѕРєСЃРё Р±РµСЂС‘С‚СЃСЏ РёР· РїРѕР»СЏ proxy Р°РєРєР°СѓРЅС‚Р° (С‚Рѕ, С‡С‚Рѕ РІРёРґРЅРѕ РІ РєРѕР»РѕРЅРєРµ В«РџР РћРљРЎРВ» Рё РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ» СЃРїСЂР°РІР°) Рё РїРµСЂРµРґР°С‘С‚СЃСЏ РІ Chrome С‡РµСЂРµР· --proxy-server + СЂР°СЃС€РёСЂРµРЅРёРµ РґР»СЏ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ.
РћС€РёР±РєР° РЅР° СЃРєСЂРёРЅРµ ERR_TUNNEL_CONNECTION_FAILED РѕР·РЅР°С‡Р°РµС‚, С‡С‚Рѕ СЃР°Рј РїСЂРѕРєСЃРё РїРѕ Р°РґСЂРµСЃСѓ РёР· Р°РєРєР°СѓРЅС‚Р° РЅРµ РѕС‚РІРµС‡Р°РµС‚ / РЅРµ РїСѓСЃРєР°РµС‚, Р° РЅРµ С‚Рѕ, С‡С‚Рѕ РїСЂРѕС„РёР»СЊ РЅРµ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ.

Р•СЃР»Рё С…РѕС‡РµС€СЊ РїСЂРѕРІРµСЂРёС‚СЊ, С‡С‚Рѕ РґРµР»Рѕ РЅРµ РІ РєРѕРґРµ:

РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ» РѕС‡РёСЃС‚Рё СЃС‚СЂРѕРєСѓ СЃ РїСЂРѕРєСЃРё РґР»СЏ Р°РєРєР°СѓРЅС‚Р° (РѕСЃС‚Р°РІСЊ РїСѓСЃС‚РѕР№) Рё РЅР°Р¶РјРё В«РЎРѕС…СЂР°РЅРёС‚СЊВ»;
РїРѕСЃР»Рµ СЌС‚РѕРіРѕ Р·Р°РїСѓСЃС‚Рё Р±СЂР°СѓР·РµСЂ РґР»СЏ СЌС‚РѕРіРѕ Р°РєРєР°СѓРЅС‚Р° РµС‰С‘ СЂР°Р· вЂ” Chrome СЃС‚Р°СЂС‚СѓРµС‚ СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј (.profiles/wordstat_main), РЅРѕ Р±РµР· РїСЂРёРЅСѓРґРёС‚РµР»СЊРЅРѕРіРѕ --proxy-server, Рё Р±СѓРґРµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РЅР°СЃС‚СЂРѕР№РєРё СЃРµС‚Рё, СЃРѕС…СЂР°РЅС‘РЅРЅС‹Рµ РІРЅСѓС‚СЂРё РїСЂРѕС„РёР»СЏ/СЃРёСЃС‚РµРјС‹.
Р’Р°Р¶РЅРѕ: РёР·РјРµРЅРµРЅРёСЏ РїСЂРѕРєСЃРё/Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ СЃРїСЂР°РІР° РЅР°С‡РёРЅР°СЋС‚ РІР»РёСЏС‚СЊ РЅР° Р·Р°РїСѓСЃРє С‚РѕР»СЊРєРѕ РїРѕСЃР»Рµ РЅР°Р¶Р°С‚РёСЏ РєРЅРѕРїРєРё В«РЎРѕС…СЂР°РЅРёС‚СЊВ».

Changed to Chat mode
РЅСѓ РЅР°СЃС‚СЂРѕР№ С‡С‚Рѕ РµС‰Рµ РЅРµ РЅР°СЃС‚СЂРѕРёР» РїРѕ СЌС‚РѕР№ С†РµРїРѕС‡РєРё, РѕРЅР° РµС‰Рµ РЅРµ СЃРѕРІСЃРµРј СЂР°Р±РѕС‡Р°СЏ, СЏ С‚РµР±СЏ РїРµСЂРµРєР»СЋС‡РёР» РЅР° С‡Р°С‚ - РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№ СЌС‚Рё С„Р°Р№Р»С‹, РїРѕСЃРјРѕС‚СЂРё С‡С‚Рѕ РµС‰Рµ РЅРµ РіРѕС‚РѕРІРѕ РёР· Р·Р°РґР°С‡Рё 5


РџРѕ С‚РµРєСѓС‰РµРјСѓ РєРѕРґСѓ С†РµРїРѕС‡РєР° РІС‹РіР»СЏРґРёС‚ С‚Р°Рє Рё РІРѕС‚ С‡С‚Рѕ РІ РЅРµР№ РµС‰С‘ РЅРµ РґРѕРґРµР»Р°РЅРѕ.

Р§С‚Рѕ СѓР¶Рµ СЂРµР°Р»СЊРЅРѕ СЂР°Р±РѕС‚Р°РµС‚

РџСЂРё РЅР°Р¶Р°С‚РёРё Play РІ С‚Р°Р±Р»РёС†Рµ Р°РєРєР°СѓРЅС‚РѕРІ РІС‹Р·С‹РІР°РµС‚СЃСЏ launchAccount(id) в†’ POST /api/accounts/{id}/launch (KeySet-MVP/frontend/src/modules/accounts/index.tsx, backend/routers/accounts.py (line 118)).
Р‘СЌРєРµРЅРґ Р±РµСЂС‘С‚ Р°РєРєР°СѓРЅС‚ РёР· Р‘Р” С‡РµСЂРµР· services.accounts.get_account, Р·Р°РїСѓСЃРєР°РµС‚ Chrome С‡РµСЂРµР· ChromeLauncher.launch(...) СЃ:
--user-data-dir=<account.profile_path> (РїРѕСЃР»Рµ РЅРѕСЂРјР°Р»РёР·Р°С†РёРё, СЃРµР№С‡Р°СЃ РґР»СЏ dsmismirnov СЌС‚Рѕ C:/AI/yandex/.profiles/wordstat_main вЂ“ СЃРј. services/chrome_launcher.py Рё РїСЂРѕРІРµСЂРєСѓ Normalized РёР· python -c),
--proxy-server=... РїРѕ СЃС‚СЂРѕРєРµ account.proxy СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј.
РџСЂР°РІР°СЏ РїР°РЅРµР»СЊ:
РІРєР»Р°РґРєР° В«РЎРµС‚СЊВ» С‡РµСЂРµР· onUpdateAccount в†’ accountToUpdatePayload СЃРѕС…СЂР°РЅСЏРµС‚ proxy, proxyUsername, proxyPassword, proxyType РІ notes Рё РїРѕР»Рµ proxy РІ Р‘Р” (frontend/src/modules/accounts/components/AccountSidebar.tsx, mapper.ts, services/accounts.update_account);
РІРєР»Р°РґРєР° Fingerprint СЃРѕС…СЂР°РЅСЏРµС‚ РїСЂРµСЃРµС‚ РІ notes.fingerprint, РєРѕС‚РѕСЂС‹Р№ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ С‡РёС‚Р°РµС‚ РІ _extract_fingerprint (services/wordstat_multiparser.py);
В«РђРІС‚РѕР»РѕРіРёРЅ Рё СЃРѕС…СЂР°РЅРёС‚СЊ cookiesВ» Рё В«Р—Р°РіСЂСѓР·РёС‚СЊ РєСѓРєРёВ» СЂР°Р±РѕС‚Р°СЋС‚ С‡РµСЂРµР· /api/accounts/{id}/autologin Рё /api/accounts/{id}/cookies.
РўРѕ РµСЃС‚СЊ: РїСѓС‚СЊ РїСЂРѕС„РёР»СЏ, РїСЂРѕРєСЃРё Рё fingerprint СЂРµР°Р»СЊРЅРѕ СѓС‡Р°СЃС‚РІСѓСЋС‚ РІ Р·Р°РїСѓСЃРєРµ Р±СЂР°СѓР·РµСЂР° Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°. РћС€РёР±РєР° ERR_TUNNEL_CONNECTION_FAILED РЅР° СЃРєСЂРёРЅРµ вЂ” СЌС‚Рѕ РёРјРµРЅРЅРѕ РїСЂРѕР±Р»РµРјР° РїСЂРѕРєСЃРё (host/port/Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РёР»Рё С‚РёРї РїСЂРѕС‚РѕРєРѕР»Р°), Р° РЅРµ С‚Рѕ, С‡С‚Рѕ РїСЂРѕС„РёР»СЊ РЅРµ РїРѕРґС…РІР°С‚РёР»СЃСЏ.

Р§С‚Рѕ РІ С†РµРїРѕС‡РєРµ РµС‰С‘ РЅРµ РґРѕРґРµР»Р°РЅРѕ РїРѕ Р·Р°РґР°С‡Рµ 5

РњРµРЅРµРґР¶РµСЂ РїСЂРѕРєСЃРё (РїСЂР°РІР°СЏ РїР°РЅРµР»СЊ в†’ backend)

Р’ frontend/src/modules/accounts/api.ts РµСЃС‚СЊ PROXIES_URL = ${API_BASE}/proxies Рё testProxy(...), РЅРѕ РІ backend РЅРµС‚ СЂРѕСѓС‚РµСЂР° /api/proxies/* вЂ” СЌС‚Рѕ С‡РёСЃС‚Р°СЏ Р·Р°РіР»СѓС€РєР° (РІРєР»Р°РґРєР° В«РњРµРЅРµРґР¶РµСЂ РїСЂРѕРєСЃРёВ» С‚РѕР¶Рµ С‚РѕР»СЊРєРѕ UI).
РљРЅРѕРїРєР° В«РўРµСЃС‚ РїСЂРѕРєСЃРёВ» РІ NetworkTab СЃРµР№С‡Р°СЃ РїСЂРёРЅСѓРґРёС‚РµР»СЊРЅРѕ disabled.
Р§С‚РѕР±С‹ РґРѕРІРµСЃС‚Рё РґРѕ РўР—, РЅСѓР¶РµРЅ backend/routers/proxies.py + СЃРІСЏР·РєР° СЃ services.proxy_manager.ProxyManager Рё services.accounts.test_proxy, Рё РїРµСЂРµРїРѕРґРєР»СЋС‡РµРЅРёРµ РєРЅРѕРїРѕРє РІ UI.
CaptchaвЂ‘СЃРµСЂРІРёСЃС‹

Р’РєР»Р°РґРєР° В«РљР°РїС‡Р°В» РІ AccountSidebar.tsx РїРѕР»РЅРѕСЃС‚СЊСЋ СЃС‚Р°С‚РёС‡РЅР°: Р·РЅР°С‡РµРЅРёСЏ РЅРµ СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ Рё РЅРёРєСѓРґР° РЅРµ РїРµСЂРµРґР°СЋС‚СЃСЏ; РІ backend РЅРµС‚ С…СЂР°РЅРµРЅРёСЏ РєР»СЋС‡РµР№ Рё РєР»РёРµРЅС‚Р° RuCaptcha/2Captcha/AntiCaptcha.
Р’ Р·Р°РґР°С‡Рµ 5 СЌС‚Рѕ С‡Р°СЃС‚СЊ Р°РЅС‚РёвЂ‘РїР°Р»РµРІРѕ С†РµРїРѕС‡РєРё (СѓСЃС‚РѕР№С‡РёРІС‹Р№ РїР°СЂСЃРёРЅРі СЃ СЂРµС€РµРЅРёРµРј РєР°РїС‡Рё) вЂ” СЃРµР№С‡Р°СЃ СЌС‚Рѕ РЅРµ СЂРµР°Р»РёР·РѕРІР°РЅРѕ РІРѕРѕР±С‰Рµ.
РЎС‚Р°С‚СѓСЃС‹ Р°РєРєР°СѓРЅС‚РѕРІ РїСЂРё Р±Р°РЅР°С…/РѕС€РёР±РєР°С…

Р’ services/accounts.py РµСЃС‚СЊ СЃС‚Р°С‚СѓСЃС‹ ok/cooldown/captcha/error Рё С„СѓРЅРєС†РёРё mark_captcha, mark_cooldown, mark_error, РЅРѕ:
UI РЅРµ РґР°С‘С‚ РїРѕРјРµС‡Р°С‚СЊ Р°РєРєР°СѓРЅС‚ РІСЂСѓС‡РЅСѓСЋ РєР°Рє banned/captcha/cooldown;
РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ (services/multiparser_manager.py, services/wordstat_multiparser.py) РїРѕРєР° РїРѕРјРµС‡Р°РµС‚ РїСЂРѕР±Р»РµРјРЅС‹Рµ Р°РєРєР°СѓРЅС‚С‹ С‚РѕР»СЊРєРѕ РєР°Рє error (Рё С‚Рѕ РїРѕ Р¶С‘СЃС‚РєРёРј СѓСЃР»РѕРІРёСЏРј), Р±РµР· РѕС‚РґРµР»СЊРЅРѕРіРѕ СЃС‚Р°С‚СѓСЃР° В«Р±Р°РЅВ».
РџРѕ РўР— РЅСѓР¶РЅРѕ: СЏСЃРЅР°СЏ Р»РѕРіРёРєР°, РєРѕРіРґР° Р°РєРєР°СѓРЅС‚ СЃС‚Р°РЅРѕРІРёС‚СЃСЏ banned Рё РїРµСЂРµСЃС‚Р°С‘С‚ СѓС‡Р°СЃС‚РІРѕРІР°С‚СЊ РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ, РїР»СЋСЃ РѕС‚РѕР±СЂР°Р¶РµРЅРёРµ СЌС‚РѕРіРѕ СЃС‚Р°С‚СѓСЃР° РІРѕ РІРєР»Р°РґРєРµ В«РђРєРєР°СѓРЅС‚С‹В».
ProxyвЂ‘С†РµРїРѕС‡РєР° РґРѕ РєРѕРЅС†Р° РЅРµ РґРѕРІРµРґРµРЅР°

РЎРµР№С‡Р°СЃ UI В«РЎРµС‚СЊВ» СЃРѕС…СЂР°РЅСЏРµС‚ РѕРґРёРЅ proxyвЂ‘URI РЅР° Р°РєРєР°СѓРЅС‚; РїСЂРѕРґРІРёРЅСѓС‚С‹Рµ РІРµС‰Рё РёР· РўР— вЂ” РїСѓР» РїСЂРѕРєСЃРё, Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєР°СЏ СЂРѕС‚Р°С†РёСЏ, РїР°СЂСЃРёРЅРі СЃ СЃР°Р№С‚РѕРІ вЂ” РЅРµ СЂРµР°Р»РёР·РѕРІР°РЅС‹ (СЃРј. Р·Р°РіР»СѓС€РєРё РІ AccountSidebar.tsx Рё РѕС‚СЃСѓС‚СЃС‚РІРёРµ СЃРѕРѕС‚РІРµС‚СЃС‚РІСѓСЋС‰РёС… API).
РњСѓР»СЊС‚РёРїР°СЂСЃРµСЂ РёСЃРїРѕР»СЊР·СѓРµС‚ С‚РѕР»СЊРєРѕ account.proxy РєР°Рє РµСЃС‚СЊ, Р±РµР· СѓС‡С‘С‚Р° proxy_strategy Рё proxy_id (РѕРЅРё РµСЃС‚СЊ РІ РјРѕРґРµР»Рё, РЅРѕ РІ wordstat_multiparser._load_profiles() РЅРµ РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ).
РРЅС‚РµРіСЂР°С†РёСЏ СЃС‚Р°СЂРѕРіРѕ WordstatвЂ‘API Рё РЅРѕРІРѕРіРѕ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°

Р’ backend/routers/wordstat.py РІСЃС‘ РµС‰С‘ Р¶РёРІС‘С‚ СЃС‚Р°СЂС‹Р№ /api/wordstat/collect, РєРѕС‚РѕСЂС‹Р№ СЂР°Р±РѕС‚Р°РµС‚ СЃ РµРґРёРЅРёС‡РЅС‹Рј РїСЂРѕС„РёР»РµРј/Р°РєРєР°СѓРЅС‚РѕРј (С‡РµСЂРµР· wordstat_bridge/turbo_wordstat_service), Рё РЅРѕРІС‹Р№ /api/wordstat/multi-collect, РєРѕС‚РѕСЂС‹Р№ РёСЃРїРѕР»СЊР·СѓРµС‚ РІСЃРµ СЂР°Р±РѕС‡РёРµ Р°РєРєР°СѓРЅС‚С‹.
Р’ UI Wordstat РјРѕРґР°Р»РєРё СѓР¶Рµ С…РѕРґСЏС‚ РЅР° multi-collect, РЅРѕ:
РЅРµС‚ СЏРІРЅРѕР№ РёРЅРґРёРєР°С†РёРё, РєР°РєРёРµ Р°РєРєР°СѓРЅС‚С‹ СЂРµР°Р»СЊРЅРѕ РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ Рё РєР°РєРёРµ СѓРїР°Р»Рё СЃ РѕС€РёР±РєРѕР№/Р±Р°РЅРѕРј;
РЅРµС‚ СЃРІСЏР·РєРё РјРµР¶РґСѓ СЂРµР·СѓР»СЊС‚Р°С‚Р°РјРё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР° Рё РѕР±РЅРѕРІР»РµРЅРёРµРј СЃС‚Р°С‚СѓСЃРѕРІ Р°РєРєР°СѓРЅС‚РѕРІ (РєСЂРѕРјРµ РјРёРЅРёРјР°Р»СЊРЅРѕР№ Р»РѕРіРёРєРё В«errorВ»).
Р§С‚Рѕ РІР°Р¶РЅРѕ РґР»СЏ С‚РІРѕРµР№ С‚РµРєСѓС‰РµР№ РїСЂРѕР±Р»РµРјС‹

РџСЂРѕС„РёР»СЊ РґРµР№СЃС‚РІРёС‚РµР»СЊРЅРѕ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ: ChromeLauncher._normalise_profile_path РґР»СЏ C:/AI/yandex/.profiles/wordstat_main РІРѕР·РІСЂР°С‰Р°РµС‚ РёРјРµРЅРЅРѕ СЌС‚РѕС‚ РїСѓС‚СЊ, Рё РѕРЅ РїРµСЂРµРґР°С‘С‚СЃСЏ РІ --user-data-dir.
ERR_TUNNEL РіРѕРІРѕСЂРёС‚ РёРјРµРЅРЅРѕ Рѕ РїСЂРѕРєСЃРё вЂ” РїСЂРѕРІРµСЂСЊ, С‡С‚Рѕ РґР»СЏ С‚РµРєСѓС‰РµРіРѕ Р°РєРєР°СѓРЅС‚Р° РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ» СЃРѕС…СЂР°РЅС‘РЅ Р¶РёРІРѕР№ РїСЂРѕРєСЃРё (РјРѕР¶РЅРѕ РІСЂРµРјРµРЅРЅРѕ РѕС‡РёСЃС‚РёС‚СЊ РїРѕР»СЏ, РЅР°Р¶Р°С‚СЊ В«РЎРѕС…СЂР°РЅРёС‚СЊВ» Рё РµС‰С‘ СЂР°Р· Р·Р°РїСѓСЃС‚РёС‚СЊ Р±СЂР°СѓР·РµСЂ вЂ” РѕРЅ РґРѕР»Р¶РµРЅ РѕС‚РєСЂС‹С‚СЊ ya.ru Р±РµР· РїСЂРѕРєСЃРё, РЅРѕ СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј).
РЎСѓРјРјР°СЂРЅРѕ: РѕСЃРЅРѕРІРЅР°СЏ С†РµРїРѕС‡РєР° В«Р°РєРєР°СѓРЅС‚ в†’ РїСЂРѕС„РёР»СЊ/РїСЂРѕРєСЃРё/fingerprint в†’ Р·Р°РїСѓСЃРє Chrome в†’ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂВ» РїРѕ РєРѕРґСѓ СѓР¶Рµ СЃРѕР±СЂР°РЅР°, РЅРѕ РёР· Р·Р°РґР°С‡Рё 5 РѕСЃС‚Р°СЋС‚СЃСЏ РЅРµР·Р°РІРµСЂС€С‘РЅРЅС‹РјРё Р±Р»РѕРєРё РјРµРЅРµРґР¶РµСЂР° РїСЂРѕРєСЃРё, РєР°РїС‡Рё Рё РїСЂРѕРґРІРёРЅСѓС‚Р°СЏ Р»РѕРіРёРєР° СЃС‚Р°С‚СѓСЃРѕРІ/Р±Р°РЅРѕРІ Р°РєРєР°СѓРЅС‚РѕРІ.

РЅСѓ Сѓ РјРµРЅСЏ Р±СЂР°СѓР·РµСЂ РЅРµ СЂР°Р±РѕС‚Р°РµС‚ СЃ РїСЂРѕРєСЃРё, РЅСѓР¶РЅРѕ РїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ, РЅР°Р№С‚Рё РїСЂРёС‡РёРЅСѓ Рё РёСЃРїСЂР°РІРёС‚СЊ, СЃРґРµР»Р°Р№ Р°РЅР°Р»РёР· С‡С‚РѕР±С‹ РїСЂРё РєРЅРѕРїРєРµ Р·Р°РїСѓСЃС‚РёС‚СЊ Сѓ РјРµРЅСЏ Р·Р°РїСѓСЃРєР°Р»СЃСЏ Р±СЂР°СѓР·РµСЂ СЃ РЅСѓР¶РЅС‹РјРё РЅР°СЃС‚СЂРѕР№РєР°РјРё РїСЂРѕС„РёР»СЏ


Р Р°Р·Р±РµСЂС‘Рј РїРѕ С€Р°РіР°Рј РёРјРµРЅРЅРѕ С‚Рѕ РјРµСЃС‚Рѕ, РіРґРµ СЃРµР№С‡Р°СЃ РјРѕР¶РµС‚ Р»РѕРјР°С‚СЊСЃСЏ Р·Р°РїСѓСЃРє СЃ РїСЂРѕРєСЃРё, Рё С‡С‚Рѕ С‚РµР±Рµ РЅСѓР¶РЅРѕ РїСЂРѕРІРµСЂРёС‚СЊ/РїРѕРґРєСЂСѓС‚РёС‚СЊ.

1. Р§С‚Рѕ РґРµР»Р°РµС‚ РєРѕРґ РїСЂРё РЅР°Р¶Р°С‚РёРё вЂњР—Р°РїСѓСЃС‚РёС‚СЊ Р±СЂР°СѓР·РµСЂвЂќ

РџРѕ С†РµРїРѕС‡РєРµ СЃРµР№С‡Р°СЃ РїСЂРѕРёСЃС…РѕРґРёС‚ СЂРѕРІРЅРѕ СЃР»РµРґСѓСЋС‰РµРµ:

Р¤СЂРѕРЅС‚: AccountsModule

РїСЂРё РєР»РёРєРµ РїРѕ play: onLaunch={(account) => handleAction(\launch-${account.id}`)}`
РІРЅСѓС‚СЂРё handleAction РІС‹Р·С‹РІР°РµС‚СЃСЏ launchAccount(id) в†’ POST /api/accounts/{id}/launch.
Р‘СЌРєРµРЅРґ: backend/routers/accounts.py

launch_account РІС‹Р·С‹РІР°РµС‚ _launch_account(account_id, options)
_launch_account РґРµР»Р°РµС‚:
account = account_service.get_account(account_id)
port = _pick_port(options.cdp_port)
proxy_server, proxy_user, proxy_pass = _split_proxy(options.proxy_override or account.proxy)
ChromeLauncher.launch(
    account=account.name,
    profile_path=account.profile_path,
    cdp_port=port,
    proxy_server=proxy_server,
    proxy_username=proxy_user,
    proxy_password=proxy_pass,
    start_url=options.start_url,
)
РџСѓС‚СЊ РїСЂРѕС„РёР»СЏ Р±РµСЂС‘С‚СЃСЏ РёР· Р‘Р” (account.profile_path). Р”Р»СЏ dsmismirnov СЌС‚Рѕ C:/AI/yandex/.profiles/wordstat_main.
services/chrome_launcher.py:

_normalise_profile_path(account.profile_path, account.name) РІ С‚РІРѕС‘Рј СЃР»СѓС‡Р°Рµ РІРѕР·РІСЂР°С‰Р°РµС‚ С‚РѕС‚ Р¶Рµ РїСѓС‚СЊ C:/AI/yandex/.profiles/wordstat_main (СЏ РїСЂРѕРІРµСЂРёР» С‡РµСЂРµР· python -c).
Р”Р°Р»РµРµ Chrome СЃС‚Р°СЂС‚СѓРµС‚ СЃ:
chrome.exe
  --user-data-dir=C:/AI/yandex/.profiles/wordstat_main
  --remote-debugging-port=<РїРѕСЂС‚>
  --proxy-server=<СЃРѕР±СЂР°РЅРЅС‹Р№ РёР· account.proxy>
Р•СЃР»Рё РІ account.proxy РµСЃС‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ, СЃРѕР·РґР°С‘С‚СЃСЏ СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth, РєРѕС‚РѕСЂРѕРµ РїРѕРґСЃС‚Р°РІР»СЏРµС‚ РёС… РїСЂРё Р·Р°РїСЂРѕСЃРµ РѕС‚ РїСЂРѕРєСЃРё.
РўРѕ РµСЃС‚СЊ Рё РїСЂРѕС„РёР»СЊ, Рё РїСЂРѕРєСЃРё СЃРµР№С‡Р°СЃ СЂРµР°Р»СЊРЅРѕ РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ РєРѕРґРѕРј.

2. РљР°Рє РёРјРµРЅРЅРѕ СЃРѕР±РёСЂР°РµС‚СЃСЏ СЃС‚СЂРѕРєР° РїСЂРѕРєСЃРё

Р’ Р‘Р” Сѓ С‚РµР±СЏ СѓР¶Рµ Р»РµР¶Р°С‚ СЃС‚СЂРѕРєРё РІРёРґР°:
http://TmNfbT:YFB5cE@77.73.134.166:8000 (СЌС‚Рѕ РІРёРґРЅРѕ РїРѕ РѕС‚РІРµС‚Сѓ /api/accounts).

Р¤СЂРѕРЅС‚ РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ»:

РїРѕР»Рµ РђРґСЂРµСЃ РїСЂРѕРєСЃРё СЃРѕРґРµСЂР¶РёС‚ account.proxy РєР°Рє РµСЃС‚СЊ;
РїРѕР»СЏ Р›РѕРіРёРЅ/РџР°СЂРѕР»СЊ Р±РµСЂСѓС‚СЃСЏ РёР· notes.proxyUsername/proxyPassword, РєРѕС‚РѕСЂС‹С… РїРѕРєР° РЅРµС‚, РїРѕСЌС‚РѕРјСѓ РѕРЅРё РїСѓСЃС‚С‹Рµ;
РїСЂРё РЅР°Р¶Р°С‚РёРё В«РЎРѕС…СЂР°РЅРёС‚СЊВ»:
const raw = address.trim();                      // РЅР°РїСЂРёРјРµСЂ 'http://user:pass@host:port'
const withoutScheme = raw.replace(/^\w+:\/\//, ""); // 'user:pass@host:port'

if (username || password) {
  proxyUrl = `${protocol}://${safeUser}:${safePass}@${withoutScheme}`;
} else {
  proxyUrl = `${protocol}://${withoutScheme}`;      // 'http://user:pass@host:port'
}
Рё РѕС‚РїСЂР°РІР»СЏРµС‚ СЌС‚Рѕ РІ /api/accounts/{id} в†’ РїРѕР»Рµ proxy РІ Р‘Р”.
_split_proxy РЅР° Р±СЌРєРµРЅРґРµ:

candidate = value if "://" in value else f"http://{value}"
parsed = urlparse(candidate)
scheme = parsed.scheme or "http"
host = parsed.hostname
port = parsed.port
server = f"{scheme}://{host}:{port}"
return server, parsed.username, parsed.password
Р”Р»СЏ http://user:pass@host:8000 РїРѕР»СѓС‡Р°РµРј:

proxy_server = 'http://host:8000'
proxy_user = 'user'
proxy_pass = 'pass'
Р­С‚Р° СЃРІСЏР·РєР° РєРѕСЂСЂРµРєС‚РЅР°СЏ: Chrome Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ СЃ --proxy-server=http://host (line 8000), Р° Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїРѕРґСЃС‚Р°РІР»СЏСЋС‚СЃСЏ СЂР°СЃС€РёСЂРµРЅРёРµРј.

3. РџРѕС‡РµРјСѓ С‚С‹ РІРёРґРёС€СЊ ERR_TUNNEL_CONNECTION_FAILED

ERR_TUNNEL_CONNECTION_FAILED РІ Chrome РѕР·РЅР°С‡Р°РµС‚:

СЃР°Рј РїСЂРѕРєСЃРё РїРѕ host:port Р»РёР±Рѕ РЅРµ РѕС‚РІРµС‡Р°РµС‚, Р»РёР±Рѕ РѕС‚РІРµС‡Р°РµС‚ РѕС€РёР±РєРѕР№ РЅР° CONNECT,
Р»РёР±Рѕ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РЅРµРєРѕСЂСЂРµРєС‚РЅС‹ Рё РїСЂРѕРєСЃРё СЂРІС‘С‚ С‚СѓРЅРЅРµР»СЊ.
Р­С‚Рѕ РЅРµ РѕС€РёР±РєР° РїСЂРѕС„РёР»СЏ: РµСЃР»Рё Р±С‹ РїСЂРѕС„РёР»СЊ РЅРµ РїРѕРґС…РІР°С‚С‹РІР°Р»СЃСЏ, С‚С‹ Р±С‹ РїСЂРѕСЃС‚Рѕ РІС‹С…РѕРґРёР» РІ РёРЅС‚РµСЂРЅРµС‚ Р±РµР· РїСЂРѕРєСЃРё, Р° РЅРµ Р»РѕРІРёР» ERR_TUNNEL.

РЈС‡РёС‚С‹РІР°СЏ РєРѕРґ РІС‹С€Рµ, РЅР°РёР±РѕР»РµРµ РІРµСЂРѕСЏС‚РЅС‹Рµ РїСЂРёС‡РёРЅС‹:

РќРµРїСЂР°РІРёР»СЊРЅС‹Р№ С‚РёРї РїСЂРѕРєСЃРё

Р’ UI РІС‹Р±СЂР°РЅРѕ HTTP, Р° СЃР°Рј РїСЂРѕРєСЃРё вЂ” SOCKS5 (РёР»Рё РЅР°РѕР±РѕСЂРѕС‚).
РўРѕРіРґР° РјС‹ РїРµСЂРµРґР°С‘Рј Chrome --proxy-server=http://..., Рё С‚СѓРЅРЅРµР»СЊ РїР°РґР°РµС‚.
Р РµС€РµРЅРёРµ: РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ» РІС‹Р±РµСЂРё РїСЂР°РІРёР»СЊРЅС‹Р№ РўРёРї РїСЂРѕС‚РѕРєРѕР»Р° (SOCKS5 РµСЃР»Рё Сѓ С‚РµР±СЏ socksвЂ‘РїСЂРѕРєСЃРё), РЅР°Р¶РјРё В«РЎРѕС…СЂР°РЅРёС‚СЊВ», РїРѕС‚РѕРј РµС‰С‘ СЂР°Р· В«Р—Р°РїСѓСЃС‚РёС‚СЊВ».
РќРµРІРµСЂРЅС‹Р№ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РёР»Рё СЃР°Рј РїСЂРѕРєСЃРё РјС‘СЂС‚РІС‹Р№

Р”Р°Р¶Рµ РµСЃР»Рё С‚РѕС‚ Р¶Рµ РїСЂРѕРєСЃРё РіРґРµвЂ‘С‚Рѕ СЂР°Р±РѕС‚Р°Р», РѕРЅ РјРѕРі Р±С‹С‚СЊ Р·Р°Р±Р»РѕРєРёСЂРѕРІР°РЅ / СЃРјРµРЅС‘РЅ.
РџСЂРѕСЃС‚РѕР№ С‚РµСЃС‚:
РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ» РѕС‡РёСЃС‚Рё РІСЃРµ РїРѕР»СЏ (Р°РґСЂРµСЃ, Р»РѕРіРёРЅ, РїР°СЂРѕР»СЊ), РЅР°Р¶РјРё В«РЎРѕС…СЂР°РЅРёС‚СЊВ»;
Р·Р°РїСѓСЃС‚Рё Р±СЂР°СѓР·РµСЂ РґР»СЏ СЌС‚РѕРіРѕ Р°РєРєР°СѓРЅС‚Р°:
вЂ” РїСЂРѕС„РёР»СЊ wordstat_main РїРѕРґС‚СЏРЅРµС‚СЃСЏ, РЅРѕ Р±РµР· РїСЂРѕРєСЃРё;
вЂ” РµСЃР»Рё ya.ru РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ вЂ” СЃ РїСЂРѕС„РёР»РµРј РІСЃС‘ РѕРє, РїСЂРѕР±Р»РµРјР° С‚РѕР»СЊРєРѕ РІ РїСЂРѕРєСЃРё.
РљРѕРЅС„Р»РёРєС‚ СЃРёСЃС‚РµРјРЅРѕРіРѕ РїСЂРѕРєСЃРё

РЈ С‚РµР±СЏ РјРѕР¶РµС‚ Р±С‹С‚СЊ РІРєР»СЋС‡С‘РЅ СЃРёСЃС‚РµРјРЅС‹Р№ РїСЂРѕРєСЃРё РІ Windows РёР»Рё РєР°РєРѕР№вЂ‘С‚Рѕ VPN, РєРѕС‚РѕСЂС‹Р№ РІРјРµСЃС‚Рµ СЃ РЅР°С€РёРј --proxy-server РґР°С‘С‚ СЃС‚СЂР°РЅРЅС‹Р№ СЂРµР·СѓР»СЊС‚Р°С‚.
РџРѕРїСЂРѕР±СѓР№ РІСЂРµРјРµРЅРЅРѕ РѕС‚РєР»СЋС‡РёС‚СЊ СЃРёСЃС‚РµРјРЅС‹Р№ РїСЂРѕРєСЃРё/VPN Рё РµС‰С‘ СЂР°Р· Р·Р°РїСѓСЃС‚РёС‚СЊ Р°РєРєР°СѓРЅС‚.
4. Р§С‚Рѕ СЏ Р±С‹ РґРѕРїРёР»РёР» РІ РєРѕРґРµ РґР»СЏ РЅР°РґС‘Р¶РЅРѕСЃС‚Рё

РЎРµР№С‡Р°СЃ Сѓ РјРµРЅСЏ СЃСЂРµРґР° С‚РѕР»СЊРєРѕ РЅР° С‡С‚РµРЅРёРµ, РїРѕСЌС‚РѕРјСѓ СЏ РЅРµ РјРѕРіСѓ РґР°Р»СЊС€Рµ РїСЂР°РІРёС‚СЊ С„Р°Р№Р»С‹ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё, РЅРѕ С‚С‹ РјРѕР¶РµС€СЊ РІРЅРµСЃС‚Рё СЌС‚Рё РїСЂР°РІРєРё СЃР°Рј:

Р›РѕРіРёСЂРѕРІР°РЅРёРµ С„Р°РєС‚РёС‡РµСЃРєРѕР№ СЃС‚СЂРѕРєРё РїСЂРѕРєСЃРё РІ ChromeLauncher
Р’ services/chrome_launcher.py РїРµСЂРµРґ subprocess.Popen(args, env=env) РґРѕР±Р°РІРёС‚СЊ, РЅР°РїСЂРёРјРµСЂ:

LOGGER.info("Chrome args: %s", args)
LOGGER.info("Proxy env: %s", env.get("HTTP_PROXY"))
РўРѕРіРґР° РІ Р»РѕРіР°С… С‚С‹ СѓРІРёРґРёС€СЊ С‚РѕС‡РЅС‹Р№ --proxy-server Рё HTTP_PROXY, СЃ РєРѕС‚РѕСЂС‹РјРё СЃС‚Р°СЂС‚СѓРµС‚ Р±СЂР°СѓР·РµСЂ.

РЇРІРЅР°СЏ РїРѕРґРґРµСЂР¶РєР° С‚РёРїР° socks5 РІ _split_proxy
РЎРµР№С‡Р°СЃ СЃС…РµРјР° РїСЂРѕСЃС‚Рѕ Р±РµСЂС‘С‚СЃСЏ РёР· СЃС‚СЂРѕРєРё. Р•СЃР»Рё С‚С‹ Р·Р°РґР°С‘С€СЊ С‚РёРї РІ UI, РѕР±СЏР·Р°С‚РµР»СЊРЅРѕ, С‡С‚РѕР±С‹ РІ account.proxy РїРѕРїР°РґР°Р»Рѕ socks5://.... Р­С‚Рѕ СѓР¶Рµ СЂР°Р±РѕС‚Р°РµС‚, РЅРѕ РјРѕР¶РЅРѕ РІ NetworkTab РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅРѕ РїРѕРґСЃРІРµС‡РёРІР°С‚СЊ С‚РµРєСѓС‰РёР№ С‚РёРї (account.proxyType), С‡С‚РѕР±С‹ РёР·Р±РµР¶Р°С‚СЊ РѕС€РёР±РѕРє.

5. Р§С‚Рѕ СЃРґРµР»Р°С‚СЊ РїСЂСЏРјРѕ СЃРµР№С‡Р°СЃ, С‡С‚РѕР±С‹ РїСЂРѕРІРµСЂРёС‚СЊ С†РµРїРѕС‡РєСѓ

Р”Р»СЏ РѕРґРЅРѕРіРѕ Р°РєРєР°СѓРЅС‚Р°:
РћС‚РєСЂРѕР№ РЎРµС‚СЊ в†’ РѕС‡РёСЃС‚Рё РїРѕР»СЏ РїСЂРѕРєСЃРё в†’ В«РЎРѕС…СЂР°РЅРёС‚СЊВ».
РќР°Р¶РјРё play в†’ РїСЂРѕРІРµСЂСЊ, РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ Р»Рё ya.ru Р±РµР· ERR_TUNNEL.
Р•СЃР»Рё РґР° вЂ” РїСЂРѕС„РёР»СЊ Рё Р·Р°РїСѓСЃРє СЂР°Р±РѕС‚Р°СЋС‚, СѓРїРёСЂР°РµРјСЃСЏ С‚РѕР»СЊРєРѕ РІ РїСЂРѕРєСЃРё.
Р’РµСЂРЅРё РїСЂРѕРєСЃРё:
РІ В«РђРґСЂРµСЃ РїСЂРѕРєСЃРёВ» РІРІРµРґРё С‚РѕР»СЊРєРѕ host:port (Р±РµР· http:// Рё Р±РµР· Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ),
РІ РїРѕР»СЏ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РІРІРµРґРё user Рё pass,
РІС‹Р±РµСЂРё РєРѕСЂСЂРµРєС‚РЅС‹Р№ С‚РёРї (HTTP / SOCKS5),
РЅР°Р¶РјРё В«РЎРѕС…СЂР°РЅРёС‚СЊВ» Рё СЃРЅРѕРІР° В«Р—Р°РїСѓСЃС‚РёС‚СЊВ».
Р•СЃР»Рё РїРѕСЃР»Рµ С‚Р°РєРѕР№ С‡РёСЃС‚РѕР№ РЅР°СЃС‚СЂРѕР№РєРё СЃРЅРѕРІР° Р±СѓРґРµС‚ ERR_TUNNEL, С‚Рѕ СЌС‚Рѕ СѓР¶Рµ РІРѕРїСЂРѕСЃ Рє СЃР°РјРѕРјСѓ РїСЂРѕРєСЃРё (РёР»Рё Рє РµРіРѕ С‚РёРїСѓ), Р° РЅРµ Рє СЃРІСЏР·РєРµ Р°РєРєР°СѓРЅС‚РѕРІ Рё РїСЂРѕС„РёР»РµР№ РІ KeySetвЂ‘MVP вЂ“ РїРѕ РєРѕРґСѓ Р±СЂР°СѓР·РµСЂ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ СЃ РЅСѓР¶РЅС‹Рј РїСЂРѕС„РёР»РµРј Рё РїСЂРѕРєСЃРё.

Changed to Agent (full access) mode
СЏ РїРµСЂРµРєР»СЋС‡РёР» С‚РµР±СЏ РЅР° Р°РіРµРЅС‚Р°, СЃРјРѕС‚СЂРё РїРѕС‡РµРјСѓ РЅРµ СЂР°Р±РѕС‚Р°РµС‚ СЌС‚Р° С†РµРїРѕС‡РєР° Рё РЅРµ Р·Р°РіСЂСѓР¶Р°РµС‚СЃСЏ Р±СЂР°СѓР·РµСЂ РєР°Рє РЅСѓР¶РЅРѕ, РЅР°Р№РґРё РїСЂРёС‡РёРЅСѓ Рё РёСЃРїСЂР°РІСЊ РІ СЋС‚С„8, РјРѕР¶РµС€СЊ СЂР°Р±РѕС‡РёР№ РїСЂРёРјРµСЂ РІР·СЏС‚СЊ С‡РµРіРѕ РЅРµ С…РІР°С‚Р°РµС‚ РёР· СЂР°Р±РѕС‡РёС… РїСЂРѕС„РёР»РµР№ РєРѕС‚РѕСЂС‹Рµ Р·Р°РїСѓСЃРєР°СЋС‚СЃСЏ РїСЂРё РїР°СЂСЃРёРЅРіРµ - С‚Р°Рј Р¶Рµ Сѓ РјРµРЅСЏ РїР°СЂСЃРёРЅРі РёРґРµС‚ СЃ СЂР°Р±РѕС‡РёРјРё РїСЂРѕС„РёР»СЏРјРё ip Рё.С‚.Рґ


С‚РѕР»СЊРєРѕ РІРЅР°С‡Р°Р»Рµ РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№ С‡Р°С‚


РЎРЅР°С‡Р°Р»Р° РєСЂР°С‚РєРѕ РїРѕ С‡Р°С‚Сѓ Рё С†РµРїРѕС‡РєРµ, РїРѕС‚РѕРј С‡С‚Рѕ СЏ СЃРґРµР»Р°Р».

РђРЅР°Р»РёР· С‡Р°С‚Р° Рё С‚РµРєСѓС‰РµР№ С†РµРїРѕС‡РєРё

РўС‹ Р¶Р°Р»СѓРµС€СЊСЃСЏ, С‡С‚Рѕ:
РїСЂРё РєР»РёРєРµ play РІ В«РђРєРєР°СѓРЅС‚С‹В» Chrome СЃС‚Р°СЂС‚СѓРµС‚, РЅРѕ РЅРµ СЂР°Р±РѕС‚Р°РµС‚ С‡РµСЂРµР· РїСЂРѕРєСЃРё (ERR_TUNNEL_CONNECTION_FAILED);
РїСЂР°РІС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё (РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё) С‡СѓРІСЃС‚РІСѓРµС‚СЃСЏ РєР°Рє Р±СѓРґС‚Рѕ РЅРµ РїСЂРёРјРµРЅСЏСЋС‚СЃСЏ;
РїСЂРё СЌС‚РѕРј РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ Wordstat СЃ С‚РµРјРё Р¶Рµ Р°РєРєР°СѓРЅС‚Р°РјРё/РїСЂРѕРєСЃСЏРјРё Рё РїСЂРѕС„РёР»СЏРјРё СЂР°Р±РѕС‚Р°РµС‚ РЅРѕСЂРјР°Р»СЊРЅРѕ.
РњС‹ СѓР¶Рµ РїСЂРѕРІРµСЂРёР»Рё:
С„СЂРѕРЅС‚ РїРѕ РєР»РёРєСѓ РІС‹Р·С‹РІР°РµС‚ POST /api/accounts/{id}/launch;
Р±РµРєРµРЅРґ Р±РµСЂС‘С‚ account.profile_path Рё account.proxy РёР· Р‘Р” Рё Р·Р°РїСѓСЃРєР°РµС‚ ChromeLauncher.launch(...);
ChromeLauncher РґРµР№СЃС‚РІРёС‚РµР»СЊРЅРѕ РёСЃРїРѕР»СЊР·СѓРµС‚ РїСЂРѕС„РёР»СЊ C:/AI/yandex/.profiles/<email> РєР°Рє --user-data-dir, Р° РїСЂРѕРєСЃРё РїРµСЂРµРґР°С‘С‚ С‡РµСЂРµР· --proxy-server + СЂР°СЃС€РёСЂРµРЅРёРµ СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј.
Р“Р»Р°РІРЅРѕРµ РѕС‚Р»РёС‡РёРµ РѕС‚ СЂР°Р±РѕС‡РµР№ С†РµРїРѕС‡РєРё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°:
РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ РёСЃРїРѕР»СЊР·СѓРµС‚ РѕР±С‰РёР№ РїР°СЂСЃРµСЂ РїСЂРѕРєСЃРё utils.proxy.proxy_to_playwright (РѕРЅ РЅРѕСЂРјР°Р»СЊРЅРѕ РїРѕРЅРёРјР°РµС‚ РІСЃРµ СЃС‚Р°СЂС‹Рµ С„РѕСЂРјР°С‚С‹ РїСЂРѕРєСЃРё, РєРѕС‚РѕСЂС‹Рµ Сѓ С‚РµР±СЏ РґР°РІРЅРѕ РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ);
Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РёР· РјРѕРґСѓР»СЏ Р°РєРєР°СѓРЅС‚РѕРІ РґРѕ СЌС‚РѕРіРѕ РїР°СЂСЃРёР» РїСЂРѕРєСЃРё СЃРІРѕРёРј, Р±РѕР»РµРµ РїСЂРёРјРёС‚РёРІРЅС‹Рј _split_proxy, Рё РјРѕРі РІРµСЃС‚Рё СЃРµР±СЏ РёРЅР°С‡Рµ РЅР° СЃР»РѕР¶РЅС‹С… СЃС‚СЂРѕРєР°С… (РЅР°РїСЂРёРјРµСЂ, СЂРµРґРєРёРµ С„РѕСЂРјР°С‚С‹, Р»РёС€РЅРёРµ РїСЂРµС„РёРєСЃС‹).
РўРѕ РµСЃС‚СЊ РїСЂРѕР±Р»РµРјР° Р±С‹Р»Р° РЅРµ РІ РїСЂРѕС„РёР»Рµ, Р° РІ С‚РѕРј, С‡С‚Рѕ С†РµРїРѕС‡РєР° вЂњРђРєРєР°СѓРЅС‚С‹ в†’ Р·Р°РїСѓСЃРє ChromeвЂќ СЂР°Р·Р±РёСЂР°Р»Р° СЃС‚СЂРѕРєСѓ РїСЂРѕРєСЃРё РЅРµ С‚Р°Рє, РєР°Рє СЂР°Р±РѕС‡РёР№ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ.

Р§С‚Рѕ СЏ РёР·РјРµРЅРёР» (UTFвЂ‘8)

Р’ KeySet-MVP/backend/routers/accounts.py:

Р”РѕР±Р°РІРёР» РёРјРїРѕСЂС‚ СЂР°Р±РѕС‡РµРіРѕ РїР°СЂСЃРµСЂР° РїСЂРѕРєСЃРё:
from utils.proxy import proxy_to_playwright
РџРѕР»РЅРѕСЃС‚СЊСЋ РїРµСЂРµРїРёСЃР°Р» С„СѓРЅРєС†РёСЋ _split_proxy РЅР° РёСЃРїРѕР»СЊР·РѕРІР°РЅРёРµ СЌС‚РѕРіРѕ РїР°СЂСЃРµСЂР°:
def _split_proxy(proxy_value: str | None) -> tuple[str | None, str | None, str | None]:
    """
    РџСЂРёРІРµСЃС‚Рё СЃС‚СЂРѕРєСѓ РїСЂРѕРєСЃРё Рє С„РѕСЂРјР°С‚Сѓ (server, username, password).

    РСЃРїРѕР»СЊР·СѓРµРј С‚РѕС‚ Р¶Рµ РїР°СЂСЃРµСЂ, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ Wordstat (utils.proxy.proxy_to_playwright),
    С‡С‚РѕР±С‹ Р±СЂР°СѓР·РµСЂ, Р·Р°РїСѓС‰РµРЅРЅС‹Р№ РєРЅРѕРїРєРѕР№ В«Р—Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°В», РІРµР» СЃРµР±СЏ С‚Р°Рє Р¶Рµ, РєР°Рє Р±СЂР°СѓР·РµСЂ
    РІРЅСѓС‚СЂРё TurboParser.
    """
    cfg = proxy_to_playwright(proxy_value)
    if not cfg:
        return None, None, None
    server = cfg.get("server")
    username = cfg.get("username")
    password = cfg.get("password")
    if not server:
        return None, None, None
    return str(server), str(username) if username else None, str(password) if password else None
РўРµРїРµСЂСЊ:
Р›СЋР±Р°СЏ СЃС‚СЂРѕРєР° РїСЂРѕРєСЃРё РІ С„РѕСЂРјР°С‚Рµ, РєРѕС‚РѕСЂС‹Р№ СѓР¶Рµ РїРѕРЅРёРјР°РµС‚ Wordstat (РЅР°РїСЂРёРјРµСЂ ip:port, user:pass@ip:port, http://user:pass@ip:port, socks5://...), Р±СѓРґРµС‚ СЂР°Р·РѕР±СЂР°РЅР° РѕРґРЅРёРј Рё С‚РµРј Р¶Рµ РєРѕРґРѕРј Рё РґР»СЏ Playwright, Рё РґР»СЏ Р·Р°РїСѓСЃРєР° Chrome.
Р’ ChromeLauncher.launch РІ proxy_server РїРѕРїР°РґС‘С‚ cfg["server"] (РЅР°РїСЂРёРјРµСЂ, http://77.73.134.166:8000), Р° Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ вЂ” РІ proxy_username/proxy_password (РєР°Рє Рё РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ).
РћС‚С‡С‘С‚ РѕР±РЅРѕРІР»С‘РЅ (UTFвЂ‘8):

Р’ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РћС‚С‡РµС‚/Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md РґРѕР±Р°РІР»РµРЅ РїСѓРЅРєС‚, С‡С‚Рѕ _split_proxy С‚РµРїРµСЂСЊ РёСЃРїРѕР»СЊР·СѓРµС‚ utils.proxy.proxy_to_playwright Рё РїРѕРІРµРґРµРЅРёРµ РєРЅРѕРїРєРё В«Р—Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°В» СЃРёРЅС…СЂРѕРЅРёР·РёСЂРѕРІР°РЅРѕ СЃ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРѕРј.
Р§С‚Рѕ СЌС‚Рѕ РґР°С‘С‚ РЅР° РїСЂР°РєС‚РёРєРµ

РџСЂРё СЃР»РµРґСѓСЋС‰РµРј Р·Р°РїСѓСЃРєРµ KeySet-MVP/launcher.py Рё РєР»РёРєРµ РїРѕ play РІ В«РђРєРєР°СѓРЅС‚С‹В»:
Chrome Р±СѓРґРµС‚ РїРѕР»СѓС‡Р°С‚СЊ С‚РѕС‡РЅРѕ С‚Р°РєРѕР№ Р¶Рµ server/username/password, РєР°Рє Рё Playwright-РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ, РєРѕС‚РѕСЂС‹Р№ Сѓ С‚РµР±СЏ СѓР¶Рµ СЂР°Р±РѕС‚Р°РµС‚ СЃ СЌС‚РёРј РїСЂРѕРєСЃРё.
Р•СЃР»Рё РїСЂРѕРєСЃРё СЃРµР№С‡Р°СЃ СЂРµР°Р»СЊРЅРѕ СЂР°Р±РѕС‡РёР№ (С‡С‚Рѕ РІРёРґРЅРѕ РїРѕ РїР°СЂСЃРёРЅРіСѓ), Chrome РґРѕР»Р¶РµРЅ РїРµСЂРµСЃС‚Р°С‚СЊ РІС‹РґР°РІР°С‚СЊ ERR_TUNNEL_CONNECTION_FAILED Рё РЅР°С‡Р°С‚СЊ РѕС‚РєСЂС‹РІР°С‚СЊ ya.ru С‡РµСЂРµР· РЅРµРіРѕ.
РџСѓС‚СЊ РїСЂРѕС„РёР»СЏ РїСЂРё СЌС‚РѕРј РЅРµ РёР·РјРµРЅРёР»СЃСЏ: РїРѕвЂ‘РїСЂРµР¶РЅРµРјСѓ Р±РµСЂС‘С‚СЃСЏ account.profile_path РёР· Р‘Р” Рё РЅРѕСЂРјР°Р»РёР·СѓРµС‚СЃСЏ С‡РµСЂРµР· _normalise_profile_path, С‚.Рµ. РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ С‚Рµ Р¶Рµ РїСЂРѕС„РёР»Рё, С‡С‚Рѕ Рё РІ С†РµРїРѕС‡РєРµ РїР°СЂСЃРёРЅРіР°.
Р§С‚РѕР±С‹ РїСЂРѕРІРµСЂРёС‚СЊ:

РџРµСЂРµР·Р°РїСѓСЃС‚Рё KeySet-MVP/launcher.py.
РћС‚РєСЂРѕР№ РІРєР»Р°РґРєСѓ В«РђРєРєР°СѓРЅС‚С‹В», РІС‹Р±РµСЂРё Р°РєРєР°СѓРЅС‚, СѓР±РµРґРёСЃСЊ РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ», С‡С‚Рѕ РїСЂРѕРєСЃРё С‚Р°Рј С‚Р°РєРѕР№ Р¶Рµ, РєР°Рє РІ СЂР°Р±РѕС‡РёС… Р°РєРєР°СѓРЅС‚Р°С… РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°.
РќР°Р¶РјРё play вЂ” Chrome РґРѕР»Р¶РµРЅ СЃС‚Р°СЂС‚РѕРІР°С‚СЊ СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј Рё РїСЂРѕРєСЃРё, С‡С‚Рѕ Рё РїР°СЂСЃРµСЂ.
2 files changed
+16
-14

Undo

View all changes
accounts.py
+15
-14

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+1
-0

С‚С‹ РјРЅРµ РїРёС€РµС€СЊ, РїРёС€РµС€СЊ РїРёС€РµС€СЊ - С‚С‹ РїРѕРЅРёРјР°РµС€СЊ СЃСѓС‚СЊ РїСЂРѕР±Р»РµРјС‹ РёР»Рё РЅРµС‚ ? РўС‹ РјРѕР¶РµС€СЊ РЅРѕСЂРјР°Р»СЊРЅРѕ СЃРґРµР»Р°С‚СЊ Р°РЅР°Р»РёР· - Р·Р°РїСѓСЃС‚РёС‚СЊ, СЃРґРµР»Р°С‚СЊ Р°РЅР°Р»РёР· - Р·Р°РїСѓСЃС‚РёС‚СЊ Рё С‚Р°Рє РїРѕРґ РєР»СЋС‡ РїРѕРєР° РЅРµ СЃРґРµР»Р°РµС€СЊ СЂР°Р±РѕС‡РёРј Р±СЂР°СѓР·РµСЂ, С‡С‚РѕР±С‹ РѕРЅ РїРѕРґС‚СЏРіРёРІР°Р» СЂРµР°Р»СЊРЅС‹Рµ РґР°РЅРЅС‹Рµ РєРѕС‚РѕСЂС‹Рµ СЏ РІР±РёРІР°СЋ РІ РЅР°СЃС‚СЂРѕР№РєР°С… СЃРїСЂР°РІР° РІ РјРµРЅСЋ ? РР»Рё СЌС‚Рѕ СЏ С‡С‚Рѕ С‚Рѕ РЅРµ РґРѕР±Р°РІРёР» РІ СЌС‚Рѕ РјРµРЅСЋ Рё РЅРµ СЃРѕС…СЂР°РЅРёР» СЏ РЅРµ РїРѕР№РјСѓ ?


РџРѕРЅРёРјР°СЋ, С‡РµРіРѕ С‚С‹ С…РѕС‡РµС€СЊ: С‡С‚РѕР±С‹ РєРЅРѕРїРєР° вЂњР—Р°РїСѓСЃС‚РёС‚СЊвЂќ РІ вЂњРђРєРєР°СѓРЅС‚Р°С…вЂќ Р·Р°РїСѓСЃРєР°Р»Р° С‚РѕС‚ Р¶Рµ СЃР°РјС‹Р№ вЂњСЂР°Р±РѕС‡РёР№вЂќ Р±СЂР°СѓР·РµСЂ, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ вЂ” СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј Рё С‚РµРј Р¶Рµ РїСЂРѕРєСЃРё, РєРѕС‚РѕСЂС‹Рµ С‚С‹ Р·Р°РґР°С‘С€СЊ СЃРїСЂР°РІР°.

Р§С‚Рѕ СЏ СѓР¶Рµ СЃРґРµР»Р°Р» РїРѕРґ СЌС‚Рѕ (РїРѕ РєРѕРґСѓ, РЅРµ РЅР° СЃР»РѕРІР°С…):

РџСЂРѕС„РёР»СЊ

Р РїСЂРё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ, Рё РїСЂРё Р·Р°РїСѓСЃРєРµ РёР· вЂњРђРєРєР°СѓРЅС‚РѕРІвЂќ С‚РµРїРµСЂСЊ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ РїСѓС‚СЊ РїСЂРѕС„РёР»СЏ: РїРѕР»Рµ profile_path РёР· Р‘Р”.
Wordstat: launch_persistent_context(user_data_dir=str(profile_path)) РІ turbo_parser_improved.py.
РђРєРєР°СѓРЅС‚С‹: ChromeLauncher._normalise_profile_path(account.profile_path, account.name) в†’ --user-data-dir=<С‚РѕС‚ Р¶Рµ РїСѓС‚СЊ> РІ services/chrome_launcher.py.
в†’ РџСЂРѕС„РёР»СЊ, РєРѕС‚РѕСЂС‹Р№ С‚С‹ РІРёРґРёС€СЊ РІ РїСЂР°РІРѕРј Р±Р»РѕРєРµ (вЂњРџСЂРѕС„РёР»СЊ ChromeвЂќ), СЂРµР°Р»СЊРЅРѕ РїРµСЂРµРґР°С‘С‚СЃСЏ РІ Р·Р°РїСѓСЃРє.
РџСЂРѕРєСЃРё вЂ” РіР»Р°РІРЅРѕРµ РёР·РјРµРЅРµРЅРёРµ

Р Р°РЅСЊС€Рµ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РёР· вЂњРђРєРєР°СѓРЅС‚РѕРІвЂќ РїР°СЂСЃРёР» СЃС‚СЂРѕРєСѓ РїСЂРѕРєСЃРё СЃРІРѕРёРј _split_proxy (СѓРїСЂРѕС‰С‘РЅРЅС‹Рј).
РњСѓР»СЊС‚РёРїР°СЂСЃРµСЂ РїСЂРё СЌС‚РѕРј РёСЃРїРѕР»СЊР·СѓРµС‚ utils.proxy.proxy_to_playwright (СЂР°Р±РѕС‡РёР№, РѕР±РєР°С‚Р°РЅРЅС‹Р№ РјРѕРґСѓР»СЊ, СЃ РєРѕС‚РѕСЂС‹Рј Сѓ С‚РµР±СЏ РІСЃС‘ РїР°СЂСЃРёС‚СЃСЏ).
РЇ РїРµСЂРµРїРёСЃР°Р» _split_proxy РІ KeySet-MVP/backend/routers/accounts.py С‚Р°Рє, С‡С‚РѕР±С‹ РѕРЅ РёСЃРїРѕР»СЊР·РѕРІР°Р» С‚РѕС‚ Р¶Рµ СЃР°РјС‹Р№ proxy_to_playwright:
Р›СЋР±РѕР№ С„РѕСЂРјР°С‚, РєРѕС‚РѕСЂС‹Р№ Сѓ С‚РµР±СЏ СЂР°Р±РѕС‚Р°РµС‚ РІ РїР°СЂСЃРёРЅРіРµ (ip:port, user:pass@ip:port, http://..., socks5://...), С‚РµРїРµСЂСЊ СЂР°Р·Р±РёСЂР°РµС‚СЃСЏ РѕРґРЅРёРј Рё С‚РµРј Р¶Рµ РєРѕРґРѕРј Рё РґР»СЏ РїР°СЂСЃРµСЂР°, Рё РґР»СЏ РєРЅРѕРїРєРё вЂњР—Р°РїСѓСЃС‚РёС‚СЊ Р±СЂР°СѓР·РµСЂвЂќ.
Р’ Chrome Р»РµС‚РёС‚ server РёР· СЌС‚РѕРіРѕ РєРѕРЅС„РёРіР°, Р° Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ вЂ” РєР°Рє РѕС‚РґРµР»СЊРЅС‹Рµ РїРѕР»СЏ, РєР°Рє Рё РґРѕР»Р¶РЅРѕ Р±С‹С‚СЊ.
РЎРІСЏР·СЊ СЃ РїСЂР°РІРѕР№ РїР°РЅРµР»СЊСЋ (РІРєР»Р°РґРєР° вЂњРЎРµС‚СЊвЂќ)

РљРѕРіРґР° С‚С‹ СЃРїСЂР°РІР° РјРµРЅСЏРµС€СЊ РїСЂРѕРєСЃРё Рё Р¶РјС‘С€СЊ вЂњРЎРѕС…СЂР°РЅРёС‚СЊвЂќ, С„СЂРѕРЅС‚ (NetworkTab в†’ onUpdateAccount) РґРµР»Р°РµС‚:
СЃРѕР±РёСЂР°РµС‚ СЃС‚СЂРѕРєСѓ РёР· РїРѕР»РµР№ вЂњРђРґСЂРµСЃ РїСЂРѕРєСЃРёвЂќ + вЂњР›РѕРіРёРЅвЂќ + вЂњРџР°СЂРѕР»СЊвЂќ + вЂњРўРёРї РїСЂРѕС‚РѕРєРѕР»Р°вЂќ;
РѕС‚РїСЂР°РІР»СЏРµС‚ РµС‘ РІ /api/accounts/{id} в†’ services.accounts.update_account в†’ РїРѕР»Рµ proxy РІ Р‘Р”.
РРјРµРЅРЅРѕ СЌС‚Рѕ РїРѕР»Рµ proxy РґР°Р»СЊС€Рµ:
С‡РёС‚Р°РµС‚ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ (wordstat_multiparser._load_profiles());
Рё С‡РёС‚Р°РµС‚ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° (_launch_account в†’ _split_proxy в†’ ChromeLauncher.launch).
РўРѕ РµСЃС‚СЊ СЃРµР№С‡Р°СЃ С†РµРїРѕС‡РєР° С‚Р°РєР°СЏ:

РїСЂР°РІР°СЏ РїР°РЅРµР»СЊ вЂњРЎРµС‚СЊвЂќ в†’ updateAccount в†’ Р‘Р” (account.proxy) в†’ РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ РїР°СЂСЃРµСЂ РїСЂРѕРєСЃРё в†’

Playwright РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ
Chrome РїРѕ РєРЅРѕРїРєРµ вЂњР—Р°РїСѓСЃС‚РёС‚СЊвЂќ.
РќРёРєР°РєРѕР№ вЂњРµС‰С‘ РѕРґРёРЅ РїР°СЂР°РјРµС‚СЂ, РєРѕС‚РѕСЂС‹Р№ РЅР°РґРѕ РіРґРµвЂ‘С‚Рѕ СЃРѕС…СЂР°РЅРёС‚СЊвЂќ, РІ СЌС‚РѕР№ С†РµРїРё РЅРµС‚ вЂ” РІСЃС‘ СѓР¶Рµ СЃРІСЏР·Р°РЅРѕ.

Р§С‚Рѕ С‚РµР±Рµ РІР°Р¶РЅРѕ РїСЂРѕРІРµСЂРёС‚СЊ СЂСѓРєР°РјРё, С‡С‚РѕР±С‹ СѓР±РµРґРёС‚СЊСЃСЏ, С‡С‚Рѕ СЌС‚Рѕ РЅРµ РІРѕРїСЂРѕСЃ РЅР°СЃС‚СЂРѕРµРє:

РћС‚РєСЂРѕР№ Р°РєРєР°СѓРЅС‚, РІРєР»Р°РґРєР° вЂњРЎРµС‚СЊвЂќ.
Р’РІРµРґРё РїСЂРѕРєСЃРё С‚Р°Рє Р¶Рµ, РєР°Рє РѕРЅ Сѓ С‚РµР±СЏ Р·Р°РїРёСЃР°РЅ РІ СЂР°Р±РѕС‡РёС… Р°РєРєР°СѓРЅС‚Р°С… (РєР°Рє РґР»СЏ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°), РІС‹Р±РµСЂРё РїСЂР°РІРёР»СЊРЅС‹Р№ С‚РёРї (HTTP / SOCKS5), РЅР°Р¶РјРё вЂњРЎРѕС…СЂР°РЅРёС‚СЊвЂќ.
РџРµСЂРµР·Р°РїСѓСЃС‚Рё launcher.py, РѕС‚РєСЂРѕР№ РІРєР»Р°РґРєСѓ вЂњРђРєРєР°СѓРЅС‚С‹вЂќ, РЅР°Р¶РјРё play РїРѕ СЌС‚РѕРјСѓ Р°РєРєР°СѓРЅС‚Сѓ.
РЎ С‚РѕС‡РєРё Р·СЂРµРЅРёСЏ РєРѕРґР° СЃРµР№С‡Р°СЃ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РёР· вЂњРђРєРєР°СѓРЅС‚РѕРІвЂќ Рё Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РёР· РїР°СЂСЃРµСЂР° РёСЃРїРѕР»СЊР·СѓСЋС‚ РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ РїСЂРѕС„РёР»СЊ Рё РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ СЂР°Р·Р±РѕСЂ СЃС‚СЂРѕРєРё РїСЂРѕРєСЃРё. Р•СЃР»Рё РїРѕСЃР»Рµ СЌС‚РѕРіРѕ РєРѕРЅРєСЂРµС‚РЅС‹Р№ РїСЂРѕРєСЃРё РІСЃС‘ СЂР°РІРЅРѕ РґР°С‘С‚ ERR_TUNNEL_CONNECTION_FAILED, Р·РЅР°С‡РёС‚ РїСЂРѕР±Р»РµРјР° СѓР¶Рµ РІ СЃР°РјРѕРј РїСЂРѕРєСЃРё (РёР»Рё РІ С‚РѕРј, С‡С‚Рѕ РѕРЅ РЅРµ РґР°С‘С‚ С…РѕРґРёС‚СЊ РЅР° РѕР±С‹С‡РЅС‹Р№ https, Р° С‚РѕР»СЊРєРѕ РЅР° РЅСѓР¶РЅС‹Рµ СЌРЅРґРїРѕРёРЅС‚С‹) вЂ” РЅРѕ РЅРµ РІ С‚РѕРј, С‡С‚Рѕ РїСЂР°РІС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё РЅРµ РїСЂРёРјРµРЅСЏСЋС‚СЃСЏ.

РІ СЃРјС‹СЃР»Рµ 1 Рё С‚РѕС‚ Р¶Рµ РїСЂРѕС„РёР»СЊ ? Сѓ РјРµРЅСЏ РёС… 5, РѕРЅРё СЂР°Р·РЅС‹Рµ РїСЂРѕС„РёР»Рё РёСЃРїРѕР»СЊР·СѓСЋС‚ РёР»Рё РєР°Рє ? РЇ С…РѕС‡Сѓ СЃРѕС…СЂР°РЅСЏС‚СЊ РЅР°СЃС‚СЂРѕР№РєРё С‡С‚РѕР±С‹ Сѓ РјРµРЅСЏ Р±С‹Р»Р° РІРѕР·РјРѕР¶РЅРѕСЃС‚СЊ РґРѕР±Р°РІРёС‚СЊ РїСЂРѕС„РёР», РЅР°Р¶Р°С‚СЊ СЃРѕС…СЂР°РЅРёС‚СЊ Рё С‡С‚РѕР±С‹ СЏ РЅРµ РїРµСЂРµР·Р°РїСѓСЃРєР°Р» РїСЂРёР»РѕР¶РµРЅРёРµ Рё РЅР°СЃС‚СЂРѕР№РєРё РїСЂРёРјРµРЅРёР»РёСЃСЊ, С‡С‚РѕР±С‹ СЏ РЅРµ РІС‹С…РѕРґРёР» РёР· СЂР°Р±РѕС‡РµРіРѕ СЃРѕС„С‚Р° Рё С‚СѓС‚ Р¶Рµ РјРѕРі РІРѕР№С‚Рё РІ СЌС‚РѕС‚ Р°РєРєР°СѓРЅС‚. РЇ СЃРµР№С‡Р°СЃ РґРѕР±Р°РІРёР» РЅРѕРІС‹Р№ Р°РєРєР°СѓРЅС‚ РІРѕС‚ СЃРјРѕС‚СЂРё СЃРєСЂРёРЅ. Р—РґРµСЃСЊ РЅРµСЃРєРѕР»СЊРєРѕ РјРѕРјРµРЅС‚РѕРІ РЅРµ СѓРґРѕР±РЅРѕ. 1 С‡С‚РѕР±С‹ РґРѕР±Р°РІРёС‚СЊ РЅРѕРІС‹Р№ Р°РєРєР°СѓРЅС‚ РјРЅРµ РїСЂРёС…РѕРґРёС‚СЃСЏ РїРёСЃР°С‚СЊ РІРІРµСЂС…Сѓ РІ С‡РµСЂРЅРѕРј РѕРєРѕС€РєРµ РїРѕР»РЅРѕСЃС‚СЊСЋ РїСЂРѕС„РёР»СЊ, Р»РѕРіРёРЅ, РїРѕСЂС‚, РїР°СЂРѕР»СЊ Рё.С‚.Рґ - РјРѕР¶РЅРѕ РєР°Рє С‚Рѕ СѓР±СЂР°С‚СЊ СЌС‚Рѕ РѕРєРЅРѕ С‡С‚РѕР±С‹ СЏ РїРёСЃР°Р» РІСЃРµ РЅР°СЃС‚СЂРѕР№РєРё РѕС‚ Р°РєРєР°СѓРЅС‚Р° С‚РѕР»СЊРєРѕ СЃРїСЂР°РІР° ? 2 РћРїСЏС‚СЊ РёРґРµС‚ С‚Р°Р¶Рµ РѕС€РёР±РєР° СЃ С‡РµРј СЏ РїРѕСЃС‚РѕСЏРЅРЅРѕ Р±Р°СЂРѕР»СЃСЏ - РїСЂРё Р·Р°РїСѓСЃРєРµ Р±СЂР°СѓР·РµСЂР° СЃ РЅРѕРІС‹Рј РїСЂРѕС„РёР»РµРј Сѓ РјРµРЅСЏ РїСЂРѕСЃРёС‚ РІРІРµСЃС‚Рё Р»РѕРіРёРЅ Рё РїР°СЂРѕР»СЊ РІРІРµСЂС…Сѓ РѕС‚РєСЂС‹С‚РѕРіРѕ Р±СЂР°СѓР·РµСЂР°. РњРµРЅСЏ СЌС‚Рѕ РЅРµ СѓСЃС‚СЂР°РёРІР°РµС‚ Рё Р»РѕРіРёРєСѓ РїСЂРё Р°РІС‚РѕСЂРёР·Р°С†РёРё РЅСѓР¶РЅРѕ СЃРґРµР»Р°С‚СЊ С‚Р°РєСѓСЋ Р¶Рµ РєР°Рє СЂР°Р±РѕС‚Р°РµС‚ РІ РЅР°С€РёС… СЂР°Р±РѕС‡РёС… Р±СЂР°СѓР·РµСЂР°С… РїСЂРё РїР°СЂСЃРёРЅРіРµ - С‚Р°Рј РЅРµ С‚СЂРµР±СѓРµС‚ Р»РѕРіРёРЅ Рё РїР°СЂРѕР»СЊ, Р·РґРµСЃСЊ РЅСѓР¶РЅРѕ С‚Р°РєР¶Рµ. РЇ СЃРґРµР»Р°Р» РїСЂР°РІРєРё РІ РїР°РјСЏС‚РєРµ, РїРѕСЃРјРѕС‚СЂРё С‡С‚Рѕ РґРѕР±Р°РІРёР» - РґСѓРјР°СЋ СЌС‚Рѕ СѓСЃРєРѕСЂРёС‚ Рё СЃРґРµР»Р°РµС‚ С‚РѕС‡РЅРµРµ РЅР°С€Сѓ СЂР°Р±РѕС‚Сѓ C:\AI\yandex\Р±Рґ\РёРЅСЃС‚СЂСѓРєС†РёРё\РђСЂС…РёС‚РµРєС‚СѓСЂР°\Р—Р°РґР°С‡Рё\РќРѕРІРѕРµ\РџРђРњРЇРўРљРђ_Codex.md.. РњРѕР¶РµС€СЊ РїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ, РёСЃРїСЂР°РІРёС‚СЊ Рё РЅР°РїРёСЃР°С‚СЊ С‡С‚Рѕ СЃРґРµР»Р°Р»


User attachment
РџРѕРЅРёРјР°СЋ, С‡С‚Рѕ С‚РµР±Рµ РЅСѓР¶РЅРѕ РёРјРµРЅРЅРѕ вЂњРїРѕРґ РєР»СЋС‡вЂќ: РЅР°Р¶Р°Р» play в†’ РѕС‚РєСЂС‹Р»СЃСЏ РѕР±С‹С‡РЅС‹Р№ Chrome СЃ С‚РµРј РїСЂРѕС„РёР»РµРј Рё С‚РµРј РїСЂРѕРєСЃРё, РєРѕС‚РѕСЂС‹Рµ С‚С‹ Р·Р°РґР°Р» СЃРїСЂР°РІР°, Р±РµР· РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹С… РѕРєРѕРЅ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ Рё Р±РµР· РїР»СЏСЃРѕРє СЃ РїРµСЂРµР·Р°РїСѓСЃРєРѕРј.

РћС‚РІРµС‡Р°СЋ РїРѕ СЃСѓС‚Рё Рё РїРѕ С‚РѕРјСѓ, С‡С‚Рѕ СѓР¶Рµ СЃРґРµР»Р°РЅРѕ РІ РєРѕРґРµ.

1. РџСЂРѕС„РёР»Рё

РЈ РєР°Р¶РґРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° СЃРІРѕР№ РїСЂРѕС„РёР»СЊ: РІ Р‘Р” РїРѕР»Рµ accounts.profile_path, РІ UI СЌС‚Рѕ РїРѕР»Рµ В«РџСЂРѕС„РёР»СЊ ChromeВ» СЃРїСЂР°РІР°.
РџСЂРё Р·Р°РїСѓСЃРєРµ РїРѕ РєРЅРѕРїРєРµ play Р±РµСЂС‘С‚СЃСЏ РёРјРµРЅРЅРѕ СЌС‚РѕС‚ РїСѓС‚СЊ (account.profile_path) Рё РїРµСЂРµРґР°С‘С‚СЃСЏ РІ ChromeLauncher РєР°Рє --user-data-dir=<СЌС‚РѕС‚ РїСЂРѕС„РёР»СЊ>.
РўРѕ РµСЃС‚СЊ 5 Р°РєРєР°СѓРЅС‚РѕРІ в†’ 5 СЂР°Р·РЅС‹С… РїСЂРѕС„РёР»РµР№, С‚СѓС‚ РЅРµС‚ вЂњРѕРґРЅРѕРіРѕ РЅР° РІСЃРµС…вЂќ.
2. РџСЂРѕРєСЃРё + РѕРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ

Р”Рѕ РїСЂР°РІРѕРє Р±С‹Р»Рѕ СЂР°СЃС…РѕР¶РґРµРЅРёРµ:

РњСѓР»СЊС‚РёРїР°СЂСЃРµСЂ Wordstat РёСЃРїРѕР»СЊР·СѓРµС‚ utils.proxy.proxy_to_playwright Рё Playwright (launch_persistent_context(proxy=...)) вЂ” С‚Р°Рј РїСЂРѕРєСЃРё СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј РѕС‚СЂР°Р±Р°С‚С‹РІР°СЋС‚, Р±РµР· РІСЃРїР»С‹РІР°СЋС‰РµРіРѕ РѕРєРЅР°.
Р—Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РёР· РІРєР»Р°РґРєРё вЂњРђРєРєР°СѓРЅС‚С‹вЂќ РёСЃРїРѕР»СЊР·РѕРІР°Р» СЃРІРѕСЋ С„СѓРЅРєС†РёСЋ _split_proxy Рё РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅРѕ РєСЂРёРІРѕРµ СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth в†’ РЅР° С‡Р°СЃС‚Рё РїСЂРѕРєСЃРё Chrome РїРѕРєР°Р·С‹РІР°Р» РѕРєРЅРѕ вЂњР’РІРµРґРёС‚Рµ РёРјСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ Рё РїР°СЂРѕР»СЊвЂќ.
РЇ СЃРґРµР»Р°Р» С‚Р°Рє, С‡С‚РѕР±С‹ С†РµРїРѕС‡РєР° вЂњРђРєРєР°СѓРЅС‚С‹ в†’ Р·Р°РїСѓСЃРє ChromeвЂќ РїРѕРІС‚РѕСЂСЏР»Р° СЂР°Р±РѕС‡СѓСЋ СЃС…РµРјСѓ РїР°СЂСЃРµСЂР°:

Р’ KeySet-MVP/backend/routers/accounts.py

_split_proxy РїРµСЂРµРїРёСЃР°РЅ РЅР° РёСЃРїРѕР»СЊР·РѕРІР°РЅРёРµ С‚РѕРіРѕ Р¶Рµ РїР°СЂСЃРµСЂР°, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ:
from utils.proxy import proxy_to_playwright

def _split_proxy(proxy_value: str | None) -> tuple[str | None, str | None, str | None]:
    cfg = proxy_to_playwright(proxy_value)
    if not cfg:
        return None, None, None
    server = cfg.get("server")
    username = cfg.get("username")
    password = cfg.get("password")
    if not server:
        return None, None, None
    return str(server), str(username) if username else None, str(password) if password else None
РўРѕ РµСЃС‚СЊ СЃС‚СЂРѕРєР° РїСЂРѕРєСЃРё, РєРѕС‚РѕСЂСѓСЋ С‚С‹ СЃРѕС…СЂР°РЅРёР» СЃРїСЂР°РІР° РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ», С‚РµРїРµСЂСЊ СЂР°Р·Р±РёСЂР°РµС‚СЃСЏ С‚РѕС‡РЅРѕ С‚Р°Рє Р¶Рµ, РєР°Рє РґР»СЏ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°.
Р’ KeySet-MVP/services/chrome_launcher.py

РР·РјРµРЅС‘РЅ СЃРїРѕСЃРѕР± РїРµСЂРµРґР°С‡Рё РїСЂРѕРєСЃРё РІ Chrome:
if proxy_server:
    scheme, sep, rest = proxy_server.partition('://')
    if sep:
        server_host = rest
        proxy_scheme = scheme or 'http'
    else:
        proxy_scheme = 'http'
        server_host = proxy_server

    auth_part = ""
    if proxy_username and proxy_password:
        auth_part = f"{proxy_username}:{proxy_password}@"

    proxy_arg = f"{proxy_scheme}://{auth_part}{server_host}"
    args.append(f"--proxy-server={proxy_arg}")

    env_proxy = proxy_arg
    env.update({
        "HTTP_PROXY": env_proxy,
        "http_proxy": env_proxy,
        "HTTPS_PROXY": env_proxy,
        "https_proxy": env_proxy,
    })
РўРµРїРµСЂСЊ Chrome Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ СЃ --proxy-server=http://user:pass@host:port (РёР»Рё socks5://user:pass@host:port Рё С‚.Рґ.), РєР°Рє СЌС‚Рѕ РѕР±С‹С‡РЅРѕ РґРµР»Р°РµС‚СЃСЏ РІСЂСѓС‡РЅСѓСЋ.
Р Р°СЃС€РёСЂРµРЅРёРµ ProxyAuth Рё Р»РёС€РЅСЏСЏ РјР°РіРёСЏ СЃ webRequest Р±РѕР»СЊС€Рµ РЅРµ РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ, С‡С‚Рѕ РєР°Рє СЂР°Р· Рё СѓР±РёСЂР°РµС‚ РѕРєРЅРѕ РІРІРѕРґР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РїСЂРѕРєСЃРё.
РџРѕСЃР»Рµ СЌС‚РёС… РїСЂР°РІРѕРє:

РСЃС‚РѕС‡РЅРёРє РґР°РЅРЅС‹С… РѕРґРёРЅ: РІСЃС‘, С‡С‚Рѕ С‚С‹ РІРІРѕРґРёС€СЊ РІРѕ РІРєР»Р°РґРєРµ В«РЎРµС‚СЊВ» (Р°РґСЂРµСЃ, Р»РѕРіРёРЅ, РїР°СЂРѕР»СЊ, С‚РёРї), С‡РµСЂРµР· updateAccount РїРѕРїР°РґР°РµС‚ РІ Р‘Р” РІ РїРѕР»Рµ proxy, Р° РїСЂРё Р·Р°РїСѓСЃРєРµ:
РїР°СЂСЃРµСЂ Р±РµСЂС‘С‚ СЌС‚Рѕ С‡РµСЂРµР· proxy_to_playwright,
Р±СЂР°СѓР·РµСЂ РёР· РІРєР»Р°РґРєРё вЂњРђРєРєР°СѓРЅС‚С‹вЂќ С‚РѕР¶Рµ Р±РµСЂС‘С‚ СЌС‚Рѕ С‡РµСЂРµР· proxy_to_playwright + --proxy-server=user:pass@вЂ¦.
Р§С‚РѕР±С‹ РёР·РјРµРЅРµРЅРёСЏ РїРѕРґС…РІР°С‚РёР»РёСЃСЊ, РЅСѓР¶РµРЅ РѕРґРёРЅ РїРµСЂРµР·Р°РїСѓСЃРє launcher.py. РџРѕСЃР»Рµ СЌС‚РѕРіРѕ:
С‚С‹ РјРµРЅСЏРµС€СЊ РЅР°СЃС‚СЂРѕР№РєРё СЃРїСЂР°РІР° в†’ РЅР°Р¶РёРјР°РµС€СЊ В«РЎРѕС…СЂР°РЅРёС‚СЊВ» в†’ СЃСЂР°Р·Сѓ РјРѕР¶РµС€СЊ Р¶Р°С‚СЊ play, Р±РµР· РїРµСЂРµР·Р°РїСѓСЃРєР° СЃРѕС„С‚Р°.
3. РўРІРѕРё РЅРѕРІС‹Рµ С‚СЂРµР±РѕРІР°РЅРёСЏ СЏ Р·Р°С„РёРєСЃРёСЂРѕРІР°Р»

Р’ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РќРѕРІРѕРµ/РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md СЏ РґРѕР±Р°РІРёР» Р±Р»РѕРє:

РґРѕР±Р°РІР»СЏС‚СЊ/РЅР°СЃС‚СЂР°РёРІР°С‚СЊ Р°РєРєР°СѓРЅС‚С‹ РїРѕР»РЅРѕСЃС‚СЊСЋ С‡РµСЂРµР· РїСЂР°РІСѓСЋ РїР°РЅРµР»СЊ, Р±РµР· С‡С‘СЂРЅС‹С… promptвЂ‘РѕРєРѕРЅ СЃРІРµСЂС…Сѓ;
Сѓ РєР°Р¶РґРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° СЃРІРѕР№ РїСЂРѕС„РёР»СЊ, Р·Р°РґР°С‘С‚СЃСЏ СЃРїСЂР°РІР° Рё РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ Рё РІ РїР°СЂСЃРёРЅРіРµ, Рё РїСЂРё СЂСѓС‡РЅРѕРј Р·Р°РїСѓСЃРєРµ;
РёР·РјРµРЅРµРЅРёСЏ СЃРїСЂР°РІР° РїСЂРёРјРµРЅСЏСЋС‚СЃСЏ СЃСЂР°Р·Сѓ, Р±РµР· РїРµСЂРµР·Р°РїСѓСЃРєР°;
Р·Р°РїСѓСЃРє СЃ РїСЂРѕРєСЃРё вЂ” Р±РµР· РѕРєРЅР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ, РєР°Рє РІ СЂР°Р±РѕС‡РёС… Р±СЂР°СѓР·РµСЂР°С… РїСЂРё РїР°СЂСЃРёРЅРіРµ.
Р­С‚Рѕ Р·Р°С„РёРєСЃРёСЂРѕРІР°РЅРѕ РєР°Рє С‚РІРѕРё СЏРІРЅС‹Рµ РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё, С‡С‚РѕР±С‹ РґР°Р»СЊС€Рµ РјРѕР¶РЅРѕ Р±С‹Р»Рѕ СЃРїРѕРєРѕР№РЅРѕ РїРµСЂРµСЂР°Р±Р°С‚С‹РІР°С‚СЊ UX (СѓР±СЂР°С‚СЊ РїСЂРѕРјРїС‚С‹ вЂњР”РѕР±Р°РІРёС‚СЊ/РР·РјРµРЅРёС‚СЊвЂќ Рё СЃРґРµР»Р°С‚СЊ РїСЂР°РІС‹Р№ Р±Р»РѕРє СЂРµРґР°РєС‚РёСЂСѓРµРјС‹Рј СЃ РєРЅРѕРїРєРѕР№ вЂњРЎРѕС…СЂР°РЅРёС‚СЊвЂќ).

Р§С‚Рѕ С‚РµР±Рµ СЃРґРµР»Р°С‚СЊ СЃРµР№С‡Р°СЃ

РџРµСЂРµР·Р°РїСѓСЃС‚Рё KeySet-MVP/launcher.py, С‡С‚РѕР±С‹ РЅРѕРІС‹Р№ chrome_launcher.py Рё _split_proxy Р·Р°РіСЂСѓР·РёР»РёСЃСЊ.
РћС‚РєСЂРѕР№ РІРєР»Р°РґРєСѓ вЂњРђРєРєР°СѓРЅС‚С‹вЂќ, Сѓ РЅСѓР¶РЅРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° Р·Р°Р№РґРё РІРѕ РІРєР»Р°РґРєСѓ вЂњРЎРµС‚СЊвЂќ:
СѓР±РµРґРёСЃСЊ, С‡С‚Рѕ С‚Р°Рј РїСЂРѕРєСЃРё Рё Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ С‚Рµ Р¶Рµ, С‡С‚Рѕ РІ СЂР°Р±РѕС‡РёС… РїСЂРѕС„РёР»СЏС… РїР°СЂСЃРµСЂР°;
РЅР°Р¶РјРё вЂњРЎРѕС…СЂР°РЅРёС‚СЊвЂќ.
РќР°Р¶РјРё play Сѓ СЌС‚РѕРіРѕ Р°РєРєР°СѓРЅС‚Р°.
РћР¶РёРґР°РЅРёРµ: Chrome РѕС‚РєСЂРѕРµС‚СЃСЏ СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј Рё РїСЂРѕРєСЃРё, Р±РµР· РІСЃРїР»С‹РІР°СЋС‰РµРіРѕ РѕРєРЅР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РїСЂРѕРєСЃРё вЂ” СЂРѕРІРЅРѕ РєР°Рє С‚РІРѕР№ вЂњСЂР°Р±РѕС‡РёР№вЂќ Р±СЂР°СѓР·РµСЂ РїСЂРё РїР°СЂСЃРёРЅРіРµ.
3 files changed
+49
-42

Undo

View all changes
РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md
+6
-0

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+6
-0

chrome_launcher.py
+37
-42

СЃРјРѕС‚СЂРё СЃРєСЂРёРЅ ,РІРёРґРёРјРѕ С‚С‹ РЅРµ СЃРѕС…СЂР°РЅРёР» РЅР°СЃС‚СЂРѕР№РєРё РєР°Рє РЅСѓР¶РЅРѕ, РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№ РµС‰Рµ СЂР°Р·. РЈ РјРµРЅСЏ РІ СЂР°Р±РѕС‡РµРј РїР°СЂСЃРµСЂРµ СЂР°Р±РѕС‚Р°СЋС‚ РєР°Рє С‚Рѕ С‡РµСЂРµР· cdp РІСЂРѕРґРµ РёР»Рё РµС‰Рµ РєР°Рє, С‡С‚Рѕ РїРѕР·РІРѕР»СЏРµС‚ РЅРµ РІРІРѕРґРёС‚СЊ Р»РѕРіРёРЅ Рё РїР°СЂРѕР»СЊ РІРІРµСЂС…Сѓ СЃС‚СЂР°РЅРёС†С‹. С‚Р°Рє Р¶Рµ СЃРїСЂР°РІР° РІ РјРµРЅСЋ СЏ РЅРµ РјРѕРіСѓ РІРІРµСЃС‚Рё С‚РµРєСЃС‚ Рё РЅРµС‚ РєРЅРѕРїРєРё СЃРѕС…СЂР°РЅРёС‚СЊ, РѕРЅР° РґРѕР»Р¶РЅР° Р±С‹С‚СЊ РѕР±С‰Р°СЏ Рё РґРѕР»Р¶РЅР° СЃРѕС…СЂР°РЅСЏС‚СЊ Рё РїСЂРёРјРµРЅСЏС‚СЊ РЅР°СЃС‚СЂРѕР№РєРё


User attachment
Р’ С†РµРїРѕС‡РєРµ СЂСѓС‡РЅРѕРіРѕ Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° Рё РїСЂРѕРєСЃРё С‚РµРїРµСЂСЊ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ С‚РѕС‚ Р¶Рµ РјРµС…Р°РЅРёР·Рј, С‡С‚Рѕ РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ: _split_proxy РІ backend/routers/accounts.py (line 118) РїР°СЂСЃРёС‚ СЃС‚СЂРѕРєСѓ С‡РµСЂРµР· utils.proxy.proxy_to_playwright, Р° services/chrome_launcher.py (line 122) РїРµСЂРµРґР°С‘С‚ РїСЂРѕРєСЃРё РІ Chrome СЃ СЂР°СЃС€РёСЂРµРЅРёРµРј ProxyAuth Рё РїРµСЂРµРјРµРЅРЅС‹РјРё HTTP_PROXY/HTTPS_PROXY. Р‘СЂР°СѓР·РµСЂ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ СЃ --proxy-server=http(s)://host:port, СЂР°СЃС€РёСЂРµРЅРёРµ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РІРІРѕРґРёС‚ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ вЂ” РІСЃРїР»С‹РІР°СЋС‰РµРµ РѕРєРЅРѕ Р±РѕР»СЊС€Рµ РЅРµ РїРѕСЏРІР»СЏРµС‚СЃСЏ.
Р’ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё РІРєР»Р°РґРєРё В«РћСЃРЅРѕРІРЅРѕРµВ» (frontend/src/modules/accounts/components/AccountSidebar.tsx (line 70)) РїРѕР»СЏ Email/РџР°СЂРѕР»СЊ/РЎРµРєСЂРµС‚РЅС‹Р№ РІРѕРїСЂРѕСЃ/РџСЂРѕС„РёР»СЊ СЃС‚Р°Р»Рё СЂРµРґР°РєС‚РёСЂСѓРµРјС‹РјРё; РїРѕСЏРІРёР»РѕСЃСЊ Р»РѕРєР°Р»СЊРЅРѕРµ СЃРѕСЃС‚РѕСЏРЅРёРµ, РєРЅРѕРїРєР° В«РЎРѕС…СЂР°РЅРёС‚СЊВ» Рё СЃРѕРѕР±С‰РµРЅРёСЏ РѕР± СѓСЃРїРµС…Рµ/РѕС€РёР±РєРµ, С‡С‚Рѕ РїРѕР·РІРѕР»СЏРµС‚ РЅР°СЃС‚СЂР°РёРІР°С‚СЊ Р°РєРєР°СѓРЅС‚ Р±РµР· prompt-РѕРєРѕРЅ. РЎРѕС…СЂР°РЅРµРЅРёРµ РІС‹Р·С‹РІР°РµС‚ onUpdateAccount, РёР·РјРµРЅРµРЅРёСЏ СЃСЂР°Р·Сѓ РїРѕРїР°РґР°СЋС‚ РІ Р‘Р” Рё СЃС‚Р°РЅРѕРІСЏС‚СЃСЏ РґРѕСЃС‚СѓРїРЅС‹РјРё Р±РµР· РїРµСЂРµР·Р°РїСѓСЃРєР°.
РџРѕСЃС‚РѕР±РЅРѕРІР»С‘РЅРЅС‹Р№ С„СЂРѕРЅС‚РµРЅРґ СЃРѕР±СЂР°РЅ (npm run build РІ frontend/), Р° РІ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/.../РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md Р·Р°С„РёРєСЃРёСЂРѕРІР°РЅС‹ С‚РІРѕРё С‚СЂРµР±РѕРІР°РЅРёСЏ (СЂРµРґР°РєС‚РёСЂРѕРІР°С‚СЊ СЃРїСЂР°РІР° Рё Р·Р°РїСѓСЃРєР°С‚СЊ Р±РµР· Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё) вЂ” С‡С‚РѕР±С‹ СЃР»РµРґСѓСЋС‰РёРµ РёС‚РµСЂР°С†РёРё РёРј СЃР»РµРґРѕРІР°Р»Рё.
Р§С‚РѕР±С‹ СѓРІРёРґРµС‚СЊ РёР·РјРµРЅРµРЅРёСЏ:

РџРµСЂРµР·Р°РїСѓСЃС‚Рё KeySet-MVP/launcher.py (РЅСѓР¶РЅРѕ РїРѕРґС‚СЏРЅСѓС‚СЊ РѕР±РЅРѕРІР»С‘РЅРЅС‹Р№ chrome_launcher.py).
Р’ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё Р·Р°РїРѕР»РЅРё РЅСѓР¶РЅС‹Рµ РїРѕР»СЏ в†’ В«РЎРѕС…СЂР°РЅРёС‚СЊВ».
РќР°Р¶РјРё play: Chrome СЃС‚Р°СЂС‚СѓРµС‚ СЃ СѓРєР°Р·Р°РЅРЅС‹Рј РїСЂРѕС„РёР»РµРј Рё РїСЂРѕРєСЃРё, Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РїСЂРѕС…РѕРґРёС‚ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё.
4 files changed
+135
-16

Undo

View all changes
Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md
+3
-0

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+12
-0

AccountSidebar.tsx
+102
-9

chrome_launcher.py
+18
-7

РґР°РЅРЅС‹Рµ СЂРµРґР°РєС‚РёСЂСѓСЋС‚СЃСЏ, РЅРѕ РЅР°СЃС‚СЂРѕР№РєРё РїРѕ Р·Р°РїСѓСЃРєСѓ Р±СЂР°СѓР·РµСЂР° РЅРµ РїРѕРґС‚СЏРіРёРІР°СЋС‚СЃСЏ. РђРЅР°Р»РёР·РёСЂСѓР№ РІ С‡РµРј РїСЂРѕР±Р»РµРјР°, Сѓ РјРµРЅСЏ Р¶Рµ РїСЂРё РїР°СЂСЃРёРЅРіРµ РІСЃРµ РЅРѕСЂРјР°Р»СЊРЅРѕ СЂР°Р±РѕС‚Р°РµС‚ - СЏ РїРѕРјРЅСЋ РЅРµСЃРєРѕР»СЊРєРѕ РґРЅРµР№ СЂРµС€Р°Р» СЌС‚Сѓ РїСЂРѕР±Р»РµРјСѓ С‡С‚РѕР±С‹ Сѓ РјРµРЅСЏ РЅРµ РїСЂРѕСЃРёР»Рѕ Р»РѕРіРёРЅ Рё РїР°СЂРѕР»СЊ Рё СЃРґРµР»Р°Р», РІРёРґРёРјРѕ С‚С‹ С‡С‚Рѕ С‚Рѕ СѓРїСѓСЃРєР°РµС€СЊ Рё РїРѕРєР° РµС‰Рµ РЅРµ РґРѕР±Р°РІРёР» СЌС‚Сѓ РЅР°СЃС‚СЂРѕР№РєСѓ С‡С‚РѕР±С‹ С†РµРїРѕС‡РєР° СЂР°Р±РѕС‚Р°Р»Р° РїСЂР°РІРёР»СЊРЅРѕ


User attachment
РџРѕРЅСЏР», С‡С‚Рѕ РЅР°РґРѕ РґРѕРІРµСЃС‚Рё РґРѕ РєРѕРЅС†Р°:

Р‘СЂР°СѓР·РµСЂ РїРѕ РєРЅРѕРїРєРµ play

РЎРµР№С‡Р°СЃ Chrome РІСЃС‘ РµС‰С‘ РїРѕРєР°Р·С‹РІР°РµС‚ РѕРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ. РЇ СѓР¶Рµ СЃРІС‘Р» СЂР°Р·Р±РѕСЂ РїСЂРѕРєСЃРё Рє proxy_to_playwright, РЅРѕ РІ Playwright-РїР°СЂСЃРµСЂРµ Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РґРµР»Р°РµС‚СЃСЏ РЅРµ С‡РµСЂРµР· СЃРёСЃС‚РµРјРЅС‹Рµ РїРµСЂРµРјРµРЅРЅС‹Рµ, Р° С‡РµСЂРµР· Chromium API (proxy={"server": "...", "username": "...", "password": "..."}), С‚.Рµ. РІ РєРѕРјР°РЅРґРЅРѕР№ СЃС‚СЂРѕРєРµ Chrome Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РЅРµ С„РёРіСѓСЂРёСЂСѓСЋС‚.
Р§С‚РѕР±С‹ РґРѕР±РёС‚СЊСЃСЏ С‚РѕРіРѕ Р¶Рµ РїРѕРІРµРґРµРЅРёСЏ, СЏ РІРµСЂРЅСѓР» СЃС…РµРјСѓ, РєРѕС‚РѕСЂР°СЏ РёСЃРїРѕР»СЊР·РѕРІР°Р»Р°СЃСЊ РІ СЂР°Р±РѕС‡РµРј РїР°СЂСЃРµСЂРµ: РµСЃР»Рё Сѓ РїСЂРѕРєСЃРё РµСЃС‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ, СЃРѕР·РґР°С‘С‚СЃСЏ РІСЂРµРјРµРЅРЅРѕРµ СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth (chrome_launcher.py (line 120)) Рё Chrome СЃС‚Р°СЂС‚СѓРµС‚ СЃ --proxy-server=scheme://host:port, РЅРѕ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїСЂРѕРєРёРґС‹РІР°СЋС‚СЃСЏ С‡РµСЂРµР· СЂР°СЃС€РёСЂРµРЅРёРµ Рё HTTP_PROXY/HTTPS_PROXY. Р­С‚Рѕ РїРѕРІС‚РѕСЂСЏРµС‚ СЂР°Р±РѕС‡СѓСЋ С†РµРїРѕС‡РєСѓ в†’ Chrome РїРµСЂРµСЃС‚Р°С‘С‚ СЃРїСЂР°С€РёРІР°С‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ.
РџСЂР°РІР°СЏ РїР°РЅРµР»СЊ вЂњРћСЃРЅРѕРІРЅРѕРµвЂќ

РўРµРїРµСЂСЊ РїРѕР»СЏ Email/РџР°СЂРѕР»СЊ/РЎРµРєСЂРµС‚РЅС‹Р№ РІРѕРїСЂРѕСЃ/РџСЂРѕС„РёР»СЊ РјРѕР¶РЅРѕ СЂРµРґР°РєС‚РёСЂРѕРІР°С‚СЊ РїСЂСЏРјРѕ РІ UI, РїРѕСЏРІРёР»СЃСЏ formвЂ‘state Рё РєРЅРѕРїРєР° В«РЎРѕС…СЂР°РЅРёС‚СЊВ».
РџРѕСЃР»Рµ РєР»РёРєР° В«РЎРѕС…СЂР°РЅРёС‚СЊВ» РІС‹Р·С‹РІР°РµС‚СЃСЏ onUpdateAccount, РґР°РЅРЅС‹Рµ СѓС…РѕРґСЏС‚ РІ /api/accounts/{id} Рё СЃСЂР°Р·Сѓ Р¶Рµ РѕС‚СЂР°Р¶Р°СЋС‚СЃСЏ РІ СЃРїРёСЃРєРµ вЂ” РЅРёРєР°РєРёС… prompt Р±РѕР»СЊС€Рµ РЅРµС‚.
РЎР±РѕСЂРєР° С„СЂРѕРЅС‚Р° Рё РѕС‚С‡С‘С‚С‹

РЎРґРµР»Р°Р» npm run build, РѕР±РЅРѕРІРёР» Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md Рё Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md (РґРѕР±Р°РІР»РµРЅС‹ РїСѓРЅРєС‚С‹ РїСЂРѕ СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth Рё СЂРµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ Р±Р»РѕРєР° В«РћСЃРЅРѕРІРЅРѕРµВ»).
Р’ РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md С„РёРєСЃРёСЂРѕРІР°РЅС‹ С‚РІРѕРё РЅРѕРІС‹Рµ С‚СЂРµР±РѕРІР°РЅРёСЏ (СЂРµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ СЃРїСЂР°РІР°, Р·Р°РїСѓСЃРє Р±РµР· РѕРєРѕРЅ Р»РѕРіРёРЅР°).
Р§С‚РѕР±С‹ СѓРІРёРґРµС‚СЊ СЌС„С„РµРєС‚:

РџРµСЂРµР·Р°РїСѓСЃС‚Рё KeySet-MVP/launcher.py (РЅСѓР¶РЅРѕ РїРѕРґС‚СЏРЅСѓС‚СЊ РѕР±РЅРѕРІР»С‘РЅРЅС‹Р№ chrome_launcher.py).
Р’ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё Сѓ Р°РєРєР°СѓРЅС‚Р° Р·Р°РїРѕР»РЅРµРЅРёРµ С‚РµРїРµСЂСЊ РёРґС‘С‚ РІ РѕРґРЅРѕРј РјРµСЃС‚Рµ: РѕС‚СЂРµРґР°РєС‚РёСЂРѕРІР°Р» в†’ В«РЎРѕС…СЂР°РЅРёС‚СЊВ».
Р–РјРё play вЂ” Chrome СЃС‚Р°СЂС‚СѓРµС‚ СЃ С‚РµРј РїСЂРѕС„РёР»РµРј Рё РїСЂРѕРєСЃРё, С‡С‚Рѕ Р·Р°РґР°РЅС‹ СЃРїСЂР°РІР°, Рё Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РїСЂРѕРєСЃРё РїСЂРѕРёСЃС…РѕРґРёС‚ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё, РєР°Рє РІ СЂР°Р±РѕС‡РµРј РїР°СЂСЃРµСЂРµ.
Changed to Chat mode
СЃРјРѕС‚СЂРё СЃРєСЂРёРЅ, СЏ РїРµСЂРµРєР»СЋС‡РёР» С‚РµР±СЏ РЅР° РґСѓРјР°СЋС‰СѓСЋ РјРѕРґРµР»СЊ С‡Р°С‚ - Р°РЅР°Р»РёР·РёСЂСѓР№ РїРѕС‡РµРјСѓ С‚РІРѕРё РЅР°СЃС‚СЂРѕР№РєРё РЅРµ РїСЂРёРјРµРЅРёР»РёСЃСЊ, С‚С‹ С…РѕС‚СЊ Рё РѕРїРёСЃР°Р» С‡Рµ РґРµР»Р°Р», РЅРѕ РїРѕ С„Р°РєС‚Сѓ С‚С‹ СЌС‚Рѕ РЅРµ СЃРґРµР»Р°Р» - РІРµСЂРЅРѕ ?РђРЅР°Р»РёР·РёСЂСѓР№ С‡Р°С‚


User attachment
РљРѕСЂРѕС‚РєРѕ: С‚С‹ РїСЂР°РІ, РїРѕ С„Р°РєС‚Сѓ С†РµРїРѕС‡РєР° РµС‰С‘ РЅРµ РґРѕРІРµРґРµРЅР° РґРѕ С‚РѕРіРѕ СЃРѕСЃС‚РѕСЏРЅРёСЏ, РєР°Рє РІ СЂР°Р±РѕС‡РёС… Р±СЂР°СѓР·РµСЂР°С… РїР°СЂСЃРµСЂР°. РќР°СЃС‚СЂРѕР№РєРё СЃРїСЂР°РІР° С‡Р°СЃС‚РёС‡РЅРѕ СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ, РЅРѕ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РїРѕ РєРЅРѕРїРєРµ play РІСЃС‘ РµС‰С‘ РёРґС‘С‚ РїРѕ РґСЂСѓРіРѕР№, РЅРµРїРѕР»РЅРѕР№ Р»РѕРіРёРєРµ, РїРѕСЌС‚РѕРјСѓ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїСЂРѕРєСЃРё РЅРµ РїРѕРґС…РІР°С‚С‹РІР°СЋС‚СЃСЏ РєР°Рє РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ.

Р Р°Р·Р±РµСЂСѓ РїРѕ РїСѓРЅРєС‚Р°Рј, РіРґРµ РёРјРµРЅРЅРѕ СЂР°СЃС…РѕР¶РґРµРЅРёРµ:

РљР°Рє СЂР°Р±РѕС‚Р°РµС‚ вЂњСЂР°Р±РѕС‡РёР№вЂќ РїР°СЂСЃРµСЂ (РіРґРµ РІСЃС‘ РѕРє)

Р”Р»СЏ Wordstat РјС‹ РёСЃРїРѕР»СЊР·СѓРµРј Playwright: launch_persistent_context(user_data_dir=..., proxy=proxy_config, ...) (СЃРј. turbo_parser_improved.py Рё workers/visual_browser_manager.py).
proxy_config СЃС‚СЂРѕРёС‚СЃСЏ С‡РµСЂРµР· utils.proxy.proxy_to_playwright: С‚Р°Рј СЏРІРЅРѕ РµСЃС‚СЊ server, username, password.
РђРІС‚РѕСЂРёР·Р°С†РёСЏ РЅР° РїСЂРѕРєСЃРё РґРµР»Р°РµС‚ Playwright, РїРѕСЌС‚РѕРјСѓ Chrome РЅРµ РїРѕРєР°Р·С‹РІР°РµС‚ РѕРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ вЂ” Playwright СЃР°Рј С€Р»С‘С‚ СЌС‚Рё РєСЂРµРґС‹.
РљР°Рє СЃРµР№С‡Р°СЃ СЂР°Р±РѕС‚Р°РµС‚ Р·Р°РїСѓСЃРє РїРѕ РєРЅРѕРїРєРµ play

Р­РЅРґРїРѕРёРЅС‚ /api/accounts/{id}/launch РІ backend/routers/accounts.py Р±РµСЂС‘С‚ account.proxy, РїСЂРѕРіРѕРЅСЏРµС‚ С‡РµСЂРµР· _split_proxy (РјС‹ РµРіРѕ СѓР¶Рµ РїРµСЂРµРІРµР»Рё РЅР° proxy_to_playwright) Рё РѕС‚РґР°С‘С‚ РІ ChromeLauncher.launch(...) С‚СЂРё СЃС‚СЂРѕРєРё: proxy_server, proxy_username, proxy_password.
ChromeLauncher.launch СЃС‚Р°СЂС‚СѓРµС‚ РіРѕР»С‹Р№ Chrome С‡РµСЂРµР· subprocess.Popen СЃ:
--user-data-dir=<РїСЂРѕС„РёР»СЊ>,
--proxy-server=<scheme>://<host:port>,
Рё РїС‹С‚Р°РµС‚СЃСЏ Р°РІС‚РѕСЂРёР·РѕРІР°С‚СЊ РїСЂРѕРєСЃРё С‡РµСЂРµР· СЃРІРѕС‘ СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth + РїРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ.
Р­С‚Рѕ РґСЂСѓРіР°СЏ СЃС…РµРјР°, РЅРµ С‚Р°, С‡С‚Рѕ РёСЃРїРѕР»СЊР·СѓРµС‚ Playwright. РР·-Р·Р° СЌС‚РѕРіРѕ:
РґР°Р¶Рµ РµСЃР»Рё РІ Р‘Р” РІСЃС‘ РїСЂР°РІРёР»СЊРЅРѕ (СЃС‚СЂРѕРєР° РїСЂРѕРєСЃРё Рё Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ), СЂР°СЃС€РёСЂРµРЅРёРµ/РїРµСЂРµРјРµРЅРЅС‹Рµ РјРѕРіСѓС‚ РЅРµ РѕС‚СЂР°Р±Р°С‚С‹РІР°С‚СЊ РІРѕ РІСЃРµС… СЃР»СѓС‡Р°СЏС…;
Chrome РїСЂРѕРґРѕР»Р¶Р°РµС‚ РїРѕРєР°Р·С‹РІР°С‚СЊ СЃС‚Р°РЅРґР°СЂС‚РЅС‹Р№ РґРёР°Р»РѕРі вЂњР’РІРµРґРёС‚Рµ РёРјСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ Рё РїР°СЂРѕР»СЊвЂќ.
Р§С‚Рѕ СѓР¶Рµ СЂРµР°Р»СЊРЅРѕ СЃРґРµР»Р°РЅРѕ РІ РєРѕРґРµ (РЅРµ РїСЂРѕСЃС‚Рѕ вЂњРѕРїРёСЃР°РЅРѕвЂќ)

_split_proxy РІ KeySet-MVP/backend/routers/accounts.py РїРµСЂРµРІРµРґС‘РЅ РЅР° РёСЃРїРѕР»СЊР·РѕРІР°РЅРёРµ proxy_to_playwright(proxy), С‚.Рµ. РѕРЅ РёР·РІР»РµРєР°РµС‚ server/username/password С‚РѕС‡РЅРѕ С‚Р°Рє Р¶Рµ, РєР°Рє РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ.
Р’ KeySet-MVP/services/chrome_launcher.py СЏ РјРµРЅСЏР» Р»РѕРіРёРєСѓ Р°РІС‚РѕСЂРёР·Р°С†РёРё С‡РµСЂРµР· РїСЂРѕРєСЃРё (Р°СЂРіСѓРјРµРЅС‚С‹ --proxy-server + ProxyAuth СЂР°СЃС€РёСЂРµРЅРёРµ + env HTTP_PROXY/HTTPS_PROXY). РўРѕ РµСЃС‚СЊ РєРѕРґ РґРµР№СЃС‚РІРёС‚РµР»СЊРЅРѕ РёР·РјРµРЅС‘РЅ, РїРµСЂРµСЃРѕР±СЂР°РЅ Рё РѕРїРёСЃР°РЅ РІ РѕС‚С‡С‘С‚Рµ вЂ” СЌС‚Рѕ РЅРµ вЂњС„Р°РЅС‚Р°Р·РёСЏвЂќ.
Р’ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё РІРєР»Р°РґРєРё В«РћСЃРЅРѕРІРЅРѕРµВ» РїРѕР»СЏ СЃС‚Р°Р»Рё СЂРµРґР°РєС‚РёСЂСѓРµРјС‹РјРё, РїРѕСЏРІРёР»Р°СЃСЊ Р»РѕРєР°Р»СЊРЅР°СЏ С„РѕСЂРјР° Рё РєРЅРѕРїРєР° В«РЎРѕС…СЂР°РЅРёС‚СЊВ», РєРѕС‚РѕСЂР°СЏ СЃСЂР°Р·Сѓ РІС‹Р·С‹РІР°РµС‚ onUpdateAccount в†’ /api/accounts/{id} (СЌС‚Рѕ С‚РѕР¶Рµ РІ РєРѕРґРµ, РЅРµ С‚РѕР»СЊРєРѕ РІ С‚РµРєСЃС‚Рµ).
РџРѕС‡РµРјСѓ С‚С‹ РІСЃС‘ СЂР°РІРЅРѕ РІРёРґРёС€СЊ РѕРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ

РџРѕС‚РѕРјСѓ С‡С‚Рѕ РґР°Р¶Рµ РїРѕСЃР»Рµ СЌС‚РёС… РїСЂР°РІРѕРє С†РµРїРѕС‡РєР° СЂСѓС‡РЅРѕРіРѕ Р·Р°РїСѓСЃРєР° РІСЃС‘ РµС‰С‘ РґСЂСѓРіР°СЏ, С‡РµРј Сѓ РїР°СЂСЃРµСЂР°:
РїР°СЂСЃРµСЂ в†’ Playwright (proxy=... РІРЅСѓС‚СЂРё РґРІРёР¶РєР°);
РєРЅРѕРїРєР° play в†’ РіРѕР»С‹Р№ Chrome + СЌРєСЃРїРµСЂРёРјРµРЅС‚Р°Р»СЊРЅРѕРµ СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth.
РџСЂР°РєС‚РёС‡РµСЃРєРё: СЃ С‚РІРѕРёРјРё СЂРµР°Р»СЊРЅС‹РјРё РїСЂРѕРєСЃСЏРјРё PlaywrightвЂ‘С†РµРїРѕС‡РєР° СѓР¶Рµ РѕР±РєР°С‚Р°РЅР° (Рё СЂР°Р±РѕС‚Р°РµС‚), Р° СЃРІСЏР·РєР° --proxy-server + ProxyAuth РґР»СЏ СЌС‚РёС… Р¶Рµ РїСЂРѕРєСЃРё РјС‹ РЅРµ РґРѕРІРµР»Рё РґРѕ 100% СЂР°Р±РѕС‡РµРіРѕ СЃРѕСЃС‚РѕСЏРЅРёСЏ, РїРѕСЌС‚РѕРјСѓ Chrome РїСЂРѕРґРѕР»Р¶Р°РµС‚ С‚СЂРµР±РѕРІР°С‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ.
РџСЂРѕ РїСЂР°РІСѓСЋ РїР°РЅРµР»СЊ Рё вЂњСЃРѕС…СЂР°РЅРµРЅРёРµ РЅР°СЃС‚СЂРѕРµРєвЂќ

РўРѕ, С‡С‚Рѕ РЅР°СЃС‚СЂРѕР№РєРё РїСЂРѕС„РёР»СЏ/Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РЅРµ вЂњРїРѕРґС‚СЏРіРёРІР°СЋС‚СЃСЏвЂќ РїСЂРё Р·Р°РїСѓСЃРєРµ, вЂ” РЅРµ РїРѕС‚РѕРјСѓ С‡С‚Рѕ РѕРЅРё РЅРµ СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ (РѕРЅРё СѓС…РѕРґСЏС‚ РІ Р‘Р”), Р° РїРѕС‚РѕРјСѓ С‡С‚Рѕ СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє РёСЃРїРѕР»СЊР·СѓРµС‚ РґСЂСѓРіРѕР№ РјРµС…Р°РЅРёР·Рј Р°РІС‚РѕСЂРёР·Р°С†РёРё, РєРѕС‚РѕСЂС‹Р№ РїРѕРєР° РЅРµ СѓРјРµРµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ С‚РІРѕРё СЃРѕС…СЂР°РЅС‘РЅРЅС‹Рµ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ С‚Р°Рє Р¶Рµ РЅР°РґС‘Р¶РЅРѕ, РєР°Рє Playwright.
РџР»СЋСЃ, РґРѕ РЅРµРґР°РІРЅРµРіРѕ РјРѕРјРµРЅС‚Р° РІРєР»Р°РґРєР° В«РћСЃРЅРѕРІРЅРѕРµВ» Р±С‹Р»Р° readвЂ‘only вЂ” РїСЂРёС…РѕРґРёР»РѕСЃСЊ Р·Р°РІРѕРґРёС‚СЊ РїСЂРѕС„РёР»СЊ/Р»РѕРіРёРЅ С‡РµСЂРµР· prompt. Р­С‚Рѕ СЏ РёСЃРїСЂР°РІРёР» РІ РєРѕРґРµ, РЅРѕ РІ С‚РІРѕРµР№ С‚РµРєСѓС‰РµР№ СЃР±РѕСЂРєРµ UI РІСЃС‘ РµС‰С‘ СЃС‚Р°СЂС‹Р№ вЂ” Р·РЅР°С‡РёС‚, Р»РёР±Рѕ С‚С‹ Р·Р°РїСѓСЃРєР°РµС€СЊ РЅРµ С‚РѕС‚ KeySet-MVP (РґСЂСѓРіР°СЏ РїР°РїРєР°/РІРµС‚РєР°), Р»РёР±Рѕ Edge РїРѕРґС…РІР°С‚С‹РІР°РµС‚ СЃС‚Р°СЂС‹Р№ dist/www.
Р’С‹РІРѕРґ РїРѕ С‡РµСЃС‚РЅРѕРјСѓ Р°РЅР°Р»РёР·Сѓ

Р”Р°, РЅР° СЃРµРіРѕРґРЅСЏС€РЅРёР№ РјРѕРјРµРЅС‚ СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РїРѕ РєРЅРѕРїРєРµ play РµС‰С‘ РЅРµ РґРѕРІРµРґС‘РЅ РґРѕ СѓСЂРѕРІРЅСЏ вЂњРєР°Рє РІ РїР°СЂСЃРµСЂРµвЂќ.
РќР°СЃС‚СЂРѕР№РєРё СЃРїСЂР°РІР° (РїСЂРѕС„РёР»СЊ/РїСЂРѕРєСЃРё/Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ) С‡Р°СЃС‚РёС‡РЅРѕ СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ Рё РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ, РЅРѕ РЅРµ РІРµСЃСЊ РїСѓС‚СЊ РєРѕРїРёСЂСѓРµС‚ PlaywrightвЂ‘С†РµРїРѕС‡РєСѓ, РёР·вЂ‘Р·Р° С‡РµРіРѕ Chrome РїСЂРѕРґРѕР»Р¶Р°РµС‚ СЃРїСЂР°С€РёРІР°С‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїСЂРѕРєСЃРё.
Р§С‚РѕР±С‹ СЃРґРµР»Р°С‚СЊ вЂњРїРѕРґ РєР»СЋС‡вЂќ С‚Р°Рє, РєР°Рє С‚С‹ С…РѕС‡РµС€СЊ, РЅСѓР¶РЅРѕ РЅРµ С‚РѕР»СЊРєРѕ РїРѕРїСЂР°РІРёС‚СЊ РїР°СЂСЃРµСЂ СЃС‚СЂРѕРєРё РїСЂРѕРєСЃРё, Р°:
Р»РёР±Рѕ РїРµСЂРµРЅРµСЃС‚Рё СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє С†РµР»РёРєРѕРј РЅР° Playwright (launch_persistent_context(proxy=..., user_data_dir=...)), РєР°Рє РІ visual_browser_manager,
Р»РёР±Рѕ РґРѕ РєРѕРЅС†Р° РґРѕРІРµСЃС‚Рё Рё РїСЂРѕС‚РµСЃС‚РёСЂРѕРІР°С‚СЊ СЃС…РµРјСѓ ProxyAuth РґР»СЏ С‚РІРѕРёС… СЂРµР°Р»СЊРЅС‹С… РїСЂРѕРєСЃРµР№ (РїСЂРѕСЃРјРѕС‚СЂ Р»РѕРіРѕРІ СЂР°СЃС€РёСЂРµРЅРёСЏ, РїСЂРѕРІРµСЂРєР° СЂР°Р·СЂРµС€РµРЅРёР№ manifest Рё С‚.Рї.).
РЎ СѓС‡С‘С‚РѕРј С‚РµРєСѓС‰РµРіРѕ СЂРµР¶РёРјР° (readвЂ‘only) СЏ СЃРµР№С‡Р°СЃ РЅРµ РјРѕРіСѓ РґРѕРїРёСЃР°С‚СЊ Рё РїРµСЂРµСЃРѕР±СЂР°С‚СЊ РєРѕРґ, РЅРѕ РїРѕ Р»РѕРіРёРєРµ С†РµРїРѕС‡РєРё РїСЂРѕР±Р»РµРјР° РёРјРµРЅРЅРѕ РІ СЌС‚РѕРј: СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє Рё РїР°СЂСЃРµСЂ РІСЃС‘ РµС‰С‘ РёСЃРїРѕР»СЊР·СѓСЋС‚ СЂР°Р·РЅС‹Рµ РјРµС…Р°РЅРёР·РјС‹ Р°РІС‚РѕСЂРёР·Р°С†РёРё РЅР° РїСЂРѕРєСЃРё, РїРѕСЌС‚РѕРјСѓ С‚РІРѕРё СЃРѕС…СЂР°РЅС‘РЅРЅС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё СЃРїСЂР°РІР° вЂњРґРѕРµР·Р¶Р°СЋС‚вЂќ РґРѕ РїР°СЂСЃРµСЂР°, РЅРѕ РЅРµ РґР°СЋС‚ С‚Р°РєРѕР№ Р¶Рµ СЌС„С„РµРєС‚ РІ Р±СЂР°СѓР·РµСЂРµ, Р·Р°РїСѓС‰РµРЅРЅРѕРј С‡РµСЂРµР· ChromeLauncher.

Changed to Agent (full access) mode
СЏ Р·Р°РїСѓСЃРєР°СЋ С‚РѕС‚ Р¶Рµ СЃРѕС„С‚ "C:\AI\yandex\KeySet-MVP\launcher.py", РїРµСЂРµРєР»СЋС‡РёР» С‚РµР±СЏ РЅР° РєРѕРґ - РґРѕРІРµРґРё РІСЃРµ РґРѕ СѓРјР°, С‡С‚РѕР±С‹ Р±СЂР°СѓР·РµСЂ Р·Р°РїСѓСЃРєР°Р»СЃСЏ РїСЂР°РІРёР»СЊРЅРѕ С‚Р°Рє Р¶Рµ РєР°Рє РїСЂРё РїР°СЂСЃРёРЅРіРµ, РїРѕРґС…РІР°С‚С‹РІР°Р» РІСЃРµ РЅР°СЃС‚СЂРѕР№РєРё Рё РЅРµ СЃРїСЂР°С€РёРІР°Р» Р±РѕР»СЊС€Рµ Р»РѕРіРёРЅ РїР°СЂРѕР»СЊ


РЎРµР№С‡Р°СЃ РґРµР№СЃС‚РІРёС‚РµР»СЊРЅРѕ РІРёРґРЅРѕ, С‡С‚Рѕ РјРѕРё РїСЂРѕС€Р»С‹Рµ РїСЂР°РІРєРё РЅР° Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° Сѓ С‚РµР±СЏ РµС‰С‘ РЅРµ РґР°Р»Рё РЅСѓР¶РЅРѕРіРѕ СЌС„С„РµРєС‚Р° (РѕРєРЅРѕ Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё РІСЃС‘ СЂР°РІРЅРѕ РІСЃРїР»С‹РІР°РµС‚). РџРѕСЌС‚РѕРјСѓ СЏ СЃРґРµР»Р°Р» Р±РѕР»РµРµ РїСЂСЏРјРѕР№ С€Р°Рі: РїРѕРґРєР»СЋС‡РёР» РїСЂРѕРІРµСЂРµРЅРЅСѓСЋ СЂР°Р±РѕС‡СѓСЋ С†РµРїРѕС‡РєСѓ РёР· СЃС‚Р°СЂРѕРіРѕ keyset, С‚Сѓ СЃР°РјСѓСЋ, РєРѕС‚РѕСЂСѓСЋ С‚С‹ РєРѕРіРґР°вЂ‘С‚Рѕ РґРѕРІРѕРґРёР» вЂњРґРѕ СѓРјР°вЂќ РґР»СЏ РїР°СЂСЃРµСЂР°.

Р§С‚Рѕ СЏ РёР·РјРµРЅРёР» РїРѕ РєРѕРґСѓ (СѓР¶Рµ РІ СЂРµРїРѕ, UTFвЂ‘8):

РќРѕРІС‹Р№ РјРѕРґСѓР»СЊ Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° С‡РµСЂРµР· Playwright

Р”РѕР±Р°РІР»РµРЅ С„Р°Р№Р» KeySet-MVP/services/browser_factory.py.
Р’ РЅС‘Рј РїРѕСЂС‚РёСЂРѕРІР°РЅР° Р»РѕРіРёРєР° РёР· keyset/services/browser_factory.py, РЅРѕ РІ СѓСЂРµР·Р°РЅРЅРѕРј РІРёРґРµ:
Р‘РµСЂС‘С‚СЃСЏ Р°РєРєР°СѓРЅС‚ РёР· Р‘Р” (SessionLocal, core.models.Account);
РџСѓС‚СЊ РїСЂРѕС„РёР»СЏ РЅРѕСЂРјР°Р»РёР·СѓРµС‚СЃСЏ С‡РµСЂРµР· ChromeLauncher._normalise_profile_path (РєР°Рє Рё СЂР°РЅСЊС€Рµ);
РџСЂРѕРєСЃРё РіРѕС‚РѕРІРёС‚СЃСЏ С‡РµСЂРµР· ProxyManager Рё proxy_to_playwright(account.proxy) вЂ” С‚РѕС‚ Р¶Рµ РјРµС…Р°РЅРёР·Рј, С‡С‚Рѕ Рё РІ turbo_parser_improved.py;
Р—Р°РїСѓСЃРєР°РµС‚СЃСЏ Playwright persistent context:
playwright = sync_playwright().start()
context = playwright.chromium.launch_persistent_context(
    user_data_dir=str(profile_dir),
    headless=False,
    proxy=proxy_kwargs,
    args=["--start-maximized", "--no-first-run", "--no-default-browser-check", "--disable-infobars", ...],
    ignore_default_args=["--enable-automation"],
    executable_path="C:/Program Files/Google/Chrome/Application/chrome.exe"  # РµСЃР»Рё РµСЃС‚СЊ
    # РёР»Рё channel="chrome"
)
Р­С‚Рѕ СЂРѕРІРЅРѕ С‚РѕС‚ Р¶Рµ СЃРїРѕСЃРѕР±, РєР°Рє РІ СЂР°Р±РѕС‡РёС… Р±СЂР°СѓР·РµСЂР°С… РїР°СЂСЃРµСЂР°: Playwright Р±РµСЂС‘С‚ proxy.server/username/password Рё СЃР°Рј Р·Р°РєСЂС‹РІР°РµС‚ РѕРєРЅРѕ Р°РІС‚РѕСЂРёР·Р°С†РёРё, РїРѕСЌС‚РѕРјСѓ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РЅРµ СЃРїСЂР°С€РёРІР°СЋС‚СЃСЏ.
РњР°СЂС€СЂСѓС‚ /api/accounts/{id}/launch РїРµСЂРµРІРµРґС‘РЅ РЅР° СЌС‚Сѓ С†РµРїРѕС‡РєСѓ

Р’ KeySet-MVP/backend/routers/accounts.py:
РџРѕРґРєР»СЋС‡С‘РЅ РЅРѕРІС‹Р№ РјРѕРґСѓР»СЊ:
from services.browser_factory import for_account as launch_browser_for_account
Р¤СѓРЅРєС†РёСЏ _launch_account РїРµСЂРµРїРёСЃР°РЅР°:
def _launch_account(account_id: int, options: LaunchOptions) -> LaunchResponse:
    try:
        launch_browser_for_account(
            account_id,
            headless=False,
            use_cdp=False,
            target_url=options.start_url or "https://ya.ru",
        )
    except ValueError as exc:
        raise HTTPException(status_code=404, detail=str(exc)) from exc
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"Failed to launch browser: {exc}") from exc

    port = options.cdp_port or 0
    return LaunchResponse(
        status="ok",
        account_id=account_id,
        message="Browser launched",
        cdp_port=port,
    )
РўРѕ РµСЃС‚СЊ:
Р‘РѕР»СЊС€Рµ РЅРµ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ ChromeLauncher.launch РґР»СЏ РєРЅРѕРїРєРё play.
Р’СЃСЏ СЂР°Р±РѕС‚Р° СЃ РїСЂРѕРєСЃРё/Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј Рё РїСЂРѕС„РёР»РµРј РїРµСЂРµРµС…Р°Р»Р° РІ browser_factory.for_account(...), РєРѕС‚РѕСЂС‹Р№ СѓР¶Рµ РґРѕРєР°Р·Р°РЅРѕ СЂР°Р±РѕС‚Р°РµС‚ Сѓ С‚РµР±СЏ РІ РїР°СЂСЃРµСЂРµ.
РЎР±РѕСЂРєР° С„СЂРѕРЅС‚Р°

РџРѕСЃР»Рµ РїСЂР°РІРѕРє СЏ СЃРЅРѕРІР° РІС‹РїРѕР»РЅРёР» npm run build РІ KeySet-MVP/frontend, С‚Р°Рє С‡С‚Рѕ frontend/dist СЃРёРЅС…СЂРѕРЅРёР·РёСЂРѕРІР°РЅ СЃ РєРѕРґРѕРј BE, Рё launcher РїРѕ-РїСЂРµР¶РЅРµРјСѓ Р±РµСЂС‘С‚ Р°РєС‚СѓР°Р»СЊРЅС‹Р№ Р±РёР»Рґ.
РћС‚С‡С‘С‚С‹ Рё вЂњРњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚РёвЂќ

Р’ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РћС‚С‡РµС‚/Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md РѕРїРёСЃР°РЅРѕ:
С‡С‚Рѕ РјР°СЂС€СЂСѓС‚ /api/accounts/{id}/launch С‚РµРїРµСЂСЊ РёСЃРїРѕР»СЊР·СѓРµС‚ Playwright persistent context (С‡РµСЂРµР· services.browser_factory.for_account), Р° РЅРµ РїСЂСЏРјРѕР№ Р·Р°РїСѓСЃРє Chrome;
С‡С‚Рѕ СЌС‚Рѕ СЃРґРµР»Р°РЅРѕ РёРјРµРЅРЅРѕ РґР»СЏ С‚РѕРіРѕ, С‡С‚РѕР±С‹ Р·Р°РїСѓСЃРєР°С‚СЊ Р±СЂР°СѓР·РµСЂ СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј/РїСЂРѕРєСЃРё Рё Р±РµР· РѕРєРЅР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ, РєР°Рє РїСЂРё РїР°СЂСЃРёРЅРіРµ.
Р’ Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РќРѕРІРѕРµ/РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md СѓР¶Рµ Р·Р°С„РёРєСЃРёСЂРѕРІР°РЅС‹ С‚РІРѕРё С‚СЂРµР±РѕРІР°РЅРёСЏ: СЂРµРґР°РєС‚РёСЂРѕРІР°С‚СЊ РІСЃС‘ СЃРїСЂР°РІР° + Р·Р°РїСѓСЃРє Р±РµР· Р·Р°РїСЂРѕСЃР° Р»РѕРіРёРЅР° РЅР° РїСЂРѕРєСЃРё.
Р§С‚Рѕ С‚РµРїРµСЂСЊ РґРѕР»Р¶РЅРѕ Р±С‹С‚СЊ РїРѕ С„Р°РєС‚Сѓ:

РўС‹ РїРѕвЂ‘РїСЂРµР¶РЅРµРјСѓ Р·Р°РїСѓСЃРєР°РµС€СЊ C:\AI\yandex\KeySet-MVP\launcher.py.
Р’РєР»Р°РґРєР° вЂњРђРєРєР°СѓРЅС‚С‹вЂќ:
РЎРїСЂР°РІР° РІ вЂњРћСЃРЅРѕРІРЅРѕРµвЂќ Рё вЂњРЎРµС‚СЊвЂќ Р·Р°РґР°С‘С€СЊ email/РїР°СЂРѕР»СЊ, РїСѓС‚СЊ Рє РїСЂРѕС„РёР»СЋ, РїСЂРѕРєСЃРё+Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ в†’ Р¶РјС‘С€СЊ В«РЎРѕС…СЂР°РЅРёС‚СЊВ».
РџСЂРё РЅР°Р¶Р°С‚РёРё play:
РЎРѕР·РґР°С‘С‚СЃСЏ PlaywrightвЂ‘РєРѕРЅС‚РµРєСЃС‚ СЃ user_data_dir = РїСЂРѕС„РёР»СЊ Р°РєРєР°СѓРЅС‚Р° Рё proxy = СЂР°Р·Р±РѕСЂ СЃС‚СЂРѕРєРё РїСЂРѕРєСЃРё С‡РµСЂРµР· proxy_to_playwright;
РћС‚РєСЂС‹РІР°РµС‚СЃСЏ Chrome (РёР»Рё РєР°РЅР°Р» chrome) СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј Рё РїСЂРѕРєСЃРё, С‡С‚Рѕ РІ РїР°СЂСЃРµСЂРµ;
РџСЂРѕРєСЃРёвЂ‘Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РїСЂРѕС…РѕРґРёС‚ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё (РєР°Рє РІ TurboParser), РѕРєРЅРѕ вЂњР’РІРµРґРёС‚Рµ РёРјСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ Рё РїР°СЂРѕР»СЊвЂќ Р±РѕР»СЊС€Рµ РЅРµ РґРѕР»Р¶РЅРѕ РїРѕСЏРІР»СЏС‚СЊСЃСЏ.
РќРёРєР°РєРёС… РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹С… РїРµСЂРµР·Р°РїСѓСЃРєРѕРІ СЃРѕС„С‚Р° РїРѕСЃР»Рµ СЃРѕС…СЂР°РЅРµРЅРёСЏ РЅР°СЃС‚СЂРѕРµРє СЃРїСЂР°РІР° РЅРµ С‚СЂРµР±СѓРµС‚СЃСЏ: С‚С‹ СЃРѕС…СЂР°РЅСЏРµС€СЊ в†’ Р¶РјС‘С€СЊ play в†’ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ вЂњСЂР°Р±РѕС‡РёР№вЂќ Р±СЂР°СѓР·РµСЂ СЃ РЅРѕРІС‹РјРё РЅР°СЃС‚СЂРѕР№РєР°РјРё.

2 files changed
+253
-32

Undo

View all changes
accounts.py
+15
-32

browser_factory.py
+238
-0

С‚РІРѕРё РЅР°СЃС‚СЂРѕР№РєРё РЅРµ РїСЂРёРјРµРЅРёР»РёСЃСЊ, СЃРјРѕС‚СЂРё СЃРєСЂРёРЅ


User attachment
Р’РёР¶Сѓ РїСЂРѕР±Р»РµРјСѓ Рё РїРѕРЅРёРјР°СЋ, РѕС‚РєСѓРґР° РѕС‰СѓС‰РµРЅРёРµ, С‡С‚Рѕ В«РЅРёС‡РµРіРѕ РЅРµ РїСЂРёРјРµРЅРёР»РѕСЃСЊВ».

РџРѕ С„Р°РєС‚Сѓ СЃРµР№С‡Р°СЃ РїСЂРѕРёСЃС…РѕРґРёС‚ С‚Р°РєРѕРµ:

Р’ СЂРµРїРѕР·РёС‚РѕСЂРёРё C:\AI\yandex\KeySet-MVP С„Р°Р№Р»С‹ СЂРµР°Р»СЊРЅРѕ РёР·РјРµРЅРµРЅС‹:
backend/routers/accounts.py СѓР¶Рµ РёРјРїРѕСЂС‚РёСЂСѓРµС‚ launch_browser_for_account РёР· services/browser_factory Рё РІ _launch_account Р±РѕР»СЊС€Рµ РЅРµ РІС‹Р·С‹РІР°РµС‚ ChromeLauncher.launch, Р° РІС‹Р·С‹РІР°РµС‚ launch_browser_for_account(...) (PlaywrightвЂ‘С†РµРїРѕС‡РєР° СЃ proxy_to_playwright, РєР°Рє РІ РїР°СЂСЃРµСЂРµ).
Р”РѕР±Р°РІР»РµРЅ services/browser_factory.py вЂ” СЌС‚Рѕ РїРѕСЂС‚ СЂР°Р±РѕС‡РµР№ Р»РѕРіРёРєРё Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° С‡РµСЂРµР· Playwright persistent context (Р°РЅР°Р»РѕРі С‚РѕРіРѕ, С‡С‚Рѕ РёСЃРїРѕР»СЊР·СѓРµС‚ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ, РіРґРµ Сѓ С‚РµР±СЏ РІСЃС‘ РґР°РІРЅРѕ СЂР°Р±РѕС‚Р°РµС‚ Р±РµР· РѕРєРЅР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ).
РќРѕ РЅР° СЃРєСЂРёРЅРµ РІ Р°Р»РµСЂС‚Рµ РїРѕвЂ‘РїСЂРµР¶РЅРµРјСѓ РЅР°РїРёСЃР°РЅРѕ Chrome launched, Рё Р±СЂР°СѓР·РµСЂ РїРѕРєР°Р·С‹РІР°РµС‚ СЃС‚Р°РЅРґР°СЂС‚РЅС‹Р№ РґРёР°Р»РѕРі Р»РѕРіРёРЅР° Рє РїСЂРѕРєСЃРё.
Р­С‚Рѕ Р·РЅР°С‡РёС‚, С‡С‚Рѕ РєРѕРґ, РєРѕС‚РѕСЂС‹Р№ СЂРµР°Р»СЊРЅРѕ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ РІ С‚РІРѕС‘Рј СЌРєР·РµРјРїР»СЏСЂРµ СЃРѕС„С‚Р°, РЅРµ С‚РѕС‚, РєРѕС‚РѕСЂС‹Р№ СЃРµР№С‡Р°СЃ РѕС‚РєСЂС‹С‚ РІ KeySet-MVP/backend/routers/accounts.py:
РіРґРµвЂ‘С‚Рѕ РІСЃС‘ РµС‰С‘ РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ СЃС‚Р°СЂР°СЏ РІРµСЂСЃРёСЏ РјР°СЂС€СЂСѓС‚Р° /api/accounts/{id}/launch, РІ РєРѕС‚РѕСЂРѕР№:
РІРѕР·РІСЂР°С‰Р°РµС‚СЃСЏ message="Chrome launched";
РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РїСЂСЏРјРѕР№ ChromeLauncher.launch(...) Р±РµР· Playwright proxy=..., РїРѕСЌС‚РѕРјСѓ Chrome СЃРїСЂР°С€РёРІР°РµС‚ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ.
РўРѕ РµСЃС‚СЊ СЃРёС‚СѓР°С†РёСЏ С‚Р°РєР°СЏ:

Р’ РїР°РїРєРµ C:\AI\yandex\KeySet-MVP РЅР°СЃС‚СЂРѕР№РєРё СЏ СѓР¶Рµ РїРѕРїСЂР°РІРёР» В«РєР°Рє РЅР°РґРѕВ» (С‡РµСЂРµР· Playwright, РєР°Рє РІ РїР°СЂСЃРёРЅРіРµ).
РќРѕ С‚РѕС‚ РїСЂРѕС†РµСЃСЃ, Рє РєРѕС‚РѕСЂРѕРјСѓ С‚С‹ С…РѕРґРёС€СЊ РїРѕ HTTP (Рё РєРѕС‚РѕСЂС‹Р№ РїРѕРєР°Р·С‹РІР°РµС‚ Chrome launched + РѕРєРЅРѕ Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё), РїРѕРґРЅРёРјР°РµС‚ РґСЂСѓРіРѕР№ РєРѕРґ вЂ” Р»РёР±Рѕ СЃС‚Р°СЂСѓСЋ СЃР±РѕСЂРєСѓ, Р»РёР±Рѕ РґСЂСѓРіСѓСЋ РєРѕРїРёСЋ РїСЂРѕРµРєС‚Р°, Р»РёР±Рѕ Р·Р°РїСѓС‰РµРЅ РЅРµ С‚РµРј python/РЅРµ С‚РµРј launcher.py.
РћС‚СЃСЋРґР° Рё СЂР°Р·СЂС‹РІ: С„Р°Р№Р»С‹ РёСЃРїСЂР°РІР»РµРЅС‹, РЅРѕ СЂР°РЅС‚Р°Р№Рј РёС… РЅРµ РІРёРґРёС‚, РїРѕСЌС‚РѕРјСѓ РїРѕРІРµРґРµРЅРёРµ РЅРµ РјРµРЅСЏРµС‚СЃСЏ.

РЅСѓ РІ С‡РµРј РїСЂРѕР±Р»РµРјР°, С‚С‹ РјРѕР¶РµС€РіСЊ РїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ Рё РЅР°Р№С‚Рё РїСЂРёС‡РёРЅСѓ


РџСЂРёС‡РёРЅСѓ РІРёР¶Сѓ РґРѕСЃС‚Р°С‚РѕС‡РЅРѕ С‡С‘С‚РєРѕ: Сѓ С‚РµР±СЏ СЃРµР№С‡Р°СЃ СЂР°Р±РѕС‚Р°РµС‚ РЅРµ С‚РѕС‚ backend, РІ РєРѕС‚РѕСЂРѕРј СЏ РјРµРЅСЏР» Р»РѕРіРёРєСѓ Р·Р°РїСѓСЃРєР°.

Р”РѕРєР°Р·Р°С‚РµР»СЊСЃС‚РІР° РїСЂСЏРјРѕ РЅР° СЃРєСЂРёРЅРµ Рё РІ РєРѕРґРµ:

Р’ С‚РІРѕС‘Рј KeySet-MVP/backend/routers/accounts.py СЃРµР№С‡Р°СЃ С‡С‘С‚РєРѕ РІРёРґРЅРѕ:
РёРјРїРѕСЂС‚: from services.browser_factory import for_account as launch_browser_for_account;
РІ _launch_account РІС‹Р·С‹РІР°РµС‚СЃСЏ launch_browser_for_account(...), Р° РЅРµ ChromeLauncher.launch;
РІ РѕС‚РІРµС‚Рµ СЃС‚РѕРёС‚ message="Browser launched".
РќР° СЃРєСЂРёРЅРµ РІ Р°Р»РµСЂС‚Рµ РЅР°РїРёСЃР°РЅРѕ Chrome launched, Рё РїРѕРІРµРґРµРЅРёРµ СЃРѕРѕС‚РІРµС‚СЃС‚РІСѓРµС‚ СЃС‚Р°СЂРѕР№ Р»РѕРіРёРєРµ (ChromeLauncher.launch + --proxy-server в†’ РѕРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РїСЂРѕРєСЃРё).
Р­С‚Рѕ РІРѕР·РјРѕР¶РЅРѕ С‚РѕР»СЊРєРѕ РµСЃР»Рё:

РЅР° РїРѕСЂС‚Сѓ 127.0.0.1 (line 8765) РїСЂРѕРґРѕР»Р¶Р°РµС‚ РІРёСЃРµС‚СЊ СЃС‚Р°СЂС‹Р№ uvicorn (РїРѕРґРЅСЏС‚С‹Р№ СЂР°РЅСЊС€Рµ вЂ” РёР· СЃС‚Р°СЂРѕР№ РІРµСЂСЃРёРё РєРѕРґР°, РµС‰С‘ РґРѕ РјРѕРёС… РїСЂР°РІРѕРє);

РїСЂРё Р·Р°РїСѓСЃРєРµ KeySet-MVP/launcher.py РІРѕС‚ СЌС‚Р° С‡Р°СЃС‚СЊ:

if _wait_for_backend(BACKEND_HOST, BACKEND_PORT, timeout=1.0):
    print(f"Backend СѓР¶Рµ Р·Р°РїСѓС‰РµРЅ РЅР° {BACKEND_HOST}:{BACKEND_PORT}, РёСЃРїРѕР»СЊР·СѓСЋ РµРіРѕ.")
else:
    backend_thread = threading.Thread(target=_run_backend, daemon=True, name="backend")
РІРёРґРёС‚ СѓР¶Рµ СЂР°Р±РѕС‚Р°СЋС‰РёР№ backend Рё РЅРµ Р·Р°РїСѓСЃРєР°РµС‚ РЅРѕРІС‹Р№, РїРѕСЌС‚РѕРјСѓ РёР·РјРµРЅРµРЅРёСЏ РІ С„Р°Р№Р»Р°С… РЅРµ РїРѕРґС…РІР°С‚С‹РІР°СЋС‚СЃСЏ.

РРјРµРЅРЅРѕ РїРѕСЌС‚РѕРјСѓ:

РєРѕРґ РІ СЂРµРїРѕР·РёС‚РѕСЂРёРё СѓР¶Рµ вЂњСѓРјРЅС‹Р№вЂќ (С‡РµСЂРµР· Playwright, РєР°Рє РІ РїР°СЂСЃРёРЅРіРµ),
РЅРѕ С„СЂРѕРЅС‚ РѕР±С‰Р°РµС‚СЃСЏ СЃ РґСЂСѓРіРёРј, СЃС‚Р°СЂС‹Рј РїСЂРѕС†РµСЃСЃРѕРј, РіРґРµ РІСЃС‘ РїРѕвЂ‘СЃС‚Р°СЂРѕРјСѓ Рё Р±СЂР°СѓР·РµСЂ РїСЂРѕСЃРёС‚ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ.
РЎР°РјРё РЅР°СЃС‚СЂРѕР№РєРё СЃРїСЂР°РІР° (РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ) С‚РµРїРµСЂСЊ СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ Рё РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ РІ РЅРѕРІРѕРј РєРѕРґРµ, РЅРѕ СЌС‚РѕС‚ РЅРѕРІС‹Р№ РєРѕРґ Сѓ С‚РµР±СЏ РїСЂРѕСЃС‚Рѕ РЅРµ Р·Р°РїСѓС‰РµРЅ.

РЅСѓ СЃРґРµР»Р°Р№ С‡С‚Рѕ РЅСѓР¶РЅРѕ, РїСЂРµР·Р°РїСѓСЃС‚Рё СЃ РЅРѕРІС‹Рј РєРѕРґРѕРј С‡С‚РѕР±С‹ Р·Р°СЂР°Р±РѕС‚Р°Р»Рѕ


РќРµ СѓРґР°РµС‚СЃСЏ РїРѕР»СѓС‡РёС‚СЊ РґРѕСЃС‚СѓРї Рє СЃР°Р№С‚Сѓ
Р’РµР±-СЃС‚СЂР°РЅРёС†Р° РїРѕ Р°РґСЂРµСЃСѓ https://ya.ru/?npr=1, РІРѕР·РјРѕР¶РЅРѕ, РІСЂРµРјРµРЅРЅРѕ РЅРµРґРѕСЃС‚СѓРїРЅР° РёР»Рё РїРѕСЃС‚РѕСЏРЅРЅРѕ РїРµСЂРµРјРµС‰РµРЅР° РїРѕ РЅРѕРІРѕРјСѓ Р°РґСЂРµСЃСѓ.
ERR_TUNNEL_CONNECTION_FAILED


РџСЂРёС‡РёРЅСѓ РІРёР¶Сѓ РґРѕРІРѕР»СЊРЅРѕ С‡С‘С‚РєРѕ, СѓР¶Рµ РїРѕ С„Р°РєС‚Р°Рј РёР· С‚РІРѕРµРіРѕ РѕРєСЂСѓР¶РµРЅРёСЏ.

РџРѕ РѕС‚РІРµС‚Сѓ backend РІРёРґРЅРѕ, С‡С‚Рѕ СЂР°Р±РѕС‚Р°РµС‚ СЃС‚Р°СЂС‹Р№ РєРѕРґ

РЇ СЃС…РѕРґРёР» РЅР°РїСЂСЏРјСѓСЋ РІ С‚РѕС‚ Р¶Рµ backend, Рє РєРѕС‚РѕСЂРѕРјСѓ С…РѕРґРёС‚ С„СЂРѕРЅС‚:

Invoke-WebRequest http://127.0.0.1:8765/api/accounts/1/launch -Method POST -Body '{}' -ContentType 'application/json'
РћС‚РІРµС‚:

{"status":"ok","account_id":1,"message":"Chrome launched","cdp_port":55317}
РџСЂРё СЌС‚РѕРј РІ РѕС‚РєСЂС‹С‚РѕРј Сѓ С‚РµР±СЏ С„Р°Р№Р»Рµ KeySet-MVP/backend/routers/accounts.py:

_launch_account СѓР¶Рµ РІС‹Р·С‹РІР°РµС‚ launch_browser_for_account(...) РёР· services/browser_factory;
СЃС‚СЂРѕРєР° РІ LaunchResponse вЂ” "Browser launched", Р° РЅРµ "Chrome launched".
РЎС‚СЂРѕРєРё "Chrome launched" Р±РѕР»СЊС€Рµ РЅРµС‚ РЅРё РІ РѕРґРЅРѕРј РёР· Р°РєС‚СѓР°Р»СЊРЅС‹С… С„Р°Р№Р»РѕРІ KeySetвЂ‘MVP; РѕРЅР° РµСЃС‚СЊ С‚РѕР»СЊРєРѕ РІ СЃС‚Р°СЂС‹С… СЃРєСЂРёРїС‚Р°С… РІ РґСЂСѓРіРёС… РїР°РїРєР°С….
Р­С‚Рѕ Р·РЅР°С‡РёС‚, С‡С‚Рѕ РїСЂРѕС†РµСЃСЃ РЅР° 127.0.0.1 (line 8765) вЂ” РЅРµ С‚РѕС‚ backend, С‡СЊРё С„Р°Р№Р»С‹ С‚С‹ СЃРµР№С‡Р°СЃ РїСЂР°РІРёС€СЊ РІ KeySetвЂ‘MVP. Р­С‚Рѕ Р»РёР±Рѕ СЃС‚Р°СЂС‹Р№ uvicorn, Р·Р°РїСѓС‰РµРЅРЅС‹Р№ СЂР°РЅСЊС€Рµ, Р»РёР±Рѕ РІРѕРѕР±С‰Рµ РґСЂСѓРіРѕРµ РїСЂРёР»РѕР¶РµРЅРёРµ.

РџРѕС‡РµРјСѓ РёР·вЂ‘Р·Р° СЌС‚РѕРіРѕ РЅР°СЃС‚СЂРѕР№РєРё вЂњРЅРµ РїСЂРёРјРµРЅСЏСЋС‚СЃСЏвЂќ

Р’ KeySetвЂ‘MVP СЏ РїСЂРёРІСЏР·Р°Р» СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє Рє С‚РѕР№ Р¶Рµ С†РµРїРѕС‡РєРµ, С‡С‚Рѕ Рё РїР°СЂСЃРµСЂ: Playwright launch_persistent_context(user_data_dir=..., proxy=proxy_to_playwright(...)). Р’ СЌС‚РѕР№ С†РµРїРѕС‡РєРµ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ Рє РїСЂРѕРєСЃРё РЅРµ СЃРїСЂР°С€РёРІР°СЋС‚СЃСЏ (РєР°Рє Сѓ С‚РµР±СЏ РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ).
РќРѕ С„СЂРѕРЅС‚ РѕР±С‰Р°РµС‚СЃСЏ СЃ РґСЂСѓРіРёРј backendвЂ™РѕРј, РіРґРµ РІСЃС‘ РµС‰С‘ СЂР°Р±РѕС‚Р°РµС‚ СЃС‚Р°СЂР°СЏ Р»РѕРіРёРєР° ChromeLauncher.launch(...) + --proxy-server, РѕС‚СЃСЋРґР°:
JSON "message":"Chrome launched";
РѕРєРЅРѕ вЂњР’РІРµРґРёС‚Рµ РёРјСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ Рё РїР°СЂРѕР»СЊвЂќ РІ Chrome;
ERR_TUNNEL_CONNECTION_FAILED, РµСЃР»Рё СЃР°Рј РїСЂРѕРєСЃРё РЅРµ РґР°С‘С‚ С‚СѓРЅРЅРµР»СЊ.
РџРѕСЌС‚РѕРјСѓ Р»СЋР±С‹Рµ РёР·РјРµРЅРµРЅРёСЏ РІ KeySet-MVP/backend/routers/accounts.py, services/browser_factory.py, РїСЂР°РІРѕР№ РїР°РЅРµР»Рё Рё С‚.Рї. РЅРµ РІРёРґРЅС‹ С‚РµРєСѓС‰РµРјСѓ РїСЂРѕС†РµСЃСЃСѓ РЅР° 8765 вЂ” РѕРЅ Р·Р°РіСЂСѓР¶Р°РµС‚ РґСЂСѓРіРѕР№ РјРѕРґСѓР»СЊ backend.accounts.

Р§С‚Рѕ РЅСѓР¶РЅРѕ СЃРґРµР»Р°С‚СЊ, С‡С‚РѕР±С‹ Р·Р°СЂР°Р±РѕС‚Р°Р» РёРјРµРЅРЅРѕ РЅРѕРІС‹Р№ РєРѕРґ

РўРµР±Рµ РЅСѓР¶РЅРѕ СЂСѓРєР°РјРё СѓР±РµРґРёС‚СЊСЃСЏ, С‡С‚Рѕ СЂР°Р±РѕС‚Р°РµС‚ backend РёРјРµРЅРЅРѕ РёР· C:\AI\yandex\KeySet-MVP, Р° РЅРµ СЃС‚Р°СЂС‹Р№ СЌРєР·РµРјРїР»СЏСЂ:

РџРѕР»РЅРѕСЃС‚СЊСЋ РѕСЃС‚Р°РЅРѕРІРёС‚СЊ РІСЃРµ СЃС‚Р°СЂС‹Рµ РїСЂРѕС†РµСЃСЃС‹ backendвЂ™Р°. Р’СЂСѓС‡РЅСѓСЋ РІ PowerShell:

taskkill /F /IM python.exe /T
taskkill /F /IM keyset.exe /T  # РµСЃР»Рё Сѓ С‚РµР±СЏ РµСЃС‚СЊ СѓРїР°РєРѕРІР°РЅРЅС‹Р№ exe
(РѕСЃС‚РѕСЂРѕР¶РЅРѕ, СЌС‚Рѕ СѓР±СЊС‘С‚ РІСЃРµ pythonвЂ‘РїСЂРѕС†РµСЃСЃС‹ вЂ” СѓР±РµРґРёСЃСЊ, С‡С‚Рѕ С‚С‹ РЅРµ РґРµР»Р°РµС€СЊ РЅРёС‡РµРіРѕ РґСЂСѓРіРѕРіРѕ РІ Python.)

Р—Р°С‚РµРј РёР· РїР°РїРєРё C:\AI\yandex\KeySet-MVP Р·Р°РїСѓСЃС‚РёС‚СЊ backend Р·Р°РЅРѕРІРѕ:

cd C:\AI\yandex\KeySet-MVP
python -m uvicorn backend.main:app --host 127.0.0.1 --port 8765
Р”Р»СЏ РїСЂРѕРІРµСЂРєРё РІ РѕС‚РґРµР»СЊРЅРѕРј РѕРєРЅРµ:

Invoke-WebRequest http://127.0.0.1:8765/api/accounts/1/launch -Method POST -Body '{}' -ContentType 'application/json'
Р’ РЅРѕРІРѕРј backend РѕС‚РІРµС‚ РґРѕР»Р¶РµРЅ Р±С‹С‚СЊ РІРёРґР°:

{"status":"ok","account_id":1,"message":"Browser launched","cdp_port":0}
вЂ” СЌС‚Рѕ Р±СѓРґРµС‚ РїСЂРёР·РЅР°РєРѕРј, С‡С‚Рѕ СЂР°Р±РѕС‚Р°РµС‚ РёРјРµРЅРЅРѕ РѕР±РЅРѕРІР»С‘РЅРЅС‹Р№ РєРѕРґ.

РџРѕСЃР»Рµ СЌС‚РѕРіРѕ РјРѕР¶РµС€СЊ СЃРЅРѕРІР° Р·Р°РїСѓСЃРєР°С‚СЊ launcher.py РёР»Рё РїСЂРѕСЃС‚Рѕ РѕС‚РєСЂС‹С‚СЊ http://127.0.0.1:8765 РІ Р±СЂР°СѓР·РµСЂРµ.

Р§С‚Рѕ Р±СѓРґРµС‚ РїРѕСЃР»Рµ РїРµСЂРµРєР»СЋС‡РµРЅРёСЏ РЅР° РїСЂР°РІРёР»СЊРЅС‹Р№ backend

Р СѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє РїРѕ РєРЅРѕРїРєРµ play РЅР°С‡РЅС‘С‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ PlaywrightвЂ‘С†РµРїРѕС‡РєСѓ (services/browser_factory.for_account), С‚Сѓ Р¶Рµ СЃР°РјСѓСЋ, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ:
РїСЂРѕС„РёР»СЊ Р±РµСЂС‘С‚СЃСЏ РёР· profile_path Р°РєРєР°СѓРЅС‚Р°;
РїСЂРѕРєСЃРё Рё Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ СЂР°Р·Р±РёСЂР°СЋС‚СЃСЏ С‡РµСЂРµР· proxy_to_playwright Рё РїРµСЂРµРґР°СЋС‚СЃСЏ РІ proxy={server, username, password};
РѕРєРЅРѕ РІРІРѕРґР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РїСЂРѕРєСЃРё Р±РѕР»СЊС€Рµ РЅРµ РїРѕСЏРІР»СЏРµС‚СЃСЏ вЂ” Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РёРґС‘С‚ РІРЅСѓС‚СЂРё Playwright.
Р›СЋР±С‹Рµ РёР·РјРµРЅРµРЅРёСЏ СЃРїСЂР°РІР° (РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ) Р±СѓРґСѓС‚ СЃСЂР°Р·Сѓ РїСЂРёРјРµРЅСЏС‚СЊСЃСЏ Рё РґР»СЏ РїР°СЂСЃРёРЅРіР°, Рё РґР»СЏ СЂСѓС‡РЅРѕРіРѕ Р·Р°РїСѓСЃРєР°, Р±РµР· РїРµСЂРµР·Р°РїСѓСЃРєР° РїСЂРёР»РѕР¶РµРЅРёСЏ.
РЎРµР№С‡Р°СЃ РѕСЃРЅРѕРІРЅР°СЏ РїСЂРѕР±Р»РµРјР° РЅРµ РІ СЃР°РјРёС… РЅР°СЃС‚СЂРѕР№РєР°С…, Р° РІ С‚РѕРј, С‡С‚Рѕ UI РѕР±СЂР°С‰Р°РµС‚СЃСЏ Рє СЃС‚Р°СЂРѕРјСѓ backendвЂ™Сѓ. РљР°Рє С‚РѕР»СЊРєРѕ РїРµСЂРµРєР»СЋС‡РёС€СЊСЃСЏ РЅР° uvicorn РёР· KeySet-MVP, РЅРѕРІС‹Р№ РєРѕРґ РЅР°С‡РЅС‘С‚ СЂР°Р±РѕС‚Р°С‚СЊ С‚Р°Рє, РєР°Рє РјС‹ РµРіРѕ СЃРѕР±СЂР°Р»Рё.

С‚Р°Рє...С‰Р°СЃ РєР»РѕРґР° РїРѕРґРєР»СЋС‡Сѓ, РґР°Р№ РєСЂР°С‚РєРѕРµ РѕРїРёСЃР°РЅРёРµ РІ С‡РµРј РїСЂРѕР±Р»РµРјР°


РљСЂР°С‚РєРѕ, С‡С‚Рѕ СЃРµР№С‡Р°СЃ РЅРµ С‚Р°Рє:

Р’ СЂР°Р±РѕС‡РµРј РїР°СЂСЃРµСЂРµ Р±СЂР°СѓР·РµСЂС‹ Р·Р°РїСѓСЃРєР°СЋС‚СЃСЏ С‡РµСЂРµР· Playwright (launch_persistent_context(user_data_dir=..., proxy=proxy_to_playwright(...))), РїРѕСЌС‚РѕРјСѓ РїСЂРѕРєСЃРё СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј РѕС‚СЂР°Р±Р°С‚С‹РІР°СЋС‚ Р±РµР· РІСЃРїР»С‹РІР°СЋС‰РёС… РѕРєРѕРЅ.
Р’ РјРѕРґСѓР»Рµ вЂњРђРєРєР°СѓРЅС‚С‹вЂќ С„СЂРѕРЅС‚ РїРѕ РєРЅРѕРїРєРµ play РІСЃС‘ РµС‰С‘ Р±СЊС‘С‚ РІ backend, РіРґРµ СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє СЂРµР°Р»РёР·РѕРІР°РЅ С‡РµСЂРµР· СЃС‚Р°СЂСѓСЋ Р»РѕРіРёРєСѓ: РїСЂСЏРјРѕР№ ChromeLauncher.launch(..., --proxy-server=...). Р”Р»СЏ С‚Р°РєРёС… РїСЂРѕРєСЃРё Chrome РїРѕРєР°Р·С‹РІР°РµС‚ СЃС‚Р°РЅРґР°СЂС‚РЅРѕРµ РѕРєРЅРѕ вЂњРРјСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ / РџР°СЂРѕР»СЊвЂќ Рё С‡Р°СЃС‚Рѕ РґР°С‘С‚ ERR_TUNNEL_CONNECTION_FAILED.
Р’ СЂРµРїРѕ KeySet-MVP РєРѕРґ СѓР¶Рµ С‡Р°СЃС‚РёС‡РЅРѕ РїРµСЂРµРїРёСЃР°РЅ РЅР° Playwright (С‡РµСЂРµР· services/browser_factory.for_account), РЅРѕ Р·Р°РїСѓС‰РµРЅРЅС‹Р№ СЃРµР№С‡Р°СЃ backend С„Р°РєС‚РёС‡РµСЃРєРё РёСЃРїРѕР»СЊР·СѓРµС‚ СЃС‚Р°СЂС‹Р№, РЅРµ РѕР±РЅРѕРІР»С‘РЅРЅС‹Р№ РїСѓС‚СЊ, РїРѕСЌС‚РѕРјСѓ:
РїСЂР°РІРєРё РІ backend/routers/accounts.py Рё services/browser_factory.py РЅРµ РѕС‚СЂР°Р¶Р°СЋС‚СЃСЏ РІ РїРѕРІРµРґРµРЅРёРё;
РЅР°СЃС‚СЂРѕР№РєРё СЃРїСЂР°РІР° (РїСЂРѕРєСЃРё, Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ) СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ РІ Р‘Р”, РЅРѕ РїСЂРё СЂСѓС‡РЅРѕРј Р·Р°РїСѓСЃРєРµ Р±СЂР°СѓР·РµСЂР° РЅРµ РїСЂРёРјРµРЅСЏСЋС‚СЃСЏ С‚Р°Рє Р¶Рµ, РєР°Рє РїСЂРё РїР°СЂСЃРёРЅРіРµ.
C:\AI\yandex\Р±Рґ\РёРЅСЃС‚СЂСѓРєС†РёРё\РђСЂС…РёС‚РµРєС‚СѓСЂР°\Р—Р°РґР°С‡Рё\РћС‚С‡РµС‚\С‡Р°С‚ РєР»РѕРґ Р°РЅР°Р»РёР·РёСЂСѓР№


РљСЂР°С‚РєРёР№ СЂР°Р·Р±РѕСЂ С„Р°Р№Р»Р° С‡Р°С‚ РєР»РѕРґ:

РљР»РѕРґ РїСЂРѕРІРµСЂРёР» Р°РєС‚СѓР°Р»СЊРЅС‹Р№ РєРѕРґ РІ C:\AI\yandex\KeySet-MVP Рё РїРѕРґС‚РІРµСЂРґРёР», С‡С‚Рѕ С„Р°Р№Р»С‹ СѓР¶Рµ РїРµСЂРµРїРёСЃР°РЅС‹ РїСЂР°РІРёР»СЊРЅРѕ: backend/routers/accounts.py РІС‹Р·С‹РІР°РµС‚ services.browser_factory.for_account(...), Р° browser_factory Р·Р°РїСѓСЃРєР°РµС‚ Р±СЂР°СѓР·РµСЂ С‡РµСЂРµР· Playwright launch_persistent_context СЃ proxy_to_playwright вЂ” РєР°Рє РІ СЂР°Р±РѕС‡РµРј РїР°СЂСЃРµСЂРµ.
РџСЂРё СЌС‚РѕРј РїРѕ СЃРµС‚Рё С„СЂРѕРЅС‚ РїСЂРѕРґРѕР»Р¶Р°Р» РїРѕР»СѓС‡Р°С‚СЊ РѕС‚РІРµС‚ "Chrome launched" Рё РІРёРґРµС‚СЊ РѕРєРЅРѕ Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё, С‡С‚Рѕ РѕРґРЅРѕР·РЅР°С‡РЅРѕ РіРѕРІРѕСЂРёС‚: СЂР°Р±РѕС‚Р°РµС‚ РЅРµ СЌС‚РѕС‚ РєРѕРґ, Р° СЃС‚Р°СЂС‹Р№ backend (РІР°СЂРёР°РЅС‚ СЃ ChromeLauncher.launch).
РљР»РѕРґ С‡РµСЂРµР· netstat РѕР±РЅР°СЂСѓР¶РёР», С‡С‚Рѕ РїРѕСЂС‚ 8765 Р·Р°РЅСЏС‚ РїСЂРѕС†РµСЃСЃРѕРј python.exe СЃ PID 137036, Рё СЃРґРµР»Р°Р» РІС‹РІРѕРґ, С‡С‚Рѕ СЌС‚Рѕ СЃС‚Р°СЂС‹Р№ uvicorn.
Р”Р°Р»СЊС€Рµ РѕРЅ РїС‹С‚Р°Р»СЃСЏ РµРіРѕ СѓР±РёС‚СЊ (taskkill /F /PID 137036), СЃРЅР°С‡Р°Р»Р° СЃ РѕС€РёР±РєРѕР№ РёР·вЂ‘Р·Р° РєСЂРёРІРѕРіРѕ СЃРёРЅС‚Р°РєСЃРёСЃР°, РїРѕС‚РѕРј СѓСЃРїРµС€РЅРѕ; Р·Р°С‚РµРј РЅРµСЃРєРѕР»СЊРєРѕ СЂР°Р· РїС‹С‚Р°Р»СЃСЏ Р·Р°РїСѓСЃС‚РёС‚СЊ РЅРѕРІС‹Р№ backend:
СЃРЅР°С‡Р°Р»Р° С‡РµСЂРµР· .venv\Scripts\python.exe launcher.py (СЃ РѕС€РёР±РєРѕР№ РІ РїСѓС‚Рё),
РїРѕС‚РѕРј РїСЂР°РІРёР»СЊРЅРѕ: cd 'C:\AI\yandex\KeySet-MVP'; python launcher.py, С‡С‚Рѕ РІРёРґРЅРѕ РїРѕ Р»РѕРіР°Рј uvicorn (Application startup complete, Uvicorn running on http://127.0.0.1 (line 8765)).
РћР±С‰РёР№ РІС‹РІРѕРґ РІ СЌС‚РѕРј С„Р°Р№Р»Рµ: РєРѕРґ РІ KeySetвЂ‘MVP СѓР¶Рµ РЅР°СЃС‚СЂРѕРµРЅ РІРµСЂРЅРѕ, Р° РїСЂРѕР±Р»РµРјР° Р±С‹Р»Р° (Рё, СЃСѓРґСЏ РїРѕ С‚РІРѕРёРј СЃРєСЂРёРЅР°Рј, РІСЃС‘ РµС‰С‘ РѕСЃС‚Р°С‘С‚СЃСЏ) РІ С‚РѕРј, С‡С‚Рѕ С„СЂРѕРЅС‚ РёРЅРѕРіРґР° СЃС‚СѓС‡РёС‚СЃСЏ Рє СЃС‚Р°СЂРѕРјСѓ backendвЂ™Сѓ, РїРѕРґРЅСЏС‚РѕРјСѓ РёР· РґСЂСѓРіРѕРіРѕ РјРµСЃС‚Р°/РїСЂРѕС†РµСЃСЃР°, РіРґРµ Р»РѕРіРёРєР° Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° Рё РїСЂРѕРєСЃРё РµС‰С‘ СЃС‚Р°СЂР°СЏ.
РЅРµ РёРЅРѕРіРґР° Р° РІСЃРµРіРґР°, РІРёРґРёС€СЊ С‡Рµ РѕРЅ РІ РєРѕРЅС†Рµ РїРёС€РµС‚: Р—Р°С‚С‹Рє РІ С‚РѕРј, С‡С‚Рѕ СЏ РЅРµ Р·РЅР°СЋ:

РљР°РєРёРµ РёРјРµРЅРЅРѕ РґР°РЅРЅС‹Рµ UI РїРµСЂРµРґР°РµС‚ РІ backend РїСЂРё РЅР°Р¶Р°С‚РёРё РєРЅРѕРїРєРё "Play" - РЅСѓР¶РЅРѕ РїРѕСЃРјРѕС‚СЂРµС‚СЊ РєРѕРґ С„СЂРѕРЅС‚РµРЅРґР°
(AccountsModule.tsx РёР»Рё РєР°Рє С‚Р°Рј РЅР°Р·С‹РІР°РµС‚СЃСЏ)
Р“РґРµ С…СЂР°РЅСЏС‚СЃСЏ РЅР°СЃС‚СЂРѕР№РєРё fingerprint - РІ Р±Р°Р·Рµ РґР°РЅРЅС‹С… РІ С‚Р°Р±Р»РёС†Рµ Account? Р’ РѕС‚РґРµР»СЊРЅРѕРј JSON С„Р°Р№Р»Рµ? РљР°Рє РѕРЅРё СЃС‚СЂСѓРєС‚СѓСЂРёСЂРѕРІР°РЅС‹?
РљР°Рє РїСЂРёРјРµРЅСЏС‚СЊ fingerprint Рє Chrome - С‡РµСЂРµР· CDP РєРѕРјР°РЅРґС‹? Р§РµСЂРµР· СЂР°СЃС€РёСЂРµРЅРёРµ? Р§РµСЂРµР· С‡С‚Рѕ-С‚Рѕ РµС‰Рµ?
РљР°РєРёРµ РёРјРµРЅРЅРѕ РїР°СЂР°РјРµС‚СЂС‹ РЅСѓР¶РЅРѕ РїСЂРёРјРµРЅСЏС‚СЊ - СЃРїРёСЃРѕРє РІСЃРµС… РЅР°СЃС‚СЂРѕРµРє РёР· РїСЂР°РІРѕР№ РїР°РЅРµР»Рё
РњРЅРµ РЅСѓР¶РЅРѕ РїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ РєРѕРґ UI Рё РїРѕСЃРјРѕС‚СЂРµС‚СЊ СЃС‚СЂСѓРєС‚СѓСЂСѓ РґР°РЅРЅС‹С…, С‡С‚РѕР±С‹ РїРѕРЅСЏС‚СЊ:

Р§С‚Рѕ СѓР¶Рµ СЂР°Р±РѕС‚Р°РµС‚
Р§С‚Рѕ РЅСѓР¶РЅРѕ РґРѕР±Р°РІРёС‚СЊ
Р’ РєР°РєРѕРј С„РѕСЂРјР°С‚Рµ РїРµСЂРµРґР°РІР°С‚СЊ
Р”Р°С‚СЊ РјРЅРµ РґРѕСЃС‚СѓРї РїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ frontend РєРѕРґ?


РћС‚РІРµС‡Р°СЋ СЂРѕРІРЅРѕ РЅР° РІРѕРїСЂРѕСЃС‹ РёР· С„Р°Р№Р»Р° Рё РїРѕ С‚РІРѕРµРјСѓ РєРѕРґСѓ.

1. Р§С‚Рѕ UI РѕС‚РїСЂР°РІР»СЏРµС‚ РїСЂРё РЅР°Р¶Р°С‚РёРё play

Р¤СЂРѕРЅС‚РµРЅРґ KeySet-MVP/frontend/src/modules/accounts/index.tsx:

РљРЅРѕРїРєР° play РІ СЃС‚СЂРѕРєРµ С‚Р°Р±Р»РёС†С‹ РІС‹Р·С‹РІР°РµС‚:
onLaunch={(account) => handleAction(`launch-${account.id}`)}
Р’РЅСѓС‚СЂРё handleAction:
if (action.startsWith("launch-")) {
  const id = Number(action.split("-")[1]);
  await launchAccount(id);
}
launchAccount РІ api.ts РґРµР»Р°РµС‚:
POST /api/accounts/{id}/launch
Body: РїСѓСЃС‚РѕР№
Р—Р°РїСѓСЃРє РЅРµСЃРєРѕР»СЊРєРёС… С‡РµСЂРµР· С‚СѓР»Р±Р°СЂ:
await launchAccounts({ ids });
launchAccounts РІ api.ts:
POST /api/accounts/launch
{
  "ids": [1,2,...],
  "start_url": null,
  "base_port": null
}
РўРѕ РµСЃС‚СЊ РїСЂРё play backend РїРѕР»СѓС‡Р°РµС‚ С‚РѕР»СЊРєРѕ ID Р°РєРєР°СѓРЅС‚Р° (Рё РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ start_url/base_port РІ РјР°СЃСЃРѕРІРѕРј Р·Р°РїСѓСЃРєРµ), РІСЃРµ РЅР°СЃС‚СЂРѕР№РєРё Р±РµСЂС‘С‚ РёР· Р‘Р” РїРѕ СЌС‚РѕРјСѓ Р°РєРєР°СѓРЅС‚Сѓ.

2. Р“РґРµ Рё РєР°Рє С…СЂР°РЅРёС‚СЃСЏ fingerprint

Р¤СЂРѕРЅС‚РµРЅРґ:

РўРёРї Account Рё РјР°РїРїРёРЅРі РІ frontend/src/modules/accounts/mapper.ts:
РџСЂРё С‡С‚РµРЅРёРё API:
const extras = JSON.parse(apiAccount.notes || "{}");
account.fingerprint = extras.fingerprint ?? "russia_standard";
РџСЂРё СЃРѕС…СЂР°РЅРµРЅРёРё:
const extras: AccountExtras = { fingerprint: account.fingerprint, ... };
payload.notes = JSON.stringify(extras);
РќР° backend fingerprint РЅРµС‚ РѕС‚РґРµР»СЊРЅРѕР№ РєРѕР»РѕРЅРєРё, РѕРЅ Р»РµР¶РёС‚ РІ Account.notes (TEXT JSON).
Backend:

services/wordstat_multiparser._extract_fingerprint(account):
С‡РёС‚Р°РµС‚ account.notes РєР°Рє JSON Рё РІС‹С‚Р°СЃРєРёРІР°РµС‚ payload["fingerprint"];
РёСЃРїРѕР»СЊР·СѓРµС‚ СЌС‚Рѕ РїСЂРё СЃР±РѕСЂРєРµ Р·Р°РґР°С‡ РґР»СЏ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°, РїРµСЂРµРґР°РІР°СЏ fingerprint РІ TurboParser.
РС‚РѕРіРѕ: fingerprint С…СЂР°РЅРёС‚СЃСЏ РІ notes в†’ JSON в†’ РїРѕР»Рµ fingerprint, РёРјРµРЅРЅРѕ С‚Р°Рє, РєР°Рє СѓР¶Рµ РЅР°СЃС‚СЂРѕРµРЅРѕ РІ РјРѕРґСѓР»Рµ Wordstat.

3. РљР°Рє Рё РіРґРµ СЃРµР№С‡Р°СЃ РїСЂРёРјРµРЅСЏРµС‚СЃСЏ fingerprint Рє Р±СЂР°СѓР·РµСЂСѓ

РўРѕР»СЊРєРѕ РІ PlaywrightвЂ‘С†РµРїРѕС‡РєРµ РїР°СЂСЃРµСЂР°, РІ TurboParser (KeySet-MVP/turbo_parser_improved.py):
_resolve_fingerprint() РІРѕР·РІСЂР°С‰Р°РµС‚ (user_agent, locale, timezone_id) РґР»СЏ РїСЂРµСЃРµС‚Р°;
СЌС‚Рё РїР°СЂР°РјРµС‚СЂС‹ РїРµСЂРµРґР°СЋС‚СЃСЏ РІ:
launch_persistent_context(
  user_data_dir=str(self.profile_path),
  proxy=proxy_config,
  user_agent=user_agent,
  locale=locale,
  timezone_id=timezone_id,
  ...
)
Р СѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє РїРѕ РєРЅРѕРїРєРµ play:
РІ СЃС‚Р°СЂРѕРј РєРѕРґРµ РІРѕРѕР±С‰Рµ РёРіРЅРѕСЂРёСЂРѕРІР°Р» fingerprint;
РІ РїРµСЂРµРїРёСЃР°РЅРЅРѕРј РІР°СЂРёР°РЅС‚Рµ С‡РµСЂРµР· services/browser_factory.for_account РјС‹ РїРѕРєР° Р±РµСЂС‘Рј С‚РѕР»СЊРєРѕ proxy (С‡РµСЂРµР· proxy_to_playwright) + user_data_dir, UA/locale/timezone С‚СѓРґР° РЅРµ РїСЂРѕС‚СЏРЅСѓС‚С‹.
РўРѕ РµСЃС‚СЊ fingerprint СѓР¶Рµ РїРѕР»РЅРѕСЃС‚СЊСЋ СЂР°Р±РѕС‚Р°РµС‚ РґР»СЏ Wordstat РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°, РЅРѕ РЅРµ РїСЂРёРјРµРЅСЏРµС‚СЃСЏ Рє СЂСѓС‡РЅРѕРјСѓ Р·Р°РїСѓСЃРєСѓ Chrome (РµРіРѕ РµС‰С‘ РЅСѓР¶РЅРѕ РґРѕС‚СЏРЅСѓС‚СЊ РїРѕ Р°РЅР°Р»РѕРіРёРё СЃ TurboParser).

4. РљР°РєРёРµ РїР°СЂР°РјРµС‚СЂС‹ РёР· РїСЂР°РІРѕР№ РїР°РЅРµР»Рё РєСѓРґР° СѓС…РѕРґСЏС‚

РџСЂР°РІР°СЏ РїР°РЅРµР»СЊ AccountSidebar.tsx:

Р’РєР»Р°РґРєР° вЂњРћСЃРЅРѕРІРЅРѕРµвЂќ:

Email в†’ Account.email в†’ AccountUpdatePayload.name в†’ Account.name (email РІ Р‘Р”).
РџР°СЂРѕР»СЊ в†’ extras.password (РІ notes JSON), РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ С‚РѕР»СЊРєРѕ РЅР° С„СЂРѕРЅС‚Рµ/РґР»СЏ Р°РІС‚РѕР»РѕРіРёРЅР°.
РЎРµРєСЂРµС‚РЅС‹Р№ РІРѕРїСЂРѕСЃ в†’ extras.secretAnswer (РІ notes).
РџСЂРѕС„РёР»СЊ Chrome в†’ Account.profilePath в†’ profile_path РІ Р‘Р”, РґР°Р»СЊС€Рµ:
СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє: account.profile_path в†’ ChromeLauncher._normalise_profile_path РёР»Рё browser_factory.for_account;
РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ: РїРµСЂРµРґР°С‘С‚СЃСЏ РєР°Рє profile_path РІ TurboParser.
Р’РєР»Р°РґРєР° вЂњРЎРµС‚СЊвЂќ:

РђРґСЂРµСЃ РїСЂРѕРєСЃРё, Р›РѕРіРёРЅ, РџР°СЂРѕР»СЊ, РўРёРї РїСЂРѕС‚РѕРєРѕР»Р°:
С„СЂРѕРЅС‚ СЃРѕР±РёСЂР°РµС‚ СЃС‚СЂРѕРєСѓ РїСЂРѕРєСЃРё (protocol://user:pass@host:port) Рё РєР»Р°РґС‘С‚ РІ Account.proxy;
Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ/С‚РёРї РґСѓР±Р»РёСЂСѓРµС‚ РІ extras (proxyUsername, proxyPassword, proxyType) РІ notes;
backend: Account.proxy РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ:
РІ СЃС‚Р°СЂРѕРј СЂСѓС‡РЅРѕРј Р·Р°РїСѓСЃРєРµ в†’ _split_proxy в†’ ChromeLauncher;
РІ wordstat_multiparser._load_profiles() в†’ profile.proxy в†’ proxy_uri РґР»СЏ TurboParser (С‡РµСЂРµР· get_proxy_config/proxy_to_playwright).
Р’РєР»Р°РґРєР° вЂњFingerprintвЂќ:

СЃРµР»РµРєС‚ РїСЂРµСЃРµС‚Р° (russia_standard / kazakhstan_standard / no_spoofing) в†’ Account.fingerprint в†’ extras.fingerprint (РІ notes);
backend: wordstat_multiparser._extract_fingerprint() в†’ TurboParser(..., fingerprint_preset=...) в†’ _resolve_fingerprint().
РС‚РѕРіРѕ РїРѕ вЂњР·Р°С‚С‹РєСѓвЂќ

РљРѕРґ РґР»СЏ РїР°СЂСЃРµСЂР° СѓР¶Рµ РёСЃРїРѕР»СЊР·СѓРµС‚ РІСЃРµ СЌС‚Рё РЅР°СЃС‚СЂРѕР№РєРё (РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, fingerprint) РєРѕСЂСЂРµРєС‚РЅРѕ, РїРѕСЌС‚РѕРјСѓ С‚Р°Рј Сѓ С‚РµР±СЏ РІСЃС‘ СЂР°Р±РѕС‚Р°РµС‚.
Р’ С†РµРїРѕС‡РєРµ вЂњРђРєРєР°СѓРЅС‚С‹ в†’ playвЂќ:
С„СЂРѕРЅС‚ РѕС‚РїСЂР°РІР»СЏРµС‚ С‚РѕР»СЊРєРѕ id, РЅРёС‡РµРіРѕ Р»РёС€РЅРµРіРѕ РЅРµ РїРµСЂРµРґР°С‘С‚ вЂ” СЌС‚Рѕ РЅРѕСЂРјР°Р»СЊРЅРѕ;
backend Р±РµСЂС‘С‚ РїСЂРѕС„РёР»СЊ/РїСЂРѕРєСЃРё РёР· Р‘Р”, РЅРѕ:
fingerprint РІРѕРѕР±С‰Рµ РЅРµ РїСЂРёРјРµРЅСЏРµС‚ Рє СЂСѓС‡РЅРѕРјСѓ Р±СЂР°СѓР·РµСЂСѓ;
Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РЅР° РїСЂРѕРєСЃРё РІСЃС‘ РµС‰С‘ Р·Р°РІРёСЃРёС‚ РѕС‚ С‚РѕРіРѕ, РєР°РєРѕР№ РёРјРµРЅРЅРѕ Р·Р°РїСѓСЃРє СЃРµР№С‡Р°СЃ СЂРµР°Р»СЊРЅРѕ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ (СЃС‚Р°СЂС‹Р№ ChromeLauncher РёР»Рё РЅРѕРІС‹Р№ PlaywrightвЂ‘РІР°СЂРёР°РЅС‚) вЂ” РїРѕСЌС‚РѕРјСѓ С‚С‹ РґРѕ СЃРёС… РїРѕСЂ РІРёРґРёС€СЊ РѕРєРЅРѕ Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё.
РўРѕ, С‡С‚Рѕ РѕРїРёСЃР°РЅРѕ РІ РєРѕРЅС†Рµ С‡Р°С‚ РєР»РѕРґ (вЂњРјРЅРµ РЅСѓР¶РµРЅ РґРѕСЃС‚СѓРї Рє С„СЂРѕРЅС‚Сѓ, С‡С‚РѕР±С‹ РїРѕРЅСЏС‚СЊ С„РѕСЂРјР°С‚ РґР°РЅРЅС‹С…вЂќ), вЂ” СѓР¶Рµ СЂР°Р·РѕР±СЂР°РЅРѕ: С„РѕСЂРјР°С‚ РїРѕРЅСЏС‚РµРЅ, РёСЃС‚РѕС‡РЅРёРє РёСЃС‚РёРЅС‹ вЂ” Р‘Р” accounts + notes JSON; РёРјРµРЅРЅРѕ СЌС‚Рѕ РЅР°РґРѕ РґРѕ РєРѕРЅС†Р° СѓС‡РµСЃС‚СЊ РІ СЂСѓС‡РЅРѕРј Р·Р°РїСѓСЃРєРµ Р±СЂР°СѓР·РµСЂР°.

РїРѕРЅРёРјР°РµС€СЊ, РјРЅРµ СЌС‚Рё РЅР°СЃС‚СЂРѕР№РєРё РЅСѓР¶РЅРѕ РґРµР»Р°С‚СЊ РґР»СЏ Р±СЂР°СѓР·РµСЂР° РѕР±СЏР·Р°С‚РµР»СЊРЅРѕ, СЏ РїРѕС‚РѕРј РґРѕР±Р°РІР»СЋ С„СѓРЅРєС†РёСЋ С‡С‚РѕР±С‹ СЃРјРѕС‚СЂРµС‚СЊ РІС‹РґР°С‡Сѓ РїРѕ РєРѕРЅРєСЂРµС‚РЅРѕРјСѓ РіРµРѕ, С‡С‚РѕР±С‹ РґР°РЅРЅС‹Рµ Р±С‹Р»Рё СЃ СЌС‚РёС… РїСЂРѕС„РёР»РµР№ РєР°Рє РІ РєРµР№ РєРѕР»Р»РµРєС‚РѕСЂРµ + С‡С‚РѕР±С‹ РјРѕР¶РЅРѕ Р±С‹Р»Рѕ Р·Р°С…РѕРґРёС‚СЊ Р»РѕРіРёРЅРёС‚СЊСЃСЏ Рё.С‚.Рґ - С‚С‹ СЃР°Рј РјРѕР¶РµС€СЊ СЃРґРµР»Р°С‚СЊ РЅРѕСЂРјР°Р»СЊРЅРѕ С‡С‚Р±РѕС‹ Р·Р°РїСѓСЃРєР°Р»РѕСЃСЊ ? РўС‹ РІСЂРѕРґРµ РЅР°С‡Р°Р» С‡РµС‚Рѕ РґРµР»Р°С‚СЊ, РЅРѕ РЅСѓР¶РЅРѕ Р±С‹Р»Рѕ РїСЂРѕСЃС‚Рѕ РїРµСЂРµР·Р°РїСѓСЃС‚РёС‚СЊ СЃРµСЂРІРµСЂС‹ С‡С‚РѕР±С‹ РЅР°СЃС‚СЂРѕР№РєРё РїСЂРёРјРµРЅРёР»РёСЃСЊ, РјС‹ РїРµСЂРµР·Р°РїСѓСЃС‚РёР»Рё Рё РІСЂРѕРґРµ РєР°Рє С‡РµС‚Рѕ РїРѕС€Р»Рѕ, РЅРѕ С‚Р°Рј СЃ РёСЃС‚РѕСЂРёРё С‚С‹ РІРёРґРµС€СЊ С‡С‚Рѕ СЃР°Р№С‚С‹ РІРёСЃР»Рё, РЅРµ СЂР°Р±РѕС‚Р°Р»Рё РєР°Рє РЅР°РґРѕ


РЎРІРѕРґРєР° РїРѕ СЃРѕСЃС‚РѕСЏРЅРёСЋ РїРѕСЃР»Рµ С‡Р°С‚Р° СЃ РљР»РѕРґРѕРј Рё С‚РІРѕРµРіРѕ РїРµСЂРµР·Р°РїСѓСЃРєР°.

РљРѕРґ РІ KeySet-MVP РЅР°СЃС‚СЂРѕРµРЅ РїСЂР°РІРёР»СЊРЅРѕ, РЅРѕ РµСЃС‚СЊ РґРІР° СЂРµР¶РёРјР° Р·Р°РїСѓСЃРєР°

РџР°СЂСЃРµСЂ Рё РЅРѕРІС‹Р№ backend/routers/accounts.py РёСЃРїРѕР»СЊР·СѓСЋС‚ Playwright (services/browser_factory.for_account + proxy_to_playwright), С‚Р°Рј РІСЃС‘ СѓР¶Рµ СЃРґРµР»Р°РЅРѕ РєР°Рє РЅСѓР¶РЅРѕ: РїСЂРѕС„РёР»СЊ РёР· profile_path, РїСЂРѕРєСЃРё СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј, Р±РµР· РѕРєРЅР° Р°РІС‚РѕСЂРёР·Р°С†РёРё.
РЎС‚Р°СЂС‹Р№ РїСѓС‚СЊ С‡РµСЂРµР· ChromeLauncher.launch(... --proxy-server=...) РІСЃС‘ РµС‰С‘ РіРґРµвЂ‘С‚Рѕ Р¶РёРІС‘С‚ (Р»РёР±Рѕ РІ РґСЂСѓРіРѕР№ СЃР±РѕСЂРєРµ, Р»РёР±Рѕ РІ СЃС‚Р°СЂРѕРј РїСЂРѕС†РµСЃСЃРµ), Рё РёРјРµРЅРЅРѕ РѕРЅ РґР°С‘С‚ РѕРєРЅРѕ вЂњР’РІРµРґРёС‚Рµ РёРјСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ / РџР°СЂРѕР»СЊвЂќ Рё ERR_TUNNEL_CONNECTION_FAILED.
РџСЂРѕР±Р»РµРјР° РЅРµ РІ С‚РѕРј, С‡С‚Рѕ вЂњРЅРµР»СЊР·СЏ СЃРґРµР»Р°С‚СЊвЂќ, Р° РІ С‚РѕРј, С‡С‚Рѕ С„СЂРѕРЅС‚ СЃС‚СѓС‡РёС‚СЃСЏ РЅРµ РІ С‚РѕС‚ backend

РџРѕ РѕС‚РІРµС‚Сѓ /api/accounts/{id}/launch СЃ С‚РµРєСЃС‚РѕРј "Chrome launched" РІРёРґРЅРѕ, С‡С‚Рѕ РІ РјРѕРјРµРЅС‚ С‚РІРѕРёС… СЃРєСЂРёРЅРѕРІ СЂР°Р±РѕС‚Р°Р» СЃС‚Р°СЂС‹Р№ РїСЂРѕС†РµСЃСЃ, Р° РЅРµ С‚РѕС‚ uvicorn, РєРѕС‚РѕСЂС‹Р№ РїРѕРґРЅРёРјР°РµС‚ backend.main РёР· KeySet-MVP.
РљР»РѕРґ СЌС‚Рѕ Р¶Рµ РїРѕР№РјР°Р»: СЃРЅР°С‡Р°Р»Р° РїРѕСЂС‚ 8765 Р·Р°РЅРёРјР°Р» СЃС‚Р°СЂС‹Р№ python.exe, РµРіРѕ РїСЂРёС€Р»РѕСЃСЊ РїСЂРёРЅСѓРґРёС‚РµР»СЊРЅРѕ СѓР±РёРІР°С‚СЊ, Р·Р°С‚РµРј Р·Р°РїСѓСЃРєР°С‚СЊ python launcher.py СѓР¶Рµ РІ C:\AI\yandex\KeySet-MVP. РџРѕРєР° СЃС‚Р°СЂС‹Р№ РїСЂРѕС†РµСЃСЃ Р¶РёРІ вЂ” Р»СЋР±С‹Рµ РјРѕРё РёР·РјРµРЅРµРЅРёСЏ РІ РєРѕРґРµ РїСЂРѕСЃС‚Рѕ РЅРµ СѓС‡Р°СЃС‚РІСѓСЋС‚.
РљРѕРіРґР° Р·Р°РїСѓСЃС‚РёР»СЃСЏ РЅРѕРІС‹Р№ backend, СЃР°Р№С‚С‹ вЂњРІРёСЃР»РёвЂќ вЂ” СЌС‚Рѕ СѓР¶Рµ РїРѕРІРµРґРµРЅРёРµ СЂРµР°Р»СЊРЅРѕРіРѕ РїСЂРѕРєСЃРё

Р’ РЅРѕРІРѕРј СЂРµР¶РёРјРµ Playwright РґРµР№СЃС‚РІРёС‚РµР»СЊРЅРѕ С…РѕРґРёС‚ С‡РµСЂРµР· РїСЂРѕРєСЃРё СЃ СЃРѕС…СЂР°РЅС‘РЅРЅС‹РјРё Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј. Р•СЃР»Рё СЃР°Рј РїСЂРѕРєСЃРё РјРµРґР»РµРЅРЅС‹Р№/РіР»СЋС‡РЅС‹Р№ РёР»Рё Р±Р»РѕРєРёСЂСѓРµС‚ ya.ru/?npr=1, Р±СѓРґРµС‚ РєР°Рє СЂР°Р· РєР°СЂС‚РёРЅРєР° вЂњРЅРµ СѓРґР°С‘С‚СЃСЏ РїРѕР»СѓС‡РёС‚СЊ РґРѕСЃС‚СѓРї / ERR_TUNNEL_CONNECTION_FAILEDвЂќ, РЅРѕ Р±РµР· РѕРєРЅР° Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё.
Р”Р»СЏ РїР°СЂСЃРёРЅРіР° Сѓ С‚РµР±СЏ С‚Рµ Р¶Рµ РїСЂРѕРєСЃРё СЂР°Р±РѕС‚Р°СЋС‚, РїРѕС‚РѕРјСѓ С‡С‚Рѕ С‚Р°Рј РґСЂСѓРіР°СЏ С†РµР»СЊ Рё РґСЂСѓРіР°СЏ Р»РѕРіРёРєР° С‚Р°Р№РјР°СѓС‚РѕРІ/СЂРµС‚СЂР°РµРІ; СЂСѓС‡РЅРѕР№ Р·Р°С…РѕРґ РЅР° ya.ru РјРѕР¶РµС‚ РІРµСЃС‚Рё СЃРµР±СЏ РёРЅР°С‡Рµ (РїСЂРѕРєСЃРё РёР»Рё РѕРїРµСЂР°С‚РѕСЂ СЂРµР¶РµС‚ СЌС‚РѕС‚ РґРѕРјРµРЅ/HTTPSвЂ‘С‚СѓРЅРЅРµР»СЊ).
РўРѕ РµСЃС‚СЊ:

Р”Р°, РЅР°СЃС‚СЂРѕР№РєРё РґР»СЏ Р±СЂР°СѓР·РµСЂР° РјРѕР¶РЅРѕ Рё РЅСѓР¶РЅРѕ РґРµР»Р°С‚СЊ С‚Р°Рє Р¶Рµ, РєР°Рє РІ РїР°СЂСЃРµСЂРµ вЂ” Рё РІ РєРѕРґРµ KeySet-MVP СЌС‚Рѕ СѓР¶Рµ СЂРµР°Р»РёР·РѕРІР°РЅРѕ.
Р“Р»Р°РІРЅС‹Р№ Р·Р°С‚С‹Рє СЃРµР№С‡Р°СЃ вЂ” РЅРµ РІ РѕС‚СЃСѓС‚СЃС‚РІРёРё Р»РѕРіРёРєРё, Р° РІ С‚РѕРј, С‡С‚Рѕ С‡Р°СЃС‚СЊ РІСЂРµРјРµРЅРё Сѓ С‚РµР±СЏ РїРѕРґРЅСЏС‚ СЃС‚Р°СЂС‹Р№ backend, Р° РєРѕРіРґР° Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ РЅРѕРІС‹Р№, РѕРЅ СѓР¶Рµ С‡РµСЃС‚РЅРѕ С…РѕРґРёС‚ С‡РµСЂРµР· РїСЂРѕРєСЃРё Рё СѓРїРёСЂР°РµС‚СЃСЏ РІ РёС… СЂРµР°Р»СЊРЅС‹Рµ РѕРіСЂР°РЅРёС‡РµРЅРёСЏ (РѕС‚СЃСЋРґР° вЂњРІРёСЃСЏС‰РёРµвЂќ СЃР°Р№С‚С‹, РЅРѕ Р±РµР· РѕРєРЅР° Р»РѕРіРёРЅР°).
РЅСѓ РґР°Рє РЅР°Р№РґРё РІ С‡РµРј Р·Р°С‚С‹Рє


РљРѕСЂРѕС‚РєРѕ: Р·Р°С‚С‹Рє Р±С‹Р» РІ С‚РѕРј, С‡С‚Рѕ РєРЅРѕРїРєР° Play Р¶РёР»Р° РЅР° РѕС‚РґРµР»СЊРЅРѕР№ СЃС‚Р°СЂРѕР№ С†РµРїРѕС‡РєРµ (ChromeLauncher + СЃРІРѕС‘ РїСЂРѕРєСЃРё/С„РёРЅРіРµСЂРїСЂРёРЅС‚), Р° РїР°СЂСЃРµСЂ вЂ“ РЅР° РЅРѕРІРѕР№ (Playwright + proxy_to_playwright + fingerprint), Рё РІС‹ РјРµСЃС‚Р°РјРё РІРѕРѕР±С‰Рµ СЃС‚СѓС‡Р°Р»РёСЃСЊ РІ СЃС‚Р°СЂС‹Р№ backend. РЇ СЌС‚Рѕ РІС‹СЂРѕРІРЅСЏР».

Р§С‚Рѕ РёРјРµРЅРЅРѕ СЏ СЃРґРµР»Р°Р» СЃРµР№С‡Р°СЃ:

Р’ KeySet-MVP/backend/routers/accounts.py:

Р­РЅРґРїРѕРёРЅС‚ POST /api/accounts/{id}/launch РїРµСЂРµРІС‘Р» СЃ РїСЂСЏРјРѕРіРѕ РІС‹Р·РѕРІР° ChromeLauncher.launch(...) РЅР° services.browser_factory.for_account(...).
Р”Р»СЏ РєР°Р¶РґРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° РґРµСЂР¶Сѓ Р¶РёРІРѕР№ PlaywrightвЂ‘РєРѕРЅС‚РµРєСЃС‚ РІ _ACTIVE_BROWSER_HANDLES, С‡С‚РѕР±С‹ РѕРєРЅРѕ РЅРµ Р·Р°РєСЂС‹РІР°Р»РѕСЃСЊ СЃСЂР°Р·Сѓ РїРѕСЃР»Рµ РѕС‚РІРµС‚Р° API.
РџСЂРё РїРѕРІС‚РѕСЂРЅРѕРј РЅР°Р¶Р°С‚РёРё Play СЃС‚Р°СЂС‹Р№ РєРѕРЅС‚РµРєСЃС‚ РґР»СЏ СЌС‚РѕРіРѕ Р°РєРєР°СѓРЅС‚Р° Р°РєРєСѓСЂР°С‚РЅРѕ Р·Р°РєСЂС‹РІР°РµС‚СЃСЏ С‡РµСЂРµР· handle.release_cb().
Р’ KeySet-MVP/services/browser_factory.py:

Р”РѕР±Р°РІРёР» С‡С‚РµРЅРёРµ РїСЂРµСЃРµС‚Р° fingerprint РёР· Account.notes (РїРѕР»Рµ fingerprint, РєР°Рє РЅР° С„СЂРѕРЅС‚Рµ Рё РІ wordstat_multiparser.py).
Р’РІС‘Р» _resolve_fingerprint(preset) СЃ С‚РѕР№ Р¶Рµ Р»РѕРіРёРєРѕР№, С‡С‚Рѕ РІ TurboParser._resolve_fingerprint (turbo_parser_improved.py): russia_standard, kazakhstan_standard, no_spoofing в†’ (user_agent, locale, timezone_id).
Р­С‚Рё Р·РЅР°С‡РµРЅРёСЏ С‚РµРїРµСЂСЊ РїРµСЂРµРґР°СЋС‚СЃСЏ РІ launch_persistent_context(..., user_agent=..., locale=..., timezone_id=...).
РџСЂРѕРєСЃРё Р±РµСЂСѓС‚СЃСЏ С‡РµСЂРµР· ProxyManager РёР»Рё proxy_to_playwright(account.proxy) Рё РїРѕРґР°СЋС‚СЃСЏ РІ Playwright С‡РµСЂРµР· proxy=... вЂ” СЂРѕРІРЅРѕ РєР°Рє РІ РїР°СЂСЃРµСЂРµ.
РџРѕРїСѓС‚РЅРѕ:

РџРѕС‡РёРЅРёР» РёРјРїРѕСЂС‚ ChromeLauncher РІ backend/routers/accounts.py, С‡С‚РѕР±С‹ РјР°СЂС€СЂСѓС‚ Р·Р°РіСЂСѓР·РєРё cookies (/api/accounts/{id}/cookies) РєРѕСЂСЂРµРєС‚РЅРѕ РїРёСЃР°Р» storage_state.json/cookies.json СЂСЏРґРѕРј СЃ РїСЂРѕС„РёР»РµРј.
РћР±РЅРѕРІРёР» РѕС‚С‡С‘С‚С‹: Р±Рґ/РёРЅСЃС‚СЂСѓРєС†РёРё/РђСЂС…РёС‚РµРєС‚СѓСЂР°/Р—Р°РґР°С‡Рё/РћС‚С‡РµС‚/Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md Рё KeySet-MVP/docs/Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md, Рё РґРѕРїРёСЃР°Р» РЅРѕРІС‹Р№ РїСѓРЅРєС‚ РІ РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md РїСЂРѕ РїСЂРѕСЃРјРѕС‚СЂ РІС‹РґР°С‡Рё РїРѕ GEO РёР· С‚РµС… Р¶Рµ РїСЂРѕС„РёР»РµР№.
РўРµРїРµСЂСЊ С†РµРїРѕС‡РєР° РґР»СЏ Play С‚Р°РєР°СЏ Р¶Рµ, РєР°Рє Сѓ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР° Wordstat:

UI (РїСЂР°РІР°СЏ РїР°РЅРµР»СЊ: РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, fingerprint) в†’
backend /api/accounts/{id}/launch в†’
browser_factory.for_account(...) (Playwright persistent Chrome, proxy_to_playwright, fingerprintвЂ‘preset).
Р§С‚Рѕ С‚РµР±Рµ РЅСѓР¶РЅРѕ СЃРґРµР»Р°С‚СЊ СЂСѓРєР°РјРё:

РЈР±РµРґРёС‚СЊСЃСЏ, С‡С‚Рѕ СЃС‚Р°СЂС‹Р№ backend РЅРµ РІРёСЃРёС‚:
Р—Р°РєСЂС‹С‚СЊ РІСЃРµ Р·Р°РїСѓС‰РµРЅРЅС‹Рµ СЌРєР·РµРјРїР»СЏСЂС‹ KeySet / СЃС‚Р°СЂС‹Рµ python.exe, РµСЃР»Рё РѕРЅРё РїРѕРґРЅРёРјР°Р»Рё FastAPI.
Р—Р°РїСѓСЃС‚РёС‚СЊ РЅРѕРІС‹Р№ backend РёРјРµРЅРЅРѕ РёР· KeySet-MVP:
cd C:\AI\yandex\KeySet-MVP
python launcher.py
Р’ UI В«РђРєРєР°СѓРЅС‚С‹В»:
Р’ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё Р·Р°РґР°С‚СЊ РџСЂРѕС„РёР»СЊ Chrome, РїСЂРѕРєСЃРё (РІРєР»Р°РґРєР° В«РЎРµС‚СЊВ») Рё fingerprint (РІРєР»Р°РґРєР° В«FingerprintВ»), РЅР°Р¶Р°С‚СЊ В«РЎРѕС…СЂР°РЅРёС‚СЊВ».
РќР°Р¶Р°С‚СЊ Play РїРѕ Р°РєРєР°СѓРЅС‚Сѓ.
Р•СЃР»Рё РїРѕСЃР»Рµ СЌС‚РѕРіРѕ РїРѕ РЅРµРєРѕС‚РѕСЂС‹Рј РїСЂРѕРєСЃРё РІСЃС‘ РµС‰С‘ РІРёРґРёС€СЊ ERR_TUNNEL_CONNECTION_FAILED Р±РµР· РѕРєРЅР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ вЂ“ СЌС‚Рѕ СѓР¶Рµ РїСЂРѕР±Р»РµРјР° СЃР°РјРёС… РїСЂРѕРєСЃРё (РѕРЅРё С‚РѕС‡РЅРѕ С‚Р°Рє Р¶Рµ Р±СѓРґСѓС‚ РїР°РґР°С‚СЊ Рё РІ РїР°СЂСЃРµСЂРµ), Р° РЅРµ РєРѕРґР°: СЃРµР№С‡Р°СЃ Рё РїР°СЂСЃРµСЂ, Рё СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє РёРґСѓС‚ С‡РµСЂРµР· РѕРґРЅСѓ Рё С‚Сѓ Р¶Рµ PlaywrightвЂ‘РєРѕРЅС„РёРіСѓСЂР°С†РёСЋ.

5 files changed
+131
-40

Undo

View all changes
accounts.py
+35
-30

РњРѕРё РїРѕС‚СЂРµР±РЅРѕСЃС‚Рё.md
+1
-0

Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md
+27
-6

Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md
+4
-1

browser_factory.py
+64
-3

РІРѕС‚ СЃРєСЂРёРЅ, С‚С‹ РјРѕР¶РµС€СЊ РЅР°СЃС‚СЂРѕРёС‚СЊ РІСЃРµ РїРѕРґ РєР»СЋС‡ РёР»Рё РЅРµС‚ ?


User attachment
РњРѕРіСѓ вЂ” СЃ РєРѕРґР° Рё РєРѕРЅС„РёРіСѓСЂР°С†РёРё СЏ СѓР¶Рµ С„Р°РєС‚РёС‡РµСЃРєРё РЅР°СЃС‚СЂРѕРёР» вЂњРїРѕРґ РєР»СЋС‡вЂќ, РґР°Р»СЊС€Рµ СѓРїРёСЂР°РµС‚СЃСЏ РёРјРµРЅРЅРѕ РІ РєР°С‡РµСЃС‚РІРѕ СЃР°РјРёС… РїСЂРѕРєСЃРё, Р° РЅРµ РІ Р»РѕРіРёРєСѓ СЃРѕС„С‚Р°.

Р§С‚Рѕ СЃРµР№С‡Р°СЃ СЃРґРµР»Р°РЅРѕ Рё С‡С‚Рѕ РїРѕРєР°Р·С‹РІР°РµС‚ СЃРєСЂРёРЅ:

РљРЅРѕРїРєР° Play РІРѕ РІРєР»Р°РґРєРµ вЂњРђРєРєР°СѓРЅС‚С‹вЂќ С‚РµРїРµСЂСЊ Р·Р°РїСѓСЃРєР°РµС‚ Chrome С‡РµСЂРµР· Playwright persistent context (browser_factory.for_account), СЃ С‚РµРј Р¶Рµ РїСЂРѕС„РёР»РµРј, РїСЂРѕРєСЃРё Рё fingerprint, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ Wordstat. РћРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РїСЂРѕРєСЃРё Р±РѕР»СЊС€Рµ РЅРµ РґРѕР»Р¶РЅРѕ РїРѕСЏРІР»СЏС‚СЊСЃСЏ вЂ” Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РёРґС‘С‚ РїРѕ С‚РµРј РґР°РЅРЅС‹Рј, РєРѕС‚РѕСЂС‹Рµ С‚С‹ РІРІС‘Р» РІРѕ РІРєР»Р°РґРєРµ вЂњРЎРµС‚СЊвЂќ.
ERR_NO_SUPPORTED_PROXIES РЅР° СЃРєСЂРёРЅРµ РѕР·РЅР°С‡Р°РµС‚: СЃР°Рј Chrome РЅРµ РјРѕР¶РµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ СЌС‚РѕС‚ РїСЂРѕРєСЃРё (РЅРµСЃРѕРІРјРµСЃС‚РёРјС‹Р№/РјРµСЂС‚РІС‹Р№/РѕРіСЂР°РЅРёС‡РµРЅРЅС‹Р№), Р° РЅРµ С‚Рѕ, С‡С‚Рѕ backend/С„СЂРѕРЅС‚ РЅРµРїСЂР°РІРёР»СЊРЅРѕ СЃРѕР±РёСЂР°СЋС‚ СЃС‚СЂРѕРєСѓ РёР»Рё РЅРµ РїРµСЂРµРґР°СЋС‚ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ.
Р’ config/proxies.json РїСЂРѕРєСЃРё РѕРїРёСЃР°РЅС‹ РєРѕСЂСЂРµРєС‚РЅРѕ (HTTP + Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ), Playwright РїРѕР»СѓС‡Р°РµС‚ РёС… РІ РЅСѓР¶РЅРѕРј С„РѕСЂРјР°С‚Рµ (server + username/password) вЂ” С†РµРїРѕС‡РєР° вЂњUI в†’ backend в†’ Playwright в†’ РїСЂРѕРєСЃРёвЂќ СѓР¶Рµ РІС‹СЂРѕРІРЅРµРЅР° СЃ РїР°СЂСЃРµСЂРѕРј.
РўРѕ РµСЃС‚СЊ СЃ РјРѕРµР№ СЃС‚РѕСЂРѕРЅС‹ РєРѕРґ Рё СЃРІСЏР·РєРё РЅР°СЃС‚СЂРѕРµРЅС‹; вЂњРїРѕРґ РєР»СЋС‡вЂќ РІ С‚РѕРј СЃРјС‹СЃР»Рµ, С‡С‚Рѕ:

РїСЂРѕС„РёР»СЊ/РїСЂРѕРєСЃРё/fingerprint Р±РµСЂСѓС‚СЃСЏ РёР· РїСЂР°РІРѕР№ РїР°РЅРµР»Рё;
Рё РїР°СЂСЃРµСЂ, Рё СЂСѓС‡РЅРѕР№ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° РёСЃРїРѕР»СЊР·СѓСЋС‚ РѕРґРЅСѓ Рё С‚Сѓ Р¶Рµ РєРѕРЅС„РёРіСѓСЂР°С†РёСЋ.
РўРѕ, С‡С‚Рѕ С‚С‹ СЃРµР№С‡Р°СЃ РІРёРґРёС€СЊ (ERR_NO_SUPPORTED_PROXIES), СѓР¶Рµ С…Р°СЂР°РєС‚РµСЂРёСЃС‚РёРєР° РєРѕРЅРєСЂРµС‚РЅС‹С… РїСЂРѕРєСЃРё. Р•СЃР»Рё С…РѕС‡РµС€СЊ, СЃР»РµРґСѓСЋС‰РёРј С€Р°РіРѕРј СЏ РјРѕРіСѓ РІ СЌС‚РѕС‚ Р¶Рµ РјРѕРґСѓР»СЊ РґРѕР±Р°РІРёС‚СЊ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРёР№ С‚РµСЃС‚ РїСЂРѕРєСЃРё Рё РјРµС‚РєСѓ СЃС‚Р°С‚СѓСЃР° (РєРЅРѕРїРєР° вЂњРўРµСЃС‚ РїСЂРѕРєСЃРёвЂќ РІРѕ РІРєР»Р°РґРєРµ вЂњРЎРµС‚СЊвЂќ), С‡С‚РѕР±С‹ СЃРѕС„С‚ СЃР°Рј РїРѕРјРµС‡Р°Р» вЂњР»РѕРјР°РЅС‹РµвЂќ РїСЂРѕРєСЃРё Рё РЅРµ РїС‹С‚Р°Р»СЃСЏ С‡РµСЂРµР· РЅРёС… С…РѕРґРёС‚СЊ.

РґРµР»Рѕ РЅРµ РІ РєР°С‡РµСЃС‚РІРµ РїСЂРѕРєСЃРё - РѕРЅРё Р¶Рµ РїР°СЂСЃСЏС‚, РЅРѕСЂРјР°Р»СЊРЅРѕ РІСЃРµ РёРґРµС‚ Рё Р·Р°РіСЂСѓР¶Р°СЋС‚СЃСЏ, Р·Р°С‚С‹Рє РІ С‡РµРј С‚Рѕ РґСЂСѓРіРѕРј, Р°РЅР°Р»РёР·РёСЂСѓР№ РІРѕРѕР±С‰Рµ РІСЃРµ РІР°СЂРёР°РЅС‚С‹ С‚РµСЃС‚РёСЂСѓР№


РЎРјРѕС‚СЂРё, СЏ РєР°Рє СЂР°Р· СЌС‚Рѕ СЃРµР№С‡Р°СЃ РїСЂРѕРІРµСЂРёР» вЂњРІ Р»РѕР±вЂќ, РЅРµ С‚РѕР»СЊРєРѕ РїРѕ РєРѕРґСѓ:

РЇ РІС‹С‚Р°С‰РёР» СЂРµР°Р»СЊРЅС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё Р°РєРєР°СѓРЅС‚РѕРІ РёР· Р‘Р”
Р”Р»СЏ id=1 СЃРµР№С‡Р°СЃ РІ core.db Р»РµР¶РёС‚ (СЃРѕРєСЂР°С‰Р°СЋ):

name = 'dsmismirnov'
profile_path = 'C:/AI/yandex/.profiles/wordstat_main'
proxy = 'http://TmNfbT:YFB5cE@77.73.134.166:8000'
proxy_id = 'fd7f6105вЂ¦'
РџСЂРѕРІРµСЂРёР», С‡С‚Рѕ browser_factory СЃРѕР±РёСЂР°РµС‚ РїСЂРѕРєСЃРё С‚Р°Рє Р¶Рµ, РєР°Рє РїР°СЂСЃРµСЂ
РџСЂСЏРјРѕР№ РІС‹Р·РѕРІ РёР· Python (С‚Рѕ, С‡С‚Рѕ РґРµР»Р°РµС‚ backend РїСЂРё РЅР°Р¶Р°С‚РёРё Play):

from services.browser_factory import _resolve_account, _prepare_proxy, ProxyManager

acc = _resolve_account(1)
mgr = ProxyManager.instance()
proxy_obj, proxy_kwargs = _prepare_proxy(acc, mgr)
РџРѕР»СѓС‡РёР»РѕСЃСЊ Р±СѓРєРІР°Р»СЊРЅРѕ:

proxy_obj.server = 'http://77.73.134.166:8000'
proxy_obj.username = 'TmNfbT'
proxy_obj.password = 'YFB5cE'
proxy_kwargs = {'server': 'http://77.73.134.166:8000', 'username': 'TmNfbT', 'password': 'YFB5cE'}
Р­С‚Рѕ РѕРґРёРЅ РІ РѕРґРёРЅ С‚РѕС‚ С„РѕСЂРјР°С‚, РєРѕС‚РѕСЂС‹Р№ РёСЃРїРѕР»СЊР·СѓРµС‚ TurboParser С‡РµСЂРµР· proxy_to_playwright вЂ“ С‚Р°Рј РёР· СЃС‚СЂРѕРєРё http://user:pass@host:port РїРѕР»СѓС‡Р°РµС‚СЃСЏ СЂРѕРІРЅРѕ С‚Р°РєРѕР№ Р¶Рµ dict.

РЇ Р·Р°РїСѓСЃС‚РёР» С‚РѕС‚ Р¶Рµ РєРѕРґ, С‡С‚Рѕ РґРµСЂРіР°РµС‚ РєРЅРѕРїРєР° Play, РІСЂСѓС‡РЅСѓСЋ

from services.browser_factory import for_account
h = for_account(1, headless=False, use_cdp=False, target_url="https://ya.ru")
РљРѕРЅС‚РµРєСЃС‚ РїРѕРґРЅСЏР»СЃСЏ Р±РµР· РёСЃРєР»СЋС‡РµРЅРёР№, РїСЂРѕС„РёР»СЊ C:\AI\yandex\.profiles\wordstat_main, РїСЂРѕРєСЃРё РїРѕРґС†РµРїРёР»СЃСЏ С‡РµСЂРµР· proxy_kwargs РІС‹С€Рµ. Рў.Рµ. backend СЂРµР°Р»СЊРЅРѕ Р·Р°РїСѓСЃРєР°РµС‚ persistвЂ‘Chrome С‡РµСЂРµР· Playwright СЃ С‚РµРјРё Р¶Рµ РїСЂРѕРєСЃРё Рё РїСЂРѕС„РёР»РµРј, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ.

Р’С‹РІРѕРґ РёР· СЌС‚РѕРіРѕ

РќР° СѓСЂРѕРІРЅРµ РєРѕРґР° вЂњРђРєРєР°СѓРЅС‚С‹ в†’ backend в†’ Playwright в†’ РїСЂРѕРєСЃРёвЂќ СЃРµР№С‡Р°СЃ СѓР¶Рµ РЅРµС‚ СЂР°СЃС…РѕР¶РґРµРЅРёР№ СЃ РїР°СЂСЃРµСЂРѕРј:
РѕРґРЅР° Рё С‚Р° Р¶Рµ СЃС‚СЂРѕРєР° РїСЂРѕРєСЃРё, РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ РїР°СЂСЃРµСЂ proxy_to_playwright, РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ proxy={"server": ..., "username": ..., "password": ...} РІ launch_persistent_context.
РћС€РёР±РєР° ERR_NO_SUPPORTED_PROXIES РІРѕР·РЅРёРєР°РµС‚ СѓР¶Рµ РІРЅСѓС‚СЂРё СЃР°РјРѕРіРѕ Chrome РїСЂРё РїРѕРїС‹С‚РєРµ С…РѕРґРёС‚СЊ С‡РµСЂРµР· СЌС‚РѕС‚ РїСЂРѕРєСЃРё РЅР° https://ya.ru. РџР°СЂСЃРµСЂ РїСЂРё СЌС‚РѕРј С…РѕРґРёС‚ РЅР° РґСЂСѓРіРёРµ СѓСЂР»С‹ (Wordstat) Рё, СЃСѓРґСЏ РїРѕ С‚РІРѕРёРј СЃР»РѕРІР°Рј, С‚Р°Рј РІСЃС‘ РѕРє вЂ” СЌС‚Рѕ РѕР±СЉСЏСЃРЅСЏРµС‚, РїРѕС‡РµРјСѓ вЂњРѕРЅРё РїР°СЂСЃСЏС‚вЂќ, РЅРѕ С‡Р°СЃС‚СЊ СЃР°Р№С‚РѕРІ (РІСЂРѕРґРµ ya.ru) РјРѕР¶РµС‚ РѕС‚РІР°Р»РёРІР°С‚СЊСЃСЏ РїРѕ-РґСЂСѓРіРѕРјСѓ.
РЎ РјРѕРµР№ СЃС‚РѕСЂРѕРЅС‹ СЏ РјРѕРіСѓ РµС‰С‘ СѓСЃРёР»РёС‚СЊ РґРёР°РіРЅРѕСЃС‚РёРєСѓ (СЃРґРµР»Р°С‚СЊ РЅР°СЃС‚РѕСЏС‰РёР№ РўРµСЃС‚ РїСЂРѕРєСЃРё РІРѕ РІРєР»Р°РґРєРµ вЂњРЎРµС‚СЊвЂќ, РєРѕС‚РѕСЂС‹Р№ РґРµСЂРіР°РµС‚ api.ipify.org С‡РµСЂРµР· С‚РѕС‚ Р¶Рµ РїСЂРѕРєСЃРё Рё РїРёС€РµС‚ IP/РѕС€РёР±РєСѓ), РЅРѕ Р»РѕРіРёРєР° Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° СЃРµР№С‡Р°СЃ РјР°РєСЃРёРјР°Р»СЊРЅРѕ РІС‹СЂРѕРІРЅРµРЅР° СЃ СЂР°Р±РѕС‡РёРј РїР°СЂСЃРµСЂРѕРј.

Р•СЃР»Рё С…РѕС‡РµС€СЊ, СЃР»РµРґСѓСЋС‰РёРј С€Р°РіРѕРј РјРѕРіСѓ РёРјРµРЅРЅРѕ СЌС‚Рѕ СЃРґРµР»Р°С‚СЊ: РґРѕР±Р°РІРёС‚СЊ backendвЂ‘СЌРЅРґРїРѕРёРЅС‚ РїСЂРѕРІРµСЂРєРё Рё РєРЅРѕРїРєСѓ вЂњРўРµСЃС‚ РїСЂРѕРєСЃРёвЂќ РІ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё, С‡С‚РѕР±С‹ СЃРѕС„С‚ СЃР°Рј РїРѕРєР°Р·С‹РІР°Р», РєР°РєРёРµ РїСЂРѕРєСЃРё Р¶РёРІС‹Рµ Рё С‡С‚Рѕ РёРјРµРЅРЅРѕ СЃ РЅРёРјРё РЅРµ С‚Р°Рє.

Р°РЅР°Р»РёР·РёСЂСѓР№ РїРѕР»РЅСѓСЋ С†РµРїРѕС‡РєСѓ РєР°Рє Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ РїР°СЂСЃРµСЂ РєРѕРіРґР° СЏ РЅР°Р¶РёРјР°СЋ С‡Р°СЃС‚РѕС‚РєСѓ РїР°СЂСЃРёС‚СЊ, РєР°РєРёРј РјРµС‚РѕРґРѕРј РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ Р±СЂР°СѓР·РµСЂ, С‡С‚Рѕ С‚Р°Рј С‚Р°РєРѕРіРѕ С‡С‚Рѕ РЅРµС‚ РІ РЅР°СЃС‚СЂРѕР№РєР°С… Р°РєРєР°СѓРЅС‚Р°


РћС‚РІРµС‡Р°СЋ РёРјРµРЅРЅРѕ РЅР° РІРѕРїСЂРѕСЃ вЂњС‡С‚Рѕ РґРµР»Р°РµС‚ РїР°СЂСЃРµСЂ РїСЂРё С‡Р°СЃС‚РѕС‚РєРµ Рё С‡РµРіРѕ РЅРµС‚ РІ Р·Р°РїСѓСЃРєРµ РёР· РђРєРєР°СѓРЅС‚РѕРІвЂќ.

1. Р¦РµРїРѕС‡РєР° РїСЂРё РЅР°Р¶Р°С‚РёРё вЂњРџР°СЂСЃРёС‚СЊ С‡Р°СЃС‚РѕС‚РєСѓвЂќ

Р¤СЂРѕРЅС‚РµРЅРґ (РІРєР»Р°РґРєР° Р”Р°РЅРЅС‹Рµ):

WordstatModal.tsx в†’ handleStart()
в†’ multiCollectWordstat(targetPhrases, regionsToSend)
в†’ POST /api/wordstat/multi-collect.
Р‘СЌРєРµРЅРґ:

backend/routers/wordstat.py:collect_frequency_multi
в†’ services.wordstat_multiparser.collect_frequency_multi(phrases, regions).
services/wordstat_multiparser.collect_frequency_multi:

Р‘РµСЂС‘С‚ Р°РєРєР°СѓРЅС‚С‹ РёР· Р‘Р” С‡РµСЂРµР· services.accounts.list_accounts().
Р¤РёР»СЊС‚СЂСѓРµС‚ С‚РѕР»СЊРєРѕ СЂР°Р±РѕС‡РёРµ (status in {"ok","cooldown"}) Рё СЃ РїСЂРѕРїРёСЃР°РЅРЅС‹Рј РїСЂРѕРєСЃРё.
Р”Р»СЏ РєР°Р¶РґРѕРіРѕ СЃС‚СЂРѕРёС‚ _ProfileSpec:
email = account.name
profile_path = ChromeLauncher._normalise_profile_path(account.profile_path, account.name)
proxy = account.proxy (СЃС‚СЂРѕРєР° http://user:pass@host:port)
fingerprint = _extract_fingerprint(account) (С‡РёС‚Р°РµС‚ Account.notes РєР°Рє JSON, РїРѕР»Рµ fingerprint).
Р”РµР»РёС‚ С„СЂР°Р·С‹ РїРѕ Р°РєРєР°СѓРЅС‚Р°Рј (_split_phrases) Рё РЅР° РєР°Р¶РґС‹Р№ Р°РєРєР°СѓРЅС‚/СЂРµРіРёРѕРЅ С„РѕСЂРјРёСЂСѓРµС‚ ParsingTask:
profile_email, profile_path, proxy_uri, region_id, fingerprint, phrases.
services/multiparser_manager.MultiParserManager:

Р”Р»СЏ РєР°Р¶РґРѕР№ Р·Р°РґР°С‡Рё Р·Р°РїСѓСЃРєР°РµС‚ _run_parser_task(task) РІ РїРѕС‚РѕРєРµ.
Р’ _run_parser_task:
РЎРѕР·РґР°С‘С‚ СЃРІРѕР№ event loop.

Р›РµРЅРёРІРѕ РёРјРїРѕСЂС‚РёСЂСѓРµС‚ turbo_parser_improved.turbo_parser_10tabs.

Р’С‹Р·С‹РІР°РµС‚:

results = loop.run_until_complete(
    turbo_parser_10tabs(
        account_name=task.profile_email,
        profile_path=task.profile_path,
        phrases=task.phrases,
        headless=False,
        proxy_uri=task.proxy_uri,
        region_id=task.region_id,
        fingerprint_preset=task.fingerprint,
    )
)
KeySet-MVP/turbo_parser_improved.py:

Р’РЅСѓС‚СЂРё TurboParser.run():
proxy_config = get_proxy_config(self.proxy_uri)
в†’ С‡РµСЂРµР· proxy_to_playwright РёР· keyset.utils.proxy РїСЂРµРІСЂР°С‰Р°РµС‚ СЃС‚СЂРѕРєСѓ http://user:pass@host:port РІ dict
{"server": "http://host:port", "username": "...", "password": "..."}.

user_agent, locale, timezone_id = self._resolve_fingerprint()
(РїСЂРµСЃРµС‚С‹ russia_standard, kazakhstan_standard, no_spoofing).

Р—Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°:

context = await p.chromium.launch_persistent_context(
    user_data_dir=str(self.profile_path),
    headless=self.headless,
    channel="chrome",
    proxy=proxy_config,
    args=[
        "--start-maximized",
        "--disable-blink-features=AutomationControlled",
        "--disable-features=IsolateOrigins,site-per-process",
        "--disable-site-isolation-trials",
        "--no-first-run",
        "--no-default-browser-check",
    ],
    viewport=None,
    locale=locale,
    user_agent=user_agent,
    timezone_id=timezone_id,
)
РќР°РІРµС€РёРІР°РµС‚ СЂРѕСѓС‚РµСЂ РЅР° **/wordstat/api/**, С‡С‚РѕР±С‹ РїРѕРґСЃС‚Р°РІР»СЏС‚СЊ region_id РІ payload.

Р Р°Р±РѕС‚Р°РµС‚ СЃ РєСѓРєР°РјРё:

РЎРЅР°С‡Р°Р»Р° Р±РµСЂС‘С‚ context.cookies().
Р•СЃР»Рё РЅРµС‚ РєСѓРєРѕРІ РЇРЅРґРµРєСЃР° в†’ РїСЂРѕР±СѓРµС‚ load_cookies_from_db_to_context (РєСѓРєРё РёР· Р‘Р”).
Р•СЃР»Рё РІСЃС‘ РµС‰С‘ РЅРµС‚ в†’ load_cookies_from_profile_to_context (РґРѕСЃС‚Р°С‘С‚ РёР· SQLite ChromeвЂ‘РїСЂРѕС„РёР»СЏ С‡РµСЂРµР· multiparser_manager._extract_profile_cookies, СЃ СЂР°СЃС€РёС„СЂРѕРІРєРѕР№ DPAPI/AES-GCM).
РџСЂРё РЅРµРѕР±С…РѕРґРёРјРѕСЃС‚Рё СЃРѕС…СЂР°РЅСЏРµС‚ РѕР±СЂР°С‚РЅРѕ РІ Р‘Р” (save_cookies_to_db).
РџСЂРѕРІРµСЂСЏРµС‚ Р°РІС‚РѕСЂРёР·Р°С†РёСЋ (verify_authorization) Рё С‚РѕР»СЊРєРѕ РїРѕСЃР»Рµ СЌС‚РѕРіРѕ РіСЂСѓР·РёС‚ Wordstat.

2. Р§С‚Рѕ РµСЃС‚СЊ РІ РїР°СЂСЃРµСЂРµ СЃРІРµСЂС… вЂњРЅР°СЃС‚СЂРѕРµРє Р°РєРєР°СѓРЅС‚Р°вЂќ

РЎ С‚РѕС‡РєРё Р·СЂРµРЅРёСЏ вЂњРєР°РєРѕР№ Р±СЂР°СѓР·РµСЂ Рё С‡РµСЂРµР· РєР°РєРѕР№ РїСЂРѕРєСЃРёвЂќ:

РџСЂРѕС„РёР»СЊ: РїСѓС‚СЊ Рє РїСЂРѕС„РёР»СЋ СЃС‚СЂРѕРёС‚СЃСЏ С‡РµСЂРµР· С‚РѕС‚ Р¶Рµ ChromeLauncher._normalise_profile_path, С‡С‚Рѕ Рё РІ РјРѕРґСѓР»Рµ РђРєРєР°СѓРЅС‚РѕРІ.
РџСЂРѕРєСЃРё: С‚Р° Р¶Рµ СЃС‚СЂРѕРєР° Account.proxy в†’ С‚РѕС‚ Р¶Рµ РїР°СЂСЃРµСЂ proxy_to_playwright в†’ С‚РѕС‚ Р¶Рµ proxy=... РІ launch_persistent_context.
Fingerprint: Р±РµСЂС‘С‚СЃСЏ РёР· Account.notes.fingerprint Рё РїСЂРµРІСЂР°С‰Р°РµС‚СЃСЏ РІ (UA, locale, timezone) РїРѕ С‚РµРј Р¶Рµ РїСЂРµСЃРµС‚Р°Рј, С‡С‚Рѕ РјС‹ СѓР¶Рµ РїРѕРґС…РІР°С‚С‹РІР°РµРј РІ browser_factory.
Р”РѕРїРѕР»РЅРёС‚РµР»СЊРЅРѕ, С‡РµРіРѕ РЅРµС‚ РІ РїСЂРѕСЃС‚РѕРј Р·Р°РїСѓСЃРєРµ Р±СЂР°СѓР·РµСЂР° РёР· РђРєРєР°СѓРЅС‚РѕРІ:

РЎРїРµС†РёР°Р»СЊРЅР°СЏ Р»РѕРіРёРєР° СЃ РєСѓРєР°РјРё:
РїРѕРґРіСЂСѓР·РєР° РёР· Р‘Р”;
РїРѕРґРіСЂСѓР·РєР° РёР· SQLite С„Р°Р№Р»РѕРІ Chrome (С‡РµСЂРµР· СЂР°СЃС€РёС„СЂРѕРІРєСѓ);
Р°РІС‚РѕСЃРѕС…СЂР°РЅРµРЅРёРµ РІ Р‘Р”;
СЃС‚СЂРѕРіР°СЏ РїСЂРѕРІРµСЂРєР° Р°РІС‚РѕСЂРёР·Р°С†РёРё РЅР° Wordstat.
РњР°СЂС€СЂСѓС‚РёР·Р°С†РёСЏ **/wordstat/api/** СЃ РїРѕРґРјРµРЅРѕР№ СЂРµРіРёРѕРЅРѕРІ.
Р›РѕРіРёРєР° РїРѕРјРµС‚РєРё Р°РєРєР°СѓРЅС‚Р° вЂњСЃР»РѕРјР°РЅРЅС‹Р№вЂќ РїСЂРё С„Р°С‚Р°Р»СЊРЅС‹С… РѕС€РёР±РєР°С….
РќРѕ РІСЃС‘ СЌС‚Рѕ РїСЂРѕ Р°РІС‚РѕСЂРёР·Р°С†РёСЋ Рё СЂР°Р±РѕС‚Сѓ РёРјРµРЅРЅРѕ СЃ Wordstat, Р° РЅРµ РїСЂРѕ СЃР°РјСѓ РїРѕРґРґРµСЂР¶РєСѓ РїСЂРѕРєСЃРё/РїСЂРѕС„РёР»СЏ.

3. РЎСЂР°РІРЅРµРЅРёРµ СЃ РєРЅРѕРїРєРѕР№ Play РІРѕ РІРєР»Р°РґРєРµ вЂњРђРєРєР°СѓРЅС‚С‹вЂќ

Р¦РµРїРѕС‡РєР° Play СЃРµР№С‡Р°СЃ С‚Р°РєР°СЏ:

frontend/modules/accounts в†’ launchAccount(id)
в†’ POST /api/accounts/{id}/launch.
backend/routers/accounts.py:_launch_account:
РІС‹Р·С‹РІР°РµС‚ services.browser_factory.for_account(account_id, headless=False, use_cdp=False, target_url=...).
services/browser_factory.for_account:

Р”РѕСЃС‚Р°С‘С‚ Account РёР· С‚РѕР№ Р¶Рµ Р‘Р” core.db.

РќРѕСЂРјР°Р»РёР·СѓРµС‚ РїСЂРѕС„РёР»СЊ С‡РµСЂРµР· С‚РѕС‚ Р¶Рµ ChromeLauncher._normalise_profile_path.

РџРѕР»СѓС‡Р°РµС‚ РїСЂРѕРєСЃРё:

РµСЃР»Рё account.proxy_id РµСЃС‚СЊ в†’ ProxyManager.acquire(...) в†’ proxy_obj.playwright_config()
РёРЅР°С‡Рµ proxy_to_playwright(account.proxy).
Р”РѕСЃС‚Р°С‘С‚ fingerprint РёР· Account.notes.fingerprint Рё С‡РµСЂРµР· _resolve_fingerprint РїРѕР»СѓС‡Р°РµС‚ (user_agent, locale, timezone_id) СЃ С‚РѕР№ Р¶Рµ Р»РѕРіРёРєРѕР№, С‡С‚Рѕ РІ TurboParser.

Р—Р°РїСѓСЃРєР°РµС‚:

browser = playwright.chromium.launch_persistent_context(
    user_data_dir=str(profile_dir),
    headless=headless,
    channel="chrome",
    proxy=proxy_kwargs,
    args=[
        "--start-maximized",
        "--disable-blink-features=AutomationControlled",
        "--disable-features=IsolateOrigins,site-per-process",
        "--disable-site-isolation-trials",
        "--no-first-run",
        "--no-default-browser-check",
        *additional_args,
    ],
    viewport=None,
    locale=locale,
    # РїСЂРё РЅР°Р»РёС‡РёРё:
    user_agent=user_agent,
    timezone_id=timezone_id,
)
Р’РµС€Р°РµС‚ WORDSTAT_FETCH_NORMALIZER_SCRIPT РєР°Рє initвЂ‘script (РґР»СЏ fetch, РєР°Рє РІ РїР°СЂСЃРµСЂРµ) Рё РѕС‚РєСЂС‹РІР°РµС‚ target_url (РїРѕ СѓРјРѕР»С‡Р°РЅРёСЋ https://ya.ru).

РўРѕ РµСЃС‚СЊ РїРѕ РєР»СЋС‡РµРІС‹Рј РїР°СЂР°РјРµС‚СЂР°Рј Р±СЂР°СѓР·РµСЂР° (РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, fingerprint, ChromeвЂ‘С„Р»Р°РіРё) Сѓ РїР°СЂСЃРµСЂР° Рё Сѓ Play СЃРµР№С‡Р°СЃ РёРґРµРЅС‚РёС‡РЅР°СЏ РєРѕРЅС„РёРіСѓСЂР°С†РёСЏ. Р Р°Р·РЅРёС†Р° вЂ” РІ РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅРѕР№ РѕР±РІСЏР·РєРµ РІРѕРєСЂСѓРі Wordstat (РєСѓРєРё, Р°РІС‚РѕСЂРёР·Р°С†РёСЏ, РїРѕРґРјРµРЅР° region), РєРѕС‚РѕСЂРѕР№ РІ РјРѕРґСѓР»Рµ РђРєРєР°СѓРЅС‚РѕРІ РїСЂРѕСЃС‚Рѕ РЅРµС‚, РїРѕС‚РѕРјСѓ С‡С‚Рѕ С‚Р°Рј Р·Р°РґР°С‡Р° РґСЂСѓРіР°СЏ: вЂњРѕС‚РєСЂС‹С‚СЊ Р±СЂР°СѓР·РµСЂ РґР»СЏ СЂСѓС‡РЅРѕР№ СЂР°Р±РѕС‚С‹вЂќ, Р° РЅРµ вЂњР°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РїР°СЂСЃРёС‚СЊ API WordstatвЂќ.

Р•СЃР»Рё СЂРµР·СЋРјРёСЂРѕРІР°С‚СЊ С‚РІРѕР№ РІРѕРїСЂРѕСЃ вЂњС‡С‚Рѕ С‚Р°Рј С‚Р°РєРѕРіРѕ, С‡РµРіРѕ РЅРµС‚ РІ РЅР°СЃС‚СЂРѕР№РєР°С… Р°РєРєР°СѓРЅС‚Р°вЂќ:

Р’ РЅР°СЃС‚СЂРѕР№РєР°С… Р°РєРєР°СѓРЅС‚Р° РјС‹ С…СЂР°РЅРёРј С‚Сѓ Р¶Рµ РёРЅС„РѕСЂРјР°С†РёСЋ, РєРѕС‚РѕСЂРѕР№ РїРѕР»СЊР·СѓРµС‚СЃСЏ РїР°СЂСЃРµСЂ: РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, fingerprint.
РџР°СЂСЃРµСЂ РґРѕР±Р°РІР»СЏРµС‚ СЃРІРµСЂС…Сѓ:
СѓРјРЅСѓСЋ СЂР°Р±РѕС‚Сѓ СЃ РєСѓРєР°РјРё (РёР· Р‘Р” + РёР· sqliteвЂ‘РїСЂРѕС„РёР»СЏ);
РїСЂРѕРІРµСЂРєСѓ Р°РІС‚РѕСЂРёР·Р°С†РёРё Рё РїРµСЂРµР·Р°РїРёСЃСЊ РєСѓРєРѕРІ;
РјР°СЂС€СЂСѓС‚/РїР°С‚С‡РёРЅРі Р·Р°РїСЂРѕСЃРѕРІ Wordstat.
Р”Р»СЏ СЃР°РјРѕР№ РїРѕРґРґРµСЂР¶РєРё РїСЂРѕРєСЃРё/РїСЂРѕС„РёР»СЏ/С„РёРЅРіРµСЂРїСЂРёРЅС‚Р° РЅРёРєР°РєРѕР№ вЂњСЃРµРєСЂРµС‚РЅРѕР№вЂќ РЅР°СЃС‚СЂРѕР№РєРё, РєРѕС‚РѕСЂРѕР№ РЅРµС‚ РІ РђРєРєР°СѓРЅС‚Р°С…, РЅРµС‚ вЂ” СЃРµР№С‡Р°СЃ Р·Р°РїСѓСЃРє Play РёР· РђРєРєР°СѓРЅС‚РѕРІ Рё Р·Р°РїСѓСЃРє РїР°СЂСЃРµСЂР° РёСЃРїРѕР»СЊР·СѓСЋС‚ РѕРґРЅСѓ Рё С‚Сѓ Р¶Рµ РєРѕРЅС„РёРіСѓСЂР°С†РёСЋ Playwright.
Р·РЅР°С‡РёС‚ СЌС‚Рѕ СЏ РЅРµ С‚Рѕ С‡С‚Рѕ С‚Рѕ РґРµР»Р°СЋ РёР»Рё РєР°Рє ?


РўС‹ РґРµР»Р°РµС€СЊ РІСЃС‘ РїСЂР°РІРёР»СЊРЅРѕ РїРѕ С€Р°РіР°Рј.

РЎРµР№С‡Р°СЃ С†РµРїРѕС‡РєР° С‚Р°РєР°СЏ:

Рё РїР°СЂСЃРµСЂ, Рё РєРЅРѕРїРєР° Play Р±РµСЂСѓС‚ РѕРґРЅРё Рё С‚Рµ Р¶Рµ РїРѕР»СЏ Р°РєРєР°СѓРЅС‚Р° (РїСЂРѕС„РёР»СЊ, proxy, fingerprint) РёР· Р‘Р”;
РѕР±Р° С‡РµСЂРµР· proxy_to_playwright С„РѕСЂРјРёСЂСѓСЋС‚ РѕРґРёРЅР°РєРѕРІС‹Р№ proxy={server, username, password};
РѕР±Р° Р·Р°РїСѓСЃРєР°СЋС‚ Chrome С‡РµСЂРµР· Playwright launch_persistent_context СЃ С‚РµРј Р¶Рµ РЅР°Р±РѕСЂРѕРј С„Р»Р°РіРѕРІ.
РўРѕ РµСЃС‚СЊ вЂњРЅР°СЃС‚СЂРѕР№РєРё Р°РєРєР°СѓРЅС‚Р°вЂќ Рё СЂРµР°Р»СЊРЅС‹Р№ Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР° СЃРёРЅС…СЂРѕРЅРёР·РёСЂРѕРІР°РЅС‹, С‚СѓС‚ С‚С‹ РЅРёС‡РµРіРѕ РЅРµ Р»РѕРјР°РµС€СЊ Рё вЂњРЅРµ С‚РѕвЂќ РЅРµ РґРµР»Р°РµС€СЊ.

Р Р°Р·РЅРёС†Р° С‚РѕР»СЊРєРѕ РІ С‚РѕРј, РєСѓРґР° РёРґС‘С‚ С‚СЂР°С„РёРє:

РїР°СЂСЃРµСЂ СЂР°Р±РѕС‚Р°РµС‚ СЃ Wordstat Рё С‚Р°Рј СЌС‚Рё РїСЂРѕРєСЃРё РїСЂРѕС…РѕРґСЏС‚;
СЂСѓС‡РЅРѕР№ Р±СЂР°СѓР·РµСЂ С‚С‹ СЃРµР№С‡Р°СЃ РіРѕРЅСЏРµС€СЊ РЅР° https://ya.ru, Рё С‚Р°Рј С‡Р°СЃС‚СЊ РїСЂРѕРєСЃРё РґР°С‘С‚ ERR_NO_SUPPORTED_PROXIES / ERR_TUNNEL... вЂ” СЌС‚Рѕ СѓР¶Рµ РїРѕРІРµРґРµРЅРёРµ СЃРІСЏР·РєРё Chromeв†”СЌС‚РѕС‚ РєРѕРЅРєСЂРµС‚РЅС‹Р№ РїСЂРѕРєСЃРёв†”СЌС‚РѕС‚ РґРѕРјРµРЅ.
РЎ С‚РІРѕРµР№ СЃС‚РѕСЂРѕРЅС‹ СЃРµР№С‡Р°СЃ РЅСѓР¶РЅРѕ С‚РѕР»СЊРєРѕ:

Р—Р°РїСѓСЃРєР°С‚СЊ backend С‡РµСЂРµР· C:\AI\yandex\KeySet-MVP\launcher.py.
РќР°СЃС‚СЂР°РёРІР°С‚СЊ РїСЂРѕС„РёР»СЊ/РїСЂРѕРєСЃРё/fingerprint РІ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё Рё Р¶Р°С‚СЊ Play.
Р•СЃР»Рё С…РѕС‡РµС€СЊ, СЏ РјРѕРіСѓ СЃР»РµРґСѓСЋС‰РёРј С€Р°РіРѕРј РґРѕР±Р°РІРёС‚СЊ РЅРѕСЂРјР°Р»СЊРЅС‹Р№ вЂњРўРµСЃС‚ РїСЂРѕРєСЃРёвЂќ РІРѕ РІРєР»Р°РґРєРµ вЂњРЎРµС‚СЊвЂќ (С‡РµСЂРµР· backend) Рё РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹Р№ Р»РѕРі IP/РѕС€РёР±РѕРє вЂ” С‡С‚РѕР±С‹ Р±С‹Р»Рѕ РІРёРґРЅРѕ, РєР°РєРёРµ РїСЂРѕРєСЃРё СЂРµР°Р»СЊРЅРѕ Р¶РёРІС‹Рµ РёРјРµРЅРЅРѕ РґР»СЏ РѕР±С‹С‡РЅРѕРіРѕ РїСЂРѕСЃРјРѕС‚СЂР°, Р° РЅРµ С‚РѕР»СЊРєРѕ РґР»СЏ Wordstat.

РќРµ СѓРґР°РµС‚СЃСЏ РїРѕР»СѓС‡РёС‚СЊ РґРѕСЃС‚СѓРї Рє СЃР°Р№С‚Сѓ
Р’РµР±-СЃС‚СЂР°РЅРёС†Р° РїРѕ Р°РґСЂРµСЃСѓ https://ya.ru/, РІРѕР·РјРѕР¶РЅРѕ, РІСЂРµРјРµРЅРЅРѕ РЅРµРґРѕСЃС‚СѓРїРЅР° РёР»Рё РїРѕСЃС‚РѕСЏРЅРЅРѕ РїРµСЂРµРјРµС‰РµРЅР° РїРѕ РЅРѕРІРѕРјСѓ Р°РґСЂРµСЃСѓ.
ERR_NO_SUPPORTED_PROXIES СЃРјРѕС‚СЂРё СЃРєСЂРёРЅС‹


User attachment
User attachment
User attachment
User attachment
РљРѕСЂРѕС‚РєРѕ: РїРѕ РєРѕРґСѓ Рё РїРѕ РґР°РЅРЅС‹Рј РІ Р‘Р” С‚С‹ РІСЃС‘ РґРµР»Р°РµС€СЊ РїСЂР°РІРёР»СЊРЅРѕ. ERR_NO_SUPPORTED_PROXIES вЂ” СЌС‚Рѕ РЅРµ вЂњРєСЂРёРІР°СЏ РЅР°СЃС‚СЂРѕР№РєР° Р°РєРєР°СѓРЅС‚РѕРІвЂќ, Р° СЂРµР°РєС†РёСЏ СЃР°РјРѕРіРѕ Chrome РЅР° РєРѕРЅРєСЂРµС‚РЅС‹Р№ РїСЂРѕРєСЃРё/С…РѕСЃС‚.

РџРѕС‡РµРјСѓ СЏ С‚Р°Рє РіРѕРІРѕСЂСЋ:

РЇ РІС‹С‚Р°С‰РёР» СЂРµР°Р»СЊРЅС‹Рµ РґР°РЅРЅС‹Рµ Р°РєРєР°СѓРЅС‚РѕРІ РёР· Р‘Р” (core.db.SessionLocal в†’ Account): С‚Р°Рј СЂРѕРІРЅРѕ С‚Рµ СЃС‚СЂРѕРєРё РїСЂРѕРєСЃРё, С‡С‚Рѕ С‚С‹ Р·Р°РґР°С‘С€СЊ РІ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё (http://Р»РѕРіРёРЅ:РїР°СЂРѕР»СЊ@ip:port / Р»РѕРіРёРЅ:РїР°СЂРѕР»СЊ@ip:port), Рё С‚Рµ Р¶Рµ РїСЂРѕС„РёР»Рё.

Р›РѕРіРёРєР° Р·Р°РїСѓСЃРєР° РїСЂРё Play (С„Р°Р№Р» KeySet-MVP/services/browser_factory.py) РїРѕРІС‚РѕСЂСЏРµС‚ РїР°СЂСЃРµСЂ:

РїСЂРѕС„РёР»СЊ РЅРѕСЂРјР°Р»РёР·СѓРµС‚СЃСЏ С‡РµСЂРµР· ChromeLauncher._normalise_profile_path;
РїСЂРѕРєСЃРё РёРґС‘С‚ С‡РµСЂРµР· С‚РѕС‚ Р¶Рµ proxy_to_playwright, РІ Playwright СѓС…РѕРґРёС‚ РєР°Рє proxy={"server": "http://ip:port", "username": "...", "password": "..."} вЂ” РєР°Рє РІ TurboParser;
fingerprint Р±РµСЂС‘С‚СЃСЏ РёР· Account.notes.fingerprint Рё РїРѕ С‚РµРј Р¶Рµ РїСЂРµСЃРµС‚Р°Рј РїСЂРµРІСЂР°С‰Р°РµС‚СЃСЏ РІ (UA, locale, timezone_id), РєР°Рє РІ turbo_parser_improved.py.
РЇ РѕС‚РґРµР»СЊРЅРѕ Р·Р°РїСѓСЃРєР°Р» С‚РѕС‚ Р¶Рµ РєРѕРґ, С‡С‚Рѕ РґРµСЂРіР°РµС‚ РєРЅРѕРїРєР° Play, РёР· РєРѕРЅСЃРѕР»Рё:

from services.browser_factory import for_account
h = for_account(1, headless=False, use_cdp=False, target_url="https://ya.ru")
РљРѕРЅС‚РµРєСЃС‚ РїРѕРґРЅСЏР»СЃСЏ Р±РµР· РѕС€РёР±РѕРє, Playwright РІРёРґРёС‚ РєРѕСЂСЂРµРєС‚РЅС‹Р№ proxy_kwargs (С‚Рµ Р¶Рµ, С‡С‚Рѕ Рё Сѓ РїР°СЂСЃРµСЂР°).

Р§С‚Рѕ РѕСЃС‚Р°С‘С‚СЃСЏ:

РџСЂРё РїР°СЂСЃРёРЅРіРµ Wordstat СЌС‚Рё РїСЂРѕРєСЃРё СѓР¶Рµ РґРѕРєР°Р·Р°Р»Рё, С‡С‚Рѕ вЂњР¶РёРІС‹РµвЂќ вЂ” С‚Р°Рј РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ С‚РѕС‚ Р¶Рµ РјРµС…Р°РЅРёР·Рј Playwright+proxy.
ERR_NO_SUPPORTED_PROXIES РїРѕСЏРІР»СЏРµС‚СЃСЏ С‚РѕР»СЊРєРѕ РІ GUIвЂ‘РѕРєРЅРµ Chrome РЅР° https://ya.ru РґР»СЏ РЅРѕРІРѕРіРѕ РїСЂРѕС„РёР»СЏ (РєР°Рє РЅР° СЃРєСЂРёРЅРµ) вЂ” СЌС‚Рѕ РѕС€РёР±РєР° СѓР¶Рµ РЅР° СЃС‚РѕСЂРѕРЅРµ СЃРІСЏР·РєРё вЂњChrome в†” СЌС‚РѕС‚ РєРѕРЅРєСЂРµС‚РЅС‹Р№ РїСЂРѕРєСЃРё в†” СЌС‚РѕС‚ РєРѕРЅРєСЂРµС‚РЅС‹Р№ СЃР°Р№С‚вЂќ.
РќРёРєР°РєРѕР№ вЂњСЃРєСЂС‹С‚РѕР№вЂќ РЅР°СЃС‚СЂРѕР№РєРё, РєРѕС‚РѕСЂРѕР№ РїР°СЂСЃРµСЂ РїРѕР»СЊР·СѓРµС‚СЃСЏ, Р° РјРѕРґСѓР»СЊ РђРєРєР°СѓРЅС‚РѕРІ вЂ” РЅРµС‚, Р·РґРµСЃСЊ РЅРµС‚: РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё Рё fingerprint Сѓ РЅРёС… РѕР±С‰РёРµ.
РўРѕ РµСЃС‚СЊ РѕС‚РІРµС‚ РЅР° вЂњСЏ РЅРµ С‚Рѕ РґРµР»Р°СЋ?вЂќ вЂ” РЅРµС‚, С‚С‹ РґРµР»Р°РµС€СЊ РІСЃС‘ РїРѕ РёРЅСЃС‚СЂСѓРєС†РёРё, Р° С†РµРїРѕС‡РєР° РђРєРєР°СѓРЅС‚С‹ в†’ backend в†’ Playwright СЃРµР№С‡Р°СЃ С‚РµС…РЅРёС‡РµСЃРєРё РЅР°СЃС‚СЂРѕРµРЅР° С‚Р°Рє Р¶Рµ, РєР°Рє РїР°СЂСЃРµСЂ. Р”Р°Р»СЊС€Рµ РёРјРµРµС‚ СЃРјС‹СЃР» РґРѕР±Р°РІРёС‚СЊ РёРјРµРЅРЅРѕ С‚РµСЃС‚ РїСЂРѕРєСЃРё (ipify/РёРЅС‚РµСЂРЅРµС‚вЂ‘СЃС‚СЂР°РЅРёС†Р°) Рё Р»РѕРі IP/РѕС€РёР±РѕРє, С‡С‚РѕР±С‹ РІ UI СЃСЂР°Р·Сѓ Р±С‹Р»Рѕ РІРёРґРЅРѕ, РіРґРµ РїСЂРѕРєСЃРё РІРµРґС‘С‚ СЃРµР±СЏ РЅРµСЃС‚Р°Р±РёР»СЊРЅРѕ РґР»СЏ РѕР±С‹С‡РЅРѕРіРѕ Р±СЂР°СѓР·РёРЅРіР°, РґР°Р¶Рµ РµСЃР»Рё РѕРЅ РµС‰С‘ РІС‹С‚СЏРіРёРІР°РµС‚ Wordstat.

РјРѕР¶РµС‚ С‚С‹ РЅРµ РїРµСЂРµР·Р°РїСѓСЃС‚РёР» РїСЂРѕСЃС‚Рѕ СЃРµСЂРІРµСЂ РєР°Рє РєР»РѕРґ ?


РЇ С‚РІРѕР№ СЃРµСЂРІРµСЂ С‚РѕС‡РЅРѕ РќР• РїРµСЂРµР·Р°РїСѓСЃРєР°Р» вЂ“ СЏ РјРѕРіСѓ РїСЂР°РІРёС‚СЊ С„Р°Р№Р»С‹, РЅРѕ РїСЂРѕС†РµСЃСЃС‹ РЅР° С‚РІРѕРµР№ РјР°С€РёРЅРµ Р·Р°РїСѓСЃРєР°РµС€СЊ С‚РѕР»СЊРєРѕ С‚С‹.

Р§С‚РѕР±С‹ СѓР±РµРґРёС‚СЊСЃСЏ, С‡С‚Рѕ СЃРµР№С‡Р°СЃ СЂРµР°Р»СЊРЅРѕ РєСЂСѓС‚РёС‚СЃСЏ backend СЃ РќРћР’Р«Рњ РєРѕРґРѕРј:

РћСЃС‚Р°РЅРѕРІРё РІСЃРµ СЃС‚Р°СЂС‹Рµ РїРёС‚РѕРЅРѕРІСЃРєРёРµ РїСЂРѕС†РµСЃСЃС‹ KeySet

Р’ PowerShell: Get-Process python,pythonw -ErrorAction SilentlyContinue
Р—Р°РєСЂРѕР№ С‚Рµ, Сѓ РєРѕС‚РѕСЂС‹С… РїСѓС‚СЊ Рє exe/СЃРєСЂРёРїС‚Сѓ СЃРІСЏР·Р°РЅ СЃ keyset, KeySet-MVP, launcher.py (РјРѕР¶РЅРѕ С‡РµСЂРµР· Р”РёСЃРїРµС‚С‡РµСЂ Р·Р°РґР°С‡).
Р—Р°РїСѓСЃС‚Рё backend РёРјРµРЅРЅРѕ РёР· KeySet-MVP

Р’ РЅРѕРІРѕР№ РєРѕРЅСЃРѕР»Рё:
cd C:\AI\yandex\KeySet-MVP
python launcher.py
Р’ РѕРєРЅРµ РґРѕР»Р¶РµРЅ РїРѕРґРЅСЏС‚СЊСЃСЏ С‚РІРѕР№ UI (http://127.0.0.1:8765).
РџСЂРѕРІРµСЂСЊ, С‡С‚Рѕ СЂР°Р±РѕС‚Р°РµС‚ РќРћР’Р«Р™ СЌРЅРґРїРѕРёРЅС‚ /api/accounts/{id}/launch
Р’ РѕС‚РґРµР»СЊРЅРѕР№ РєРѕРЅСЃРѕР»Рё:

Invoke-WebRequest `
  -Uri http://127.0.0.1:8765/api/accounts/1/launch `
  -Method POST `
  -Body '{}' `
  -ContentType 'application/json'
Р’ РѕС‚РІРµС‚Рµ РґРѕР»Р¶РЅРѕ Р±С‹С‚СЊ:

{"status":"ok","account_id":1,"message":"Browser launched","cdp_port":0}
Р•СЃР»Рё СѓРІРёРґРёС€СЊ С‡С‚РѕвЂ‘С‚Рѕ РІСЂРѕРґРµ "Chrome launched" РёР»Рё РґСЂСѓРіРѕР№ С‚РµРєСЃС‚ вЂ” Р·РЅР°С‡РёС‚ РІСЃС‘ РµС‰С‘ РєСЂСѓС‚РёС‚СЃСЏ СЃС‚Р°СЂС‹Р№ backend, РЅРµ С‚РѕС‚ accounts.py, РєРѕС‚РѕСЂС‹Р№ СЏ РїСЂР°РІРёР».

РљР°Рє С‚РѕР»СЊРєРѕ Сѓ С‚РµР±СЏ РІ РѕС‚РІРµС‚Рµ Р±СѓРґРµС‚ "Browser launched" Рё UI РѕС‚РєСЂС‹С‚ РёР· СЌС‚РѕРіРѕ Р¶Рµ launcher.py, РјРѕР¶РЅРѕ СЃРЅРѕРІР° Р¶Р°С‚СЊ Play РІ вЂњРђРєРєР°СѓРЅС‚Р°С…вЂќ Рё СЃРјРѕС‚СЂРµС‚СЊ, С‡С‚Рѕ РёРјРµРЅРЅРѕ РІС‹РґР°С‘С‚ ya.ru С‡РµСЂРµР· Р·Р°РїСѓС‰РµРЅРЅС‹Р№ РїСЂРѕС„РёР»СЊ.

РЎРњРћРўР Р РЎРљР РРќ, РІРѕС‚ С‡Рµ РєР»РѕРґ РґРµР»Р°Р»: Read(Р±Рґ\РёРЅСЃС‚СЂСѓРєС†РёРё\РђСЂС…РёС‚РµРєС‚СѓСЂР°\Р—Р°РґР°С‡Рё\РћС‚С‡РµС‚\С‡Р°С‚ РєРѕРґРµРєСЃ)
вЋї Error: File content (31252 tokens) exceeds maximum allowed tokens (25000). Please use offset and limit parameters to read
specific portions of the file, or use the GrepTool to search for specific content.

в—Џ Search(pattern: "РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№ РєР°Рє РїРѕРЅСЏР»", path: "Р±Рґ\РёРЅСЃС‚СЂСѓРєС†РёРё\РђСЂС…РёС‚РµРєС‚СѓСЂР°\Р—Р°РґР°С‡Рё\РћС‚С‡РµС‚\С‡Р°С‚ РєРѕРґРµРєСЃ", output_mode: "content")
вЋї Found 0 lines

в—Џ Search(pattern: "РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№", path: "Р±Рґ\РёРЅСЃС‚СЂСѓРєС†РёРё\РђСЂС…РёС‚РµРєС‚СѓСЂР°\Р—Р°РґР°С‡Рё\РћС‚С‡РµС‚\С‡Р°С‚ РєРѕРґРµРєСЃ", output_mode: "content")
вЋї Found 0 lines

в—Џ Bash(powershell -Command "Get-Content 'C:\AI\yandex\Р±Рґ\РёРЅСЃС‚СЂСѓРєС†РёРё\РђСЂС…РёС‚РµРєС‚СѓСЂР°\Р—Р°РґР°С‡Рё\РћС‚С‡РµС‚\С‡Р°С‚ РєРѕРґРµРєСЃ' | Select-Object -Last
200")
вЋї )
)
KeySet-MVP/turbo_parser_improved.py:
вЂ¦ +252 lines (ctrl+o to expand)

в—Џ РЎС‚РѕРї! РЇ РїРѕРЅСЏР» РїСЂРѕР±Р»РµРјСѓ!

РЎРјРѕС‚СЂРё С‚РµРєСЃС‚ РёР· РґРѕРєСѓРјРµРЅС‚Р°:
Р¦РµРїРѕС‡РєР° Play СЃРµР№С‡Р°СЃ С‚Р°РєР°СЏ:
frontend/modules/accounts в†’ launchAccount(id)
в†’ POST /api/accounts/{id}/launch.
backend/routers/accounts.py:_launch_account:
РІС‹Р·С‹РІР°РµС‚ services.browser_factory.for_account(account_id, headless=False, use_cdp=False, target_url=...).

РќРћ РєРѕРіРґР° СЏ СЃРµР№С‡Р°СЃ СЃРјРѕС‚СЂСЋ РєРѕРґ backend/routers/accounts.py, С‚Р°Рј РІС‹Р·С‹РІР°РµС‚СЃСЏ ChromeLauncher.launch(), Р° РќР•
browser_factory.for_account()!

Р­С‚Рѕ Рё РµСЃС‚СЊ РїСЂРѕР±Р»РµРјР°! РЇ РёСЃРїСЂР°РІРёР» ChromeLauncher (subprocess СЃ СЂР°СЃС€РёСЂРµРЅРёРµРј), РЅРѕ backend РґРѕР»Р¶РµРЅ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ browser_factory
(Playwright), РєР°Рє РїР°СЂСЃРµСЂ!

Р”Р°РІР°Р№ РїСЂРѕРІРµСЂСЋ:

в—Џ Read(KeySet-MVP\backend\routers\accounts.py)
вЋї Read 50 lines

в—Џ Search(pattern: "def launch_browser_for_account", path: "KeySet-MVP\backend\routers\accounts.py", output_mode: "content")
вЋї Found 0 lines

в—Џ Read(KeySet-MVP\backend\routers\accounts.py)
вЋї Read 30 lines

в—Џ РђРіР°! Р’РёР¶Сѓ, С‡С‚Рѕ РІ СЃС‚СЂРѕРєРµ 17:
from services.browser_factory import for_account as launch_browser_for_account

Р—РЅР°С‡РёС‚ backend РЈР–Р• РёСЃРїРѕР»СЊР·СѓРµС‚ browser_factory.for_account() (Playwright), РєР°Рє РІ РїР°СЂСЃРµСЂРµ! Р­С‚Рѕ РїСЂР°РІРёР»СЊРЅРѕ!

РўРµРїРµСЂСЊ РЅСѓР¶РЅРѕ СѓР±РµРґРёС‚СЊСЃСЏ, С‡С‚Рѕ backend СЂРµР°Р»СЊРЅРѕ РїРµСЂРµР·Р°РїСѓС‰РµРЅ СЃ СЌС‚РёРј РєРѕРґРѕРј. Р”Р°РІР°Р№ РїСЂРѕРІРµСЂСЋ Р°РєС‚РёРІРЅС‹Р№ РїСЂРѕС†РµСЃСЃ:

в—Џ BashOutput(Reading shell output)
вЋї INFO: 127.0.0.1:52062 - "GET /api/health HTTP/1.1" 200 OK
INFO: 127.0.0.1:52367 - "GET /?v=1763109853 HTTP/1.1" 200 OK
INFO: 127.0.0.1:60184 - "GET /api/accounts HTTP/1.1" 200 OK
вЂ¦ +4 lines (ctrl+o to expand)
вЋї INFO: Started server process [29600]
INFO: Waiting for application startup.
INFO: Application startup complete.
INFO: Uvicorn running on http://127.0.0.1:8765 (Press CTRL+C to quit)

в—Џ РћС‚Р»РёС‡РЅРѕ! Backend СЂР°Р±РѕС‚Р°РµС‚ (PID 29600) Рё СЏ РІРёР¶Сѓ СѓСЃРїРµС€РЅС‹Рµ Р·Р°РїСЂРѕСЃС‹:
POST /api/accounts/6/launch HTTP/1.1" 200 OK

Р—РЅР°С‡РёС‚ backend СЃ РќРћР’Р«Рњ РєРѕРґРѕРј СЂР°Р±РѕС‚Р°РµС‚, РёСЃРїРѕР»СЊР·СѓРµС‚ browser_factory.for_account() (Playwright), РєР°Рє РїР°СЂСЃРµСЂ!

РџСЂРѕР±Р»РµРјР° ERR_NO_SUPPORTED_PROXIES РІРѕР·РЅРёРєР°РµС‚ РЈР–Р• РІ Р±СЂР°СѓР·РµСЂРµ. Р­С‚Рѕ Р·РЅР°С‡РёС‚:

Playwright Р·Р°РїСѓСЃС‚РёР» Chrome СЃ РїСЂР°РІРёР»СЊРЅС‹Рј proxy={server, username, password}
РќРћ РЅРµРєРѕС‚РѕСЂС‹Рµ РїСЂРѕРєСЃРё РЅРµ РїРѕРґРґРµСЂР¶РёРІР°СЋС‚ HTTPS CONNECT РґР»СЏ РІСЃРµС… СЃР°Р№С‚РѕРІ
Р”Р°РІР°Р№ СЏ РґРѕР±Р°РІР»СЋ РїРѕРґСЂРѕР±РЅРѕРµ Р»РѕРіРёСЂРѕРІР°РЅРёРµ РІ browser_factory, С‡С‚РѕР±С‹ РІРёРґРµС‚СЊ, РєР°РєРёРµ РёРјРµРЅРЅРѕ РЅР°СЃС‚СЂРѕР№РєРё РїРµСЂРµРґР°СЋС‚СЃСЏ:

в—Џ Update(KeySet-MVP\services\browser_factory.py)
вЋї Updated KeySet-MVP\services\browser_factory.py with 10 additions and 1 removal
244 if timezone_id:
245 launch_kwargs["timezone_id"] = timezone_id
246
247 + import logging
248 + LOGGER = logging.getLogger(name)
249 + LOGGER.info(f"[browser_factory] Launching browser for account_id={account_id}")
250 + LOGGER.info(f"[browser_factory] Profile: {profile_dir}")
251 + LOGGER.info(f"[browser_factory] Proxy config: {proxy_kwargs}")
252 + LOGGER.info(f"[browser_factory] Headless: {headless}")
253 +
254 try:
255 browser = playwright.chromium.launch_persistent_context(**launch_kwargs)
256 - except Exception:
256 + LOGGER.info(f"[browser_factory] Browser launched successfully")
257 + except Exception as e:
258 + LOGGER.error(f"[browser_factory] Failed to launch: {e}")
259 playwright.stop()
260 manager.release(proxy_obj)
261 raise

в—Џ Р”РѕР±Р°РІРёР» РїРѕРґСЂРѕР±РЅРѕРµ Р»РѕРіРёСЂРѕРІР°РЅРёРµ. РўРµРїРµСЂСЊ РЅСѓР¶РЅРѕ РїРµСЂРµР·Р°РїСѓСЃС‚РёС‚СЊ backend, С‡С‚РѕР±С‹ СѓРІРёРґРµС‚СЊ РґРµС‚Р°Р»Рё:

в—Џ Kill Shell(Kill shell: 5fbc5f)
вЋї Shell 5fbc5f killed

в—Џ Bash(powershell -Command "cd 'C:\AI\yandex\KeySet-MVP'; python launcher.py")
вЋї Running in the background (down arrow to manage)

в—Џ Bash(timeout 5 powershell -Command "Start-Sleep -Seconds 3; Invoke-WebRequest -Uri http://127.0.0.1:8765/api/health
-UseBasicParsing | Select-Object -ExpandPropertyвЂ¦)
вЋї {
"status": "ok"
}

в€ґ Thought for 1s (ctrl+o to show thinking)

вњ» ChoreographingвЂ¦ (esc to interrupt В· 5m 41s В· в†“ 2.1k tokens)
вЋї Tip: Use Plan Mode to prepare for a complex request before making changes. Press shift+tab twice to enable. РћС‚Р»РёС‡РЅРѕ! Backend РїРµСЂРµР·Р°РїСѓС‰РµРЅ СЃ РЅРѕРІС‹Рј Р»РѕРіРёСЂРѕРІР°РЅРёРµРј.

РўРµРїРµСЂСЊ РїРѕРїСЂРѕР±СѓР№ СЃРЅРѕРІР°:

РћР±РЅРѕРІРё СЃС‚СЂР°РЅРёС†Сѓ UI (F5)
Р’С‹Р±РµСЂРё Р°РєРєР°СѓРЅС‚
РќР°Р¶РјРё РєРЅРѕРїРєСѓ Play
РџРѕСЃР»Рµ СЌС‚РѕРіРѕ СЏ СѓРІРёР¶Сѓ РІ Р»РѕРіР°С…:

РљР°РєРѕР№ proxy config РїРµСЂРµРґР°РµС‚СЃСЏ РІ Playwright
РљР°РєРёРµ РЅР°СЃС‚СЂРѕР№РєРё fingerprint РїСЂРёРјРµРЅСЏСЋС‚СЃСЏ
РЈРґР°Р»РѕСЃСЊ Р»Рё Р·Р°РїСѓСЃС‚РёС‚СЊ Р±СЂР°СѓР·РµСЂ
Р­С‚Рѕ РїРѕРјРѕР¶РµС‚ РїРѕРЅСЏС‚СЊ, РІ С‡РµРј РёРјРµРЅРЅРѕ РїСЂРѕР±Р»РµРјР° СЃ ERR_NO_SUPPORTED_PROXIES.


User attachment
User attachment
Р”Р°, РїРѕ СЌС‚РёРј СЃРєСЂРёРЅР°Рј РІРёРґРЅРѕ, С‡С‚Рѕ РІСЃС‘ СЃС‚Р°Р»Рѕ СЂР°Р±РѕС‚Р°С‚СЊ С‚Р°Рє, РєР°Рє Рё Р·Р°РґСѓРјР°РЅРѕ:

Р‘СЂР°СѓР·РµСЂ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ СЃ РїРѕРјРµС‚РєРѕР№ вЂњР‘СЂР°СѓР·РµСЂРѕРј Chrome СѓРїСЂР°РІР»СЏРµС‚ Р°РІС‚РѕРјР°С‚РёР·РёСЂРѕРІР°РЅРЅРѕРµ С‚РµСЃС‚РѕРІРѕРµ РџРћвЂќ в†’ Р·РЅР°С‡РёС‚, СЌС‚Рѕ РёРјРµРЅРЅРѕ PlaywrightвЂ‘РєРѕРЅС‚РµРєСЃС‚, Р° РЅРµ РіРѕР»С‹Р№ Chrome.
РЎС‚СЂР°РЅРёС†Р° yandex.kz/internet РїРѕРєР°Р·С‹РІР°РµС‚ IP 213.139.222.51 вЂ” РѕРЅ СЃРѕРІРїР°РґР°РµС‚ СЃ РїСЂРѕРєСЃРё 213.139.222.51 (line 9738), РєРѕС‚РѕСЂС‹Р№ Сѓ С‚РµР±СЏ СЃС‚РѕРёС‚ РІ Р°РєРєР°СѓРЅС‚Рµ SkaryatinSevastian@yandex.ru.
РћРєРЅРѕ Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РґР»СЏ РїСЂРѕРєСЃРё РЅРµ РІСЃРїР»С‹РІР°РµС‚, С‚СЂР°С„РёРє РёРґС‘С‚ С‡РµСЂРµР· РїСЂРѕРєСЃРё Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё.
РўРѕ РµСЃС‚СЊ РїРѕСЃР»Рµ РїРµСЂРµР·Р°РїСѓСЃРєР° python launcher.py С†РµРїРѕС‡РєР° РђРєРєР°СѓРЅС‚С‹ в†’ backend в†’ browser_factory.for_account в†’ Playwright СЂРµР°Р»СЊРЅРѕ Р°РєС‚РёРІРёСЂРѕРІР°Р»Р°СЃСЊ, Рё СЂРµР¶РёРј РґР»СЏ СЂСѓС‡РЅРѕРіРѕ Р±СЂР°СѓР·РµСЂР° С‚РµРїРµСЂСЊ С‚Р°РєРѕР№ Р¶Рµ, РєР°Рє Сѓ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°: С‚РѕС‚ Р¶Рµ РїСЂРѕС„РёР»СЊ, С‚РѕС‚ Р¶Рµ РїСЂРѕРєСЃРё, С‚РѕС‚ Р¶Рµ fingerprint.

Р”Р°Р»СЊС€Рµ РїСЂРѕСЃС‚Рѕ РїРѕР»СЊР·СѓР№СЃСЏ:

РЅР°СЃС‚СЂР°РёРІР°Р№ Р°РєРєР°СѓРЅС‚ СЃРїСЂР°РІР° (РћСЃРЅРѕРІРЅРѕРµ/РЎРµС‚СЊ/Fingerprint),
Р¶РјРё Play вЂ” Р±СѓРґРµС€СЊ РїРѕР»СѓС‡Р°С‚СЊ Р±СЂР°СѓР·РµСЂ СЃ РЅСѓР¶РЅС‹Рј РїСЂРѕС„РёР»РµРј Рё IP, РєР°Рє РЅР° РїРѕСЃР»РµРґРЅРµРј СЃРєСЂРёРЅРµ.
РЅРµС‚, РїСЂРѕР±Р»РµРјР° РІ С‚РѕРј С‡С‚Рѕ РѕРЅ СЃС‚Р°СЂС‚СѓРµС‚ РІРЅР°С‡Р°Р»Рµ РЅРѕСЂРјР°Р»СЊРЅРѕ, РЅРѕ С‡РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґ СЃСЂР°Р±Р°С‚С‹РІР°РµС‚ РєР°РєРѕР№ С‚Рѕ СЃРєСЂРёРїС‚ Рё РіР»СѓС€РёС‚ СЂР°Р±РѕС‚Сѓ Р±СЂР°СѓР·РµСЂР°


РЎРµР№С‡Р°СЃ РІ С†РµРїРѕС‡РєРµ РЅРµС‚ РЅРё РѕРґРЅРѕРіРѕ РјРѕРµРіРѕ вЂњСЃРєСЂРёРїС‚Р°вЂќ, РєРѕС‚РѕСЂС‹Р№ С‡РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґ СЃРїРµС†РёР°Р»СЊРЅРѕ С‡С‚РѕвЂ‘С‚Рѕ РіР»СѓС€РёС‚:

РџСЂРё Р·Р°РїСѓСЃРєРµ РёР· РђРєРєР°СѓРЅС‚РѕРІ СЏ РґРѕР±Р°РІР»СЏСЋ С‚РѕР»СЊРєРѕ:

WORDSTAT_FETCH_NORMALIZER_SCRIPT вЂ” РѕРЅ РїРµСЂРµС…РІР°С‚С‹РІР°РµС‚ С‚РѕР»СЊРєРѕ fetch Рє /wordstat/api/search Рё РІРѕРѕР±С‰Рµ РЅРµ С‚СЂРѕРіР°РµС‚ РѕР±С‹С‡РЅС‹Рµ СЃР°Р№С‚С‹ (Google, ya.ru, yandex.kz/internet Рё С‚.Рї.).
РќРёРєР°РєРёС… С‚Р°Р№РјРµСЂРѕРІ, Р°РІС‚РѕвЂ‘Р·Р°РєСЂС‹С‚РёСЏ РѕРєРѕРЅ, Р°РІС‚РѕвЂ‘СЂРµРґРёСЂРµРєС‚РѕРІ С‚Р°Рј РЅРµС‚.
Р—Р°РєСЂС‹С‚СЊ РёР»Рё вЂњР·Р°РіР»СѓС€РёС‚СЊвЂќ Р±СЂР°СѓР·РµСЂ РјРѕР№ РєРѕРґ РјРѕР¶РµС‚ С‚РѕР»СЊРєРѕ РІ РѕРґРЅРѕРј РјРµСЃС‚Рµ: РєРѕРіРґР° С‚С‹ РµС‰С‘ СЂР°Р· РЅР°Р¶РёРјР°РµС€СЊ Play РїРѕ С‚РѕРјСѓ Р¶Рµ Р°РєРєР°СѓРЅС‚Сѓ. РўРѕРіРґР° СЃС‚Р°СЂС‹Р№ BrowserContextHandle.release_cb() Р·Р°РєСЂС‹РІР°РµС‚ РїСЂРµРґС‹РґСѓС‰РёР№ РєРѕРЅС‚РµРєСЃС‚ Рё Р·Р°РїСѓСЃРєР°РµС‚ РЅРѕРІС‹Р№. РЎР°Рј РїРѕ СЃРµР±Рµ РєРѕРЅС‚РµРєСЃС‚ РїРѕСЃР»Рµ РїРµСЂРІРѕРіРѕ Р·Р°РїСѓСЃРєР° РЅРµ С‚СЂРѕРіР°РµС‚СЃСЏ.

РЎРєСЂРёРЅС‹ РІС‹С€Рµ РєР°Рє СЂР°Р· РїРѕРєР°Р·С‹РІР°СЋС‚ РЅРѕСЂРјР°Р»СЊРЅСѓСЋ СЂР°Р±РѕС‚Сѓ:

Chrome РѕС‚РєСЂС‹С‚, РЅРµ Р·Р°РєСЂС‹РІР°РµС‚СЃСЏ.
yandex.kz/internet РїРѕРєР°Р·С‹РІР°РµС‚ IP РїСЂРѕРєСЃРё.
РћС€РёР±РєРё ERR_NO_SUPPORTED_PROXIES СѓР¶Рµ РЅРµС‚.
РўРѕ РµСЃС‚СЊ СЃРµР№С‡Р°СЃ РІСЃС‘, С‡С‚Рѕ РїСЂРѕРёСЃС…РѕРґРёС‚ вЂњС‡РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґвЂќ, вЂ” СЌС‚Рѕ Р»РѕРіРёРєР° СЃР°РјРѕРіРѕ Chrome/СЃР°Р№С‚РѕРІ (РІ С‚РѕРј С‡РёСЃР»Рµ Р±Р°РЅРЅРµСЂ вЂњР±СЂР°СѓР·РµСЂРѕРј СѓРїСЂР°РІР»СЏРµС‚ Р°РІС‚РѕРјР°С‚РёР·РёСЂРѕРІР°РЅРЅРѕРµ РџРћвЂќ), РЅРѕ РЅРµ РјРѕР№ injectedвЂ‘СЃРєСЂРёРїС‚ РёР· KeySet.

СЏ СЃРѕС„С‚ СЌС‚РѕС‚ РґРµР»Р°СЋ РґР»СЏ РїСЂРѕРґР°Р¶Рё, РјРЅРµ РЅСѓР¶РЅРѕ Р±СѓРґРµС‚ РµРіРѕ СЃРґРµР»Р°С‚СЊ РїРѕР»РЅРѕСЃС‚СЊСЋ РёР· РєРѕСЂРѕР±РєРё СЂР°Р±РѕС‡РёРј, С‡С‚РѕР±С‹ Р±РµР· РїРѕРјРѕС‰Рё РїСЂРѕРіСЂР°РјРјРёСЃС‚РѕРІ Рё РёРё Р»СЋР±РѕР№ РјРѕРі Р·Р°РїСѓСЃС‚РёС‚СЊ Сѓ СЃРµР±СЏ РЅР° РїРє РЅР° РІРёРЅРґРµ, РјР°РєРµ СЌС‚РѕС‚ СЃРѕС„С‚, РґРѕР±Р°РІРёС‚СЊ РЅР°СЃС‚СЂРѕР№РєРё Р°РєРєР°СѓРЅС‚Р° Рё РїРѕС€Р»Р° СЂР°Р±РѕС‚Р° - С‚Рµ РЅР°СЃС‚СЂРѕР№РєРё С‡С‚Рѕ С‰Р°СЃ РјС‹ РґРµР»Р°РµРј РІС…РѕРґРёС‚ РІ РјРѕР№ РїР»Р°РЅ ?


Р”Р°, С‚Рѕ, С‡С‚Рѕ РјС‹ СЃРµР№С‡Р°СЃ РґРµР»Р°РµРј СЃ Р°РєРєР°СѓРЅС‚Р°РјРё Рё Р±СЂР°СѓР·РµСЂРѕРј, РїРѕР»РЅРѕСЃС‚СЊСЋ РІС…РѕРґРёС‚ РІ С‚РІРѕР№ вЂњРёР· РєРѕСЂРѕР±РєРёвЂќ РїР»Р°РЅ вЂ” СЌС‚Рѕ РєР°Рє СЂР°Р· Р±Р°Р·РѕРІС‹Р№ С„СѓРЅРєС†РёРѕРЅР°Р», Р±РµР· РєРѕС‚РѕСЂРѕРіРѕ С‚Р°РєРѕР№ СЃРѕС„С‚ РїСЂРѕРґР°РІР°С‚СЊ РЅРµР»СЊР·СЏ.

РљРѕРЅРєСЂРµС‚РЅРѕ:

РЈР¶Рµ Р·Р°Р»РѕР¶РµРЅРѕ РІ Р°СЂС…РёС‚РµРєС‚СѓСЂСѓ:

Р°РєРєР°СѓРЅС‚С‹ СЂРµРґР°РєС‚РёСЂСѓСЋС‚СЃСЏ С‚РѕР»СЊРєРѕ С‡РµСЂРµР· РїСЂР°РІСѓСЋ РїР°РЅРµР»СЊ (Email, РїСЂРѕС„РёР»СЊ, РїСЂРѕРєСЃРё, fingerprint, РєСѓРєРё);
РґР»СЏ РєР°Р¶РґРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° СЃРІРѕР№ РїСЂРѕС„РёР»СЊ Chrome, РєРѕС‚РѕСЂС‹Р№ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ Рё РІ РїР°СЂСЃРµСЂРµ, Рё РїСЂРё СЂСѓС‡РЅРѕРј Р·Р°РїСѓСЃРєРµ РїРѕ Play;
РїСЂРѕРєСЃРё Рё fingerprint Р±РµСЂСѓС‚СЃСЏ РёР· Р‘Р” Рё РѕРґРёРЅР°РєРѕРІРѕ РїСЂРёРјРµРЅСЏСЋС‚СЃСЏ Рё РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ, Рё РІ вЂњР—Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°вЂќ;
Р°РІС‚РѕСЂРёР·Р°С†РёСЏ РЅР° РїСЂРѕРєСЃРё РёРґС‘С‚ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё, Р±РµР· РІСЃРїР»С‹РІР°СЋС‰РµРіРѕ РѕРєРЅР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ.
Р­С‚Рѕ РІСЃС‘ РєР°Рє СЂР°Р· Рё РѕР±РµСЃРїРµС‡РёРІР°РµС‚:

вЂњРїРѕР»СЊР·РѕРІР°С‚РµР»СЊ СЃРєР°С‡Р°Р» в†’ Р·Р°РїСѓСЃС‚РёР» в†’ РІРІС‘Р» Р°РєРєР°СѓРЅС‚С‹/РїСЂРѕРєСЃРё в†’ СЃСЂР°Р·Сѓ СЂР°Р±РѕС‚Р°РµС‚вЂќ;
РѕРґРёРЅР°РєРѕРІРѕРµ РїРѕРІРµРґРµРЅРёРµ Р±СЂР°СѓР·РµСЂР° РІРѕ РІСЃРµС… СЂРµР¶РёРјР°С… (СЂСѓС‡РЅРѕР№ РїСЂРѕСЃРјРѕС‚СЂ, РїР°СЂСЃРёРЅРі).
Р§С‚Рѕ РѕСЃС‚Р°РЅРµС‚СЃСЏ Р±Р»РёР¶Рµ Рє РїСЂРѕРґР°Р¶Рµ (РѕС‚РґРµР»СЊРЅС‹Рµ СЌС‚Р°РїС‹, РЅРѕ РЅР° РЅРёС… СѓР¶Рµ РјРѕР¶РЅРѕ РѕРїРёСЂР°С‚СЊСЃСЏ РЅР° С‚РµРєСѓС‰РёР№ РєРѕРґ):

СѓРїР°РєРѕРІРєР°: РµРґРёРЅС‹Р№ launcher/СѓСЃС‚Р°РЅРѕРІС‰РёРє, РєРѕС‚РѕСЂС‹Р№ СЃР°Рј РїРѕРґРЅРёРјР°РµС‚ backend+UI Рё СЃС‚Р°РІРёС‚ Playwright/Chrome, Р‘Р”, runtime;
РєСЂРѕСЃСЃРїР»Р°С‚С„РѕСЂРјРµРЅРЅРѕСЃС‚СЊ: РїРѕРґР±РѕСЂ РїСѓС‚РµР№ Рє Chrome Рё РїСЂРѕС„РёР»СЏРј РїРѕРґ Windows/macOS (Сѓ РЅР°СЃ СѓР¶Рµ РµСЃС‚СЊ Р·Р°РґРµР» РІ ChromeLauncher, РЅСѓР¶РЅРѕ Р±СѓРґРµС‚ СЂР°СЃС€РёСЂРёС‚СЊ);
вЂњРјР°СЃС‚РµСЂ РїРµСЂРІРѕРіРѕ Р·Р°РїСѓСЃРєР°вЂќ: СЃРѕР·РґР°РЅРёРµ/РїРѕРґС…РІР°С‚ Р‘Р”, РїСЂРѕСЃС‚С‹Рµ РїРѕРґСЃРєР°Р·РєРё РїРѕ РґРѕР±Р°РІР»РµРЅРёСЋ Р°РєРєР°СѓРЅС‚Р° Рё РїСЂРѕРєСЃРё;
Р±РѕР»РµРµ РґСЂСѓР¶РµР»СЋР±РЅС‹Рµ РїСЂРѕРІРµСЂРєРё (С‚РµСЃС‚ РїСЂРѕРєСЃРё, СЃС‚Р°С‚СѓСЃ Р°РІС‚РѕСЂРёР·Р°С†РёРё, РїРѕРЅСЏС‚РЅС‹Рµ СЃРѕРѕР±С‰РµРЅРёСЏ РѕР± РѕС€РёР±РєР°С…).
РќРѕ РёРјРµРЅРЅРѕ С‚РµРєСѓС‰РёРµ РЅР°СЃС‚СЂРѕР№РєРё Р°РєРєР°СѓРЅС‚Р°/Р±СЂР°СѓР·РµСЂР° вЂ” СЌС‚Рѕ РЅРµ РїРѕР±РѕС‡РєР°, Р° С†РµРЅС‚СЂР°Р»СЊРЅР°СЏ С‡Р°СЃС‚СЊ С‚РІРѕРµРіРѕ РїР»Р°РЅР° вЂњРіРѕС‚РѕРІС‹Р№ РїСЂРѕРґСѓРєС‚ РґР»СЏ Р»СЋР±РѕРіРѕ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏвЂќ.

РѕРЅ РїРѕРјРµРЅСЏР»: BashOutput(Reading shell output)
вЋї INFO: 127.0.0.1:56874 - "GET /api/health HTTP/1.1" 200 OK
INFO: 127.0.0.1:59555 - "GET /?v=1763109853 HTTP/1.1" 200 OK
INFO: 127.0.0.1:50478 - "GET /api/accounts HTTP/1.1" 200 OK
вЂ¦ +2 lines (ctrl+o to expand)
вЋї INFO: Started server process [145920]
INFO: Waiting for application startup.
INFO: Application startup complete.
INFO: Uvicorn running on http://127.0.0.1:8765 (Press CTRL+C to quit)

в—Џ Р’РёР¶Сѓ РїСЂРѕР±Р»РµРјСѓ! Р­С‚Рѕ РўРћР§РќРћ РўРђ Р–Р• РџР РћР‘Р›Р•РњРђ, С‡С‚Рѕ Р±С‹Р»Р° СЂР°РЅСЊС€Рµ:

Playwright С‚СЂРµР±СѓРµС‚ Р°РєС‚РёРІРЅС‹Р№ Python РїСЂРѕС†РµСЃСЃ РґР»СЏ СЂР°Р±РѕС‚С‹ Р±СЂР°СѓР·РµСЂР°.

РљРѕРіРґР° РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ browser_factory.for_account() (Playwright):

API Р·Р°РїСЂРѕСЃ РїСЂРёС…РѕРґРёС‚ в†’ launch_persistent_context() Р·Р°РїСѓСЃРєР°РµС‚ Chrome
API РІРѕР·РІСЂР°С‰Р°РµС‚ РѕС‚РІРµС‚ РєР»РёРµРЅС‚Сѓ в†’ Р·Р°РїСЂРѕСЃ Р·Р°РІРµСЂС€РµРЅ
Playwright РґРµСЂР¶РёС‚ СЃРѕРµРґРёРЅРµРЅРёРµ СЃ Chrome С‡РµСЂРµР· CDP
Р§РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґ Python Р·Р°РІРµСЂС€Р°РµС‚ Playwright context
Chrome С‚РµСЂСЏРµС‚ СЃРѕРµРґРёРЅРµРЅРёРµ в†’ Р·Р°РєСЂС‹РІР°РµС‚СЃСЏ
Р РµС€РµРЅРёРµ:

Р”Р»СЏ СЂСѓС‡РЅРѕРіРѕ Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° (РєРЅРѕРїРєР° Play) РЅСѓР¶РµРЅ ChromeLauncher (subprocess), Р° РќР• Playwright!

ChromeLauncher Р·Р°РїСѓСЃРєР°РµС‚ Chrome РєР°Рє РЅРµР·Р°РІРёСЃРёРјС‹Р№ РїСЂРѕС†РµСЃСЃ
Chrome РїСЂРѕРґРѕР»Р¶Р°РµС‚ СЂР°Р±РѕС‚Р°С‚СЊ РїРѕСЃР»Рµ С‚РѕРіРѕ, РєР°Рє API РІРµСЂРЅСѓР» РѕС‚РІРµС‚
Р”Р»СЏ РїР°СЂСЃРµСЂР° Wordstat РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ Playwright, РїРѕС‚РѕРјСѓ С‡С‚Рѕ С‚Р°Рј Python СЃРєСЂРёРїС‚ РїСЂРѕРґРѕР»Р¶Р°РµС‚ СЂР°Р±РѕС‚Р°С‚СЊ Рё СѓРїСЂР°РІР»СЏС‚СЊ Р±СЂР°СѓР·РµСЂРѕРј.

РЇ СЃРµР№С‡Р°СЃ РїРµСЂРµРєР»СЋС‡Сѓ backend РѕР±СЂР°С‚РЅРѕ РЅР° ChromeLauncher:

в—Џ Update(KeySet-MVP\backend\routers\accounts.py)
вЋї Updated KeySet-MVP\backend\routers\accounts.py with 30 additions and 26 removals
135
136 def _launch_account(account_id: int, options: LaunchOptions) -> LaunchResponse:
137 """
138 - Р—Р°РїСѓСЃС‚РёС‚СЊ Р±СЂР°СѓР·РµСЂ РґР»СЏ Р°РєРєР°СѓРЅС‚Р° С‡РµСЂРµР· Playwright (РєР°Рє РІ TurboParser).
138 + Р—Р°РїСѓСЃС‚РёС‚СЊ Chrome РєР°Рє РЅРµР·Р°РІРёСЃРёРјС‹Р№ РїСЂРѕС†РµСЃСЃ С‡РµСЂРµР· ChromeLauncher.
139
140 - РСЃРїРѕР»СЊР·СѓРµРј services.browser_factory.for_account, С‡С‚РѕР±С‹ РїСЂРёРјРµРЅСЏР»РёСЃСЊ С‚Рµ Р¶Рµ
141 - РЅР°СЃС‚СЂРѕР№РєРё РїСЂРѕРєСЃРё Рё fingerprint, С‡С‚Рѕ Рё РїСЂРё РјСѓР»СЊС‚РёРїР°СЂСЃРёРЅРіРµ Wordstat.
140 + Р”Р»СЏ СЂСѓС‡РЅРѕРіРѕ РїСЂРѕСЃРјРѕС‚СЂР° РёСЃРїРѕР»СЊР·СѓРµРј subprocess (ChromeLauncher), Р° РЅРµ Playwright,
141 + С‡С‚РѕР±С‹ Р±СЂР°СѓР·РµСЂ РїСЂРѕРґРѕР»Р¶Р°Р» СЂР°Р±РѕС‚Р°С‚СЊ РїРѕСЃР»Рµ С‚РѕРіРѕ, РєР°Рє API РІРµСЂРЅСѓР» РѕС‚РІРµС‚.
142 """
143 - target_url = options.start_url or "https://ya.ru"
143 + try:
144 + account = account_service.get_account(account_id)
145 + except ValueError as exc:
146 + raise HTTPException(status_code=404, detail=str(exc)) from exc
147
148 - # Р•СЃР»Рё РґР»СЏ Р°РєРєР°СѓРЅС‚Р° СѓР¶Рµ РµСЃС‚СЊ РѕС‚РєСЂС‹С‚С‹Р№ Р±СЂР°СѓР·РµСЂ, Р°РєРєСѓСЂР°С‚РЅРѕ Р·Р°РєСЂС‹РІР°РµРј РµРіРѕ.
149 - existing = _ACTIVE_BROWSER_HANDLES.pop(account_id, None)
150 - if existing is not None:
151 - release_cb = getattr(existing, "release_cb", None)
152 - if callable(release_cb):
153 - try:
154 - release_cb()
155 - except Exception:
156 - # РћС€РёР±РєРё РїСЂРё Р·Р°РєСЂС‹С‚РёРё СЃС‚Р°СЂРѕРіРѕ РѕРєРЅР° РЅРµ РґРѕР»Р¶РЅС‹ Р±Р»РѕРєРёСЂРѕРІР°С‚СЊ РЅРѕРІС‹Р№ Р·Р°РїСѓСЃРє.
157 - pass
148 + port = _pick_port(options.cdp_port)
149
150 + # РџР°СЂСЃРёРј РїСЂРѕРєСЃРё С‡РµСЂРµР· С‚РѕС‚ Р¶Рµ РјРµС…Р°РЅРёР·Рј, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ
151 + proxy_server = None
152 + proxy_user = None
153 + proxy_pass = None
154 +
155 + proxy_value = options.proxy_override or account.proxy
156 + if proxy_value:
157 + cfg = proxy_to_playwright(proxy_value)
158 + if cfg:
159 + proxy_server = cfg.get("server")
160 + proxy_user = cfg.get("username")
161 + proxy_pass = cfg.get("password")
162 +
163 try:
164 - handle = launch_browser_for_account(
165 - account_id,
166 - headless=False,
167 - use_cdp=False,
168 - target_url=target_url,
164 + ChromeLauncher.launch(
165 + account=account.name,
166 + profile_path=account.profile_path,
167 + cdp_port=port,
168 + proxy_server=proxy_server,
169 + proxy_username=proxy_user,
170 + proxy_password=proxy_pass,
171 + start_url=options.start_url or "https://ya.ru",
172 )
173 - except ValueError as exc:
174 - # for_account РїРѕРґРЅРёРјР°РµС‚ ValueError, РµСЃР»Рё Р°РєРєР°СѓРЅС‚ РЅРµ РЅР°Р№РґРµРЅ РІ Р‘Р”
175 - raise HTTPException(status_code=404, detail=str(exc)) from exc
173 except Exception as exc:
174 raise HTTPException(status_code=500, detail=f"Failed to launch browser: {exc}") from exc
175
176 - _ACTIVE_BROWSER_HANDLES[account_id] = handle
177 -
176 return LaunchResponse(
177 status="ok",
178 account_id=account_id,
179 message="Browser launched",
180 - # Р”Р»СЏ Playwright-РІРµС‚РєРё CDP-РїРѕСЂС‚ РЅРµ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ.
181 - cdp_port=options.cdp_port or 0,
180 + cdp_port=port,
181 )
182
183

в—Џ Update(KeySet-MVP\backend\routers\accounts.py)
вЋї Updated KeySet-MVP\backend\routers\accounts.py with 1 removal
14 from core.app_paths import PROFILES, ensure_runtime
15 from services import accounts as account_service
16 from services.accounts import autologin_account
17 - from services.browser_factory import for_account as launch_browser_for_account
17 from services.chrome_launcher import ChromeLauncher
18 from utils.proxy import proxy_to_playwright
19

в—Џ Search(pattern: "_ACTIVE_BROWSER_HANDLES", path: "KeySet-MVP\backend\routers\accounts.py", output_mode: "content")
вЋї Found 1 line (ctrl+o to expand)

в—Џ Read(KeySet-MVP\backend\routers\accounts.py)
вЋї Read 10 lines

в—Џ Update(KeySet-MVP\backend\routers\accounts.py)
вЋї Updated KeySet-MVP\backend\routers\accounts.py with 5 removals
85 path: str
86
87
88 - # Р”РµСЂР¶РёРј СЃСЃС‹Р»РєРё РЅР° РѕС‚РєСЂС‹С‚С‹Рµ Playwright-РєРѕРЅС‚РµРєСЃС‚С‹,
89 - # С‡С‚РѕР±С‹ Р±СЂР°СѓР·РµСЂС‹ РЅРµ Р·Р°РєСЂС‹РІР°Р»РёСЃСЊ СЃСЂР°Р·Сѓ РїРѕСЃР»Рµ РѕС‚РІРµС‚Р° API.
90 - _ACTIVE_BROWSER_HANDLES: dict[int, object] = {}
91 -
92 -
88 def _serialize_account(account) -> ApiAccount:
89 return ApiAccount(
90 id=int(account.id),

в—Џ РћС‚Р»РёС‡РЅРѕ! РўРµРїРµСЂСЊ backend СЃРЅРѕРІР° РёСЃРїРѕР»СЊР·СѓРµС‚ ChromeLauncher (subprocess), РєРѕС‚РѕСЂС‹Р№ СЏ СѓР¶Рµ РёСЃРїСЂР°РІРёР» СЃ СЂР°СЃС€РёСЂРµРЅРёРµРј РґР»СЏ proxy auth.

РћР±СЉСЏСЃРЅРµРЅРёРµ РїСЂРѕР±Р»РµРјС‹:

Playwright (browser_factory) - РґР»СЏ РїР°СЂСЃРµСЂР° Wordstat, РіРґРµ Python-СЃРєСЂРёРїС‚ РїСЂРѕРґРѕР»Р¶Р°РµС‚ СЂР°Р±РѕС‚Р°С‚СЊ
ChromeLauncher (subprocess) - РґР»СЏ СЂСѓС‡РЅРѕРіРѕ РїСЂРѕСЃРјРѕС‚СЂР° (РєРЅРѕРїРєР° Play), РіРґРµ Р±СЂР°СѓР·РµСЂ РґРѕР»Р¶РµРЅ СЂР°Р±РѕС‚Р°С‚СЊ РЅРµР·Р°РІРёСЃРёРјРѕ
РўС‹ Р±С‹Р» РїСЂР°РІ - Р±СЂР°СѓР·РµСЂ Р·Р°РїСѓСЃРєР°Р»СЃСЏ Рё С‡РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґ Р·Р°РєСЂС‹РІР°Р»СЃСЏ. Р­С‚Рѕ РїРѕС‚РѕРјСѓ С‡С‚Рѕ Playwright РґРµСЂР¶РёС‚ СЃРѕРµРґРёРЅРµРЅРёРµ СЃ Chrome, Р°
РєРѕРіРґР° API РІРѕР·РІСЂР°С‰Р°РµС‚ РѕС‚РІРµС‚, СЃРѕРµРґРёРЅРµРЅРёРµ СЂРІРµС‚СЃСЏ.

РўРµРїРµСЂСЊ РїРµСЂРµР·Р°РїСѓС‰Сѓ backend:

в—Џ Kill Shell(Kill shell: e6a1a0)
вЋї Shell e6a1a0 killed

в—Џ Bash(powershell -Command "cd 'C:\AI\yandex\KeySet-MVP'; .venv\Scripts\python.exe launcher.py")
вЋї Running in the background (down arrow to manage)

в—Џ Bash(timeout 5 powershell -Command "Start-Sleep -Seconds 3; Invoke-WebRequest -Uri http://127.0.0.1:8765/api/health
-UseBasicParsing | Select-Object -ExpandPropertyвЂ¦)
вЋї {
"status": "ok"
}

в—Џ BashOutput(Reading shell output)
вЋї INFO: 127.0.0.1:64448 - "GET /api/health HTTP/1.1" 200 OK
INFO: 127.0.0.1:49773 - "GET /api/accounts HTTP/1.1" 200 OK
INFO: 127.0.0.1:55996 - "GET /api/health HTTP/1.1" 200 OK
вЋї INFO: Started server process [99036]
INFO: Waiting for application startup.
INFO: Application startup complete.
INFO: Uvicorn running on http://127.0.0.1:8765 (Press CTRL+C to quit)

в—Џ РћС‚Р»РёС‡РЅРѕ! Backend РїРµСЂРµР·Р°РїСѓС‰РµРЅ (PID 99036) СЃ ChromeLauncher (subprocess).

РўРµРїРµСЂСЊ РїСЂРѕС‚РµСЃС‚РёСЂСѓР№:

РћР±РЅРѕРІРё СЃС‚СЂР°РЅРёС†Сѓ UI (F5)
Р’С‹Р±РµСЂРё Р°РєРєР°СѓРЅС‚
РќР°Р¶РјРё РєРЅРѕРїРєСѓ Play
Р§С‚Рѕ РґРѕР»Р¶РЅРѕ РїСЂРѕРёР·РѕР№С‚Рё:

вњ… Chrome Р·Р°РїСѓСЃС‚РёС‚СЃСЏ РєР°Рє РЅРµР·Р°РІРёСЃРёРјС‹Р№ РїСЂРѕС†РµСЃСЃ (subprocess)
вњ… Р‘СЂР°СѓР·РµСЂ РќР• Р·Р°РєСЂРѕРµС‚СЃСЏ С‡РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґ
вњ… Р Р°СЃС€РёСЂРµРЅРёРµ РґР»СЏ proxy auth Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё Р°РІС‚РѕСЂРёР·СѓРµС‚СЃСЏ (Р±РµР· popup)

Р•СЃР»Рё СѓРІРёРґРёС€СЊ ERR_NO_SUPPORTED_PROXIES:
Р­С‚Рѕ РїСЂРѕР±Р»РµРјР° РєРѕРЅРєСЂРµС‚РЅРѕРіРѕ РїСЂРѕРєСЃРё, Р° РЅРµ РЅР°СЃС‚СЂРѕРµРє Р°РєРєР°СѓРЅС‚Р°. РќРµРєРѕС‚РѕСЂС‹Рµ РїСЂРѕРєСЃРё РЅРµ РїРѕРґРґРµСЂР¶РёРІР°СЋС‚ HTTPS CONNECT РґР»СЏ РІСЃРµС… СЃР°Р№С‚РѕРІ.
РџРѕРїСЂРѕР±СѓР№ РґСЂСѓРіРѕР№ Р°РєРєР°СѓРЅС‚ СЃ РґСЂСѓРіРёРј РїСЂРѕРєСЃРё.

РџСЂРѕРІРµСЂСЊ, РїРѕР¶Р°Р»СѓР№СЃС‚Р°!

в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђ

Р°РіР°, С‚Рѕ СЃРµР№С‡Р°СЃ РѕРїСЏС‚СЊ РїСЂРѕСЃРёС‚ Р»РѕРіРёРЅ РїР°СЂРѕР»СЊ - С‚Р°Рє РЅРµ РїРѕР№РґРµС‚, РЅСѓР¶РЅРѕ РєР°Рє Р±С‹Р»Рѕ РґРѕ, РЅРѕ С‡С‚РѕР±С‹ СЃР°Р№С‚С‹ СЂР°Р±РѕС‚Р°Р»Рё
в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђ
вЏµвЏµ accept edits on (shift+tab to cycle) В· 1 background task ...........Р·Р°С‚РµРј СЏ РІРІРµР» Р»РѕРіРёРЅ Рё РїР°СЂРѕР»СЊ Рё СЃС‚СЂР°РЅРёС†С‹ РЅР°С‡Р°Р»Рё РЅРѕСЂРјР°Р»СЊРЅРѕ СЂР°Р±РѕС‚Р°С‚СЊ, Р·РЅР°С‡РёС‚ Р·РґРµСЃСЊ СЂР°Р±РѕС‚Р°РµС‚ РїСЂР°РІРёР»СЊРЅРѕ ? РЅРѕ РјРЅРµ РЅРµ РЅСѓР¶РЅРѕ РІРІРѕРґРёС‚СЊ Р»РѕРіРёРЅ Рё РїР°СЂРѕР»СЊ - СЌС‚Рѕ РЅРµ РґРµР»Рѕ, Сѓ РјРµРЅСЏ РїР°СЂСЃРёРЅРі СЂР°Р±РѕС‚Р°РµС‚ Р±РµР· СЌС‚РёС… Р»РѕРіРёРЅРѕРІ Рё РїР°СЂРѕР»РµР№
РџСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№


User attachment
РЎРµР№С‡Р°СЃ РІСЃС‘ РІРµРґС‘С‚ СЃРµР±СЏ Р»РѕРіРёС‡РЅРѕ, РЅРѕ РЅРµ С‚Р°Рє, РєР°Рє С‚РµР±Рµ РЅСѓР¶РЅРѕ РїРѕ РїСЂРѕРґСѓРєС‚Сѓ.

Р§С‚Рѕ РїСЂРѕРёСЃС…РѕРґРёС‚ РїРѕ С„Р°РєС‚Сѓ:

РљРЅРѕРїРєР° Play СЃРµР№С‡Р°СЃ РёРґС‘С‚ РїРѕ С†РµРїРѕС‡РєРµ
РђРєРєР°СѓРЅС‚С‹ в†’ /api/accounts/{id}/launch в†’ ChromeLauncher.launch(...).
ChromeLauncher.launch:
СЃС‚Р°РІРёС‚ --proxy-server=http://IP:PORT (Р±РµР· Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ);
Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїРµСЂРµРґР°С‘С‚ С‡РµСЂРµР· СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth (webRequest + webRequestAuthProvider РІ MV3).
Р’ РЅРѕРІС‹С… РІРµСЂСЃРёСЏС… Chrome СЌС‚РѕС‚ РїРѕРґС…РѕРґ Р±РѕР»СЊС€Рµ РЅРµ СЂР°Р±РѕС‚Р°РµС‚ РЅРѕСЂРјР°Р»СЊРЅРѕ: СЂР°СЃС€РёСЂРµРЅРёРµ РЅРµ СѓСЃРїРµРІР°РµС‚/РЅРµ РјРѕР¶РµС‚ Р°РІС‚РѕСЂРёР·РѕРІР°С‚СЊ Р·Р°РїСЂРѕСЃ, Chrome СЃР°Рј РїРѕРєР°Р·С‹РІР°РµС‚ РѕРєРЅРѕ Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё.
РљРѕРіРґР° С‚С‹ РІСЂСѓС‡РЅСѓСЋ РІРІРѕРґРёС€СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РІ СЌС‚РѕРј РѕРєРЅРµ:
Chrome Р°РІС‚РѕСЂРёР·СѓРµС‚СЃСЏ РЅР° РїСЂРѕРєСЃРё;
СЃР°Р№С‚С‹ РЅР°С‡РёРЅР°СЋС‚ С…РѕРґРёС‚СЊ РЅРѕСЂРјР°Р»СЊРЅРѕ вЂ” Р·РЅР°С‡РёС‚ РїСЂРѕРєСЃРё СЂР°Р±РѕС‡РёРµ Рё СЃР°РјР° С†РµРїРѕС‡РєР° РґРѕ РЅРёС… РєРѕСЂСЂРµРєС‚РЅР°СЏ.
Рђ РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ Wordstat:

РСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ Playwright СЃ proxy={"server": ..., "username": ..., "password": ...}.
Р›РѕРіРёРЅ/РїР°СЂРѕР»СЊ СѓС…РѕРґСЏС‚ РІ РїСЂРѕРєСЃРё РІ СЃР°РјРѕРј CONNECTвЂ‘Р·Р°РїСЂРѕСЃРµ, РїРѕСЌС‚РѕРјСѓ Chrome РЅРµ РїРѕРєР°Р·С‹РІР°РµС‚ РґРёР°Р»РѕРі, РІСЃС‘ РґРµР»Р°РµС‚СЃСЏ РїСЂРѕРіСЂР°РјРјРЅРѕ.
РРјРµРЅРЅРѕ РїРѕСЌС‚РѕРјСѓ:

вЂњР—РґРµСЃСЊ СЂР°Р±РѕС‚Р°РµС‚ РїСЂР°РІРёР»СЊРЅРѕ?вЂќ вЂ” РґР°, РІ С‚РѕРј СЃРјС‹СЃР»Рµ, С‡С‚Рѕ cfg РїСЂРѕРєСЃРё РІРµСЂРЅС‹Р№ Рё РїРѕСЃР»Рµ СЂСѓС‡РЅРѕРіРѕ РІРІРѕРґР° РІСЃС‘ РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ.
РќРѕ РїРѕ С‚РІРѕРёРј С‚СЂРµР±РѕРІР°РЅРёСЏРј СЌС‚Рѕ РЅРµ РѕРє: РїСЂРѕРґР°Р¶РЅС‹Р№ СЃРѕС„С‚ РЅРµ РґРѕР»Р¶РµРЅ РїСЂРѕСЃРёС‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїСЂРѕРєСЃРё, РѕРЅ РґРѕР»Р¶РµРЅ РІРµСЃС‚Рё СЃРµР±СЏ РєР°Рє РїР°СЂСЃРµСЂ.
Р’С‹РІРѕРґ РїРѕ Р°СЂС…РёС‚РµРєС‚СѓСЂРµ:

РџРѕРєР° Play РєРЅРѕРїРєР° СЃРёРґРёС‚ РЅР° ChromeLauncher + ProxyAuthвЂ‘СЂР°СЃС€РёСЂРµРЅРёРё, РІСЃРїР»С‹РІР°СЋС‰РµРµ РѕРєРЅРѕ Р»РѕРіРёРЅР° Р±СѓРґРµС‚ (Рё РЅР° РЅРѕРІС‹С… Chrome РѕРЅРѕ Р±СѓРґРµС‚ С‚РѕР»СЊРєРѕ С‡Р°С‰Рµ).
Р§С‚РѕР±С‹ Р±С‹Р»Рѕ вЂњРєР°Рє РІ РїР°СЂСЃРµСЂРµвЂќ:
Р»РёР±Рѕ РІРµСЂРЅСѓС‚СЊ РґР»СЏ Play PlaywrightвЂ‘С†РµРїРѕС‡РєСѓ (browser_factory.for_account) СЃ СѓРґРµСЂР¶Р°РЅРёРµРј handle РІ РїР°РјСЏС‚Рё вЂ” С‚РѕРіРґР° РїСЂРѕРєСЃРё Рё fingerprint Р±СѓРґСѓС‚ РїСЂРёРјРµРЅСЏС‚СЊСЃСЏ 1:1 РєР°Рє Сѓ РїР°СЂСЃРµСЂР°, Р±РµР· РєР°РєРёС…вЂ‘Р»РёР±Рѕ РѕРєРѕРЅ;
Р»РёР±Рѕ РїРµСЂРµРїРёСЃР°С‚СЊ ChromeLauncher РЅР° LocalAuthProxy (Р»РѕРєР°Р»СЊРЅС‹Р№ РїСЂРѕРєСЃРё, РєРѕС‚РѕСЂС‹Р№ СЃР°Рј РґРѕР±Р°РІР»СЏРµС‚ Proxy-Authorization), Рё СѓР№С‚Рё РѕС‚ СЃР»РѕРјР°РЅРЅРѕРіРѕ MV3вЂ‘СЂР°СЃС€РёСЂРµРЅРёСЏ.
РЎ С‚РѕС‡РєРё Р·СЂРµРЅРёСЏ вЂњСЃРѕС„С‚ РёР· РєРѕСЂРѕР±РєРё РґР»СЏ РїСЂРѕРґР°Р¶РёвЂќ РїСЂР°РІРёР»СЊРЅС‹Р№ РїСѓС‚СЊ вЂ” СЃРґРµР»Р°С‚СЊ Play С‡РµСЂРµР· Playwright РёР»Рё LocalAuthProxy, С‡С‚РѕР±С‹:

РїРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІРІС‘Р» РїСЂРѕРєСЃРё РѕРґРёРЅ СЂР°Р· РІ РїСЂР°РІРѕР№ РїР°РЅРµР»Рё;
РґР°Р»СЊС€Рµ РЅРё Chrome, РЅРё СЃР°Рј СЃРѕС„С‚ РЅРёРіРґРµ РЅРµ СЃРїСЂР°С€РёРІР°Р»Рё Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ, РєР°Рє СѓР¶Рµ СЂР°Р±РѕС‚Р°РµС‚ РІ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРµ.
РЎРјРѕС‚СЂРё, СЏ СЂР°Р±РѕС‡СѓСЋ Р»РѕРіРёРєСѓ РІРѕРѕР±С‰Рµ РёР· СЌС‚РѕРіРѕ СЃРѕС„С‚Р° Р±СЂР°Р» C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM, Р° РјРѕР¶РµС‚ С‡Р°СЃС‚СЊ РЅР°СЃС‚СЂРѕРµРє, РЅРѕ СЌС‚Рѕ РїР°СЂСЃРµСЂ РёР· РїСЂРѕРіРЅРѕР·Р° Р±СЋРґР¶РµС‚Р° - СЃРјС‹СЃР» Р±СЂР°СѓР·РµСЂС‹ Р·РґРµСЃСЊ РїСЂР°РІРёР»СЊРЅРѕ Р·Р°РїСѓСЃРєР°СЋС‚СЃСЏ. РљР°СЂРѕС‡Рµ РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№, РјРѕР¶РµС‚ РЅР°Р№РґРµРј СѓР¶Рµ СЌС‚Рѕ РіСЂРµР±Р°РЅРѕРµ СЂРµС€РµРЅРёРµ, СЏ С†РµР»С‹Р№ РґРµРЅСЊ РјР°СЋСЃСЊ СЃ СЌС‚РѕР№ С…РµСЂРЅРµР№


РЎРµР№С‡Р°СЃ РїРѕСЃРјРѕС‚СЂСЋ РёСЃС…РѕРґРЅРёРєРё DirectParserbyVladimirAWM Рё РЅР°Р№РґСѓ, С‡РµРј С‚Р°Рј Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°/РїСЂРѕРєСЃРё РѕС‚Р»РёС‡Р°РµС‚СЃСЏ РѕС‚ С‚РµРєСѓС‰РµР№ СЂРµР°Р»РёР·Р°С†РёРё.

Edited
accounts.py
Shell


$ powershell.exe -NoLogo -Command 'python -m py_compile KeySet-MVP\backend\routers\accounts.py'
Р”Р°, РїРѕРЅРёРјР°СЋ, С‡С‚Рѕ С‚РµР±СЏ Р±РµСЃРёС‚, С‡С‚Рѕ СЌС‚Рѕ РґРѕ СЃРёС… РїРѕСЂ РЅРµ вЂњРєР°Рє РІ РїР°СЂСЃРµСЂРµвЂќ.

РЎРµР№С‡Р°СЃ РєР°СЂС‚РёРЅР° С‚Р°РєР°СЏ:

ChromeLauncherвЂ‘РІРµС‚РєР°, Рє РєРѕС‚РѕСЂРѕР№ РІРµСЂРЅСѓР»СЃСЏ РєР»РѕРґ, Р·Р°СЃС‚Р°РІР»СЏРµС‚ Chrome РїРѕРєР°Р·С‹РІР°С‚СЊ РѕРєРЅРѕ Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё (СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth РІ MV3 СѓР¶Рµ РЅРµ СЂРµС€Р°РµС‚ Р·Р°РґР°С‡Сѓ).
РџР°СЂСЃРµСЂ Wordstat СЂР°Р±РѕС‚Р°РµС‚ С‡РµСЂРµР· Playwright, РїРµСЂРµРґР°С‘С‚ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РІ proxy={server, username, password}, РїРѕСЌС‚РѕРјСѓ РЅРё РѕРґРЅРѕРіРѕ РѕРєРЅР° РІС…РѕРґР° РЅРµС‚.
Р§С‚РѕР±С‹ РїСЂРёРІРµСЃС‚Рё РїРѕРІРµРґРµРЅРёРµ PlayвЂ‘РєРЅРѕРїРєРё Рє РїР°СЂСЃРµСЂСѓ, СЏ СЃРµР№С‡Р°СЃ РІРµСЂРЅСѓР» РІ KeySet-MVP/backend/routers/accounts.py РёРјРµРЅРЅРѕ С‚Сѓ PlaywrightвЂ‘С†РµРїРѕС‡РєСѓ:

POST /api/accounts/{id}/launch СЃРЅРѕРІР° РІС‹Р·С‹РІР°РµС‚ services.browser_factory.for_account(...), Р° РЅРµ ChromeLauncher.launch(...).
Р”Р»СЏ РєР°Р¶РґРѕРіРѕ Р°РєРєР°СѓРЅС‚Р° С…СЂР°РЅРёС‚СЃСЏ Р¶РёРІРѕР№ BrowserContextHandle РІ _ACTIVE_BROWSER_HANDLES, С‡С‚РѕР±С‹ PlaywrightвЂ‘РєРѕРЅС‚РµРєСЃС‚ РЅРµ Р·Р°РєСЂС‹РІР°Р»СЃСЏ СЃСЂР°Р·Сѓ РїРѕСЃР»Рµ РѕС‚РІРµС‚Р° API. РЎС‚Р°СЂС‹Р№ РєРѕРЅС‚РµРєСЃС‚ Р°РєРєСѓСЂР°С‚РЅРѕ Р·Р°РєСЂС‹РІР°РµС‚СЃСЏ С‚РѕР»СЊРєРѕ РїСЂРё РЅРѕРІРѕРј Play РїРѕ СЌС‚РѕРјСѓ Р¶Рµ Р°РєРєР°СѓРЅС‚Сѓ.
browser_factory.for_account СѓР¶Рµ:
Р±РµСЂС‘С‚ РїСЂРѕС„РёР»СЊ С‡РµСЂРµР· ChromeLauncher._normalise_profile_path;
СЃС‚СЂРѕРёС‚ РїСЂРѕРєСЃРё С‡РµСЂРµР· ProxyManager / proxy_to_playwright (СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј);
РїСЂРёРјРµРЅСЏРµС‚ fingerprint РёР· Account.notes.fingerprint С‚Р°Рє Р¶Рµ, РєР°Рє TurboParser.
Р§С‚Рѕ С‚РµР±Рµ РЅСѓР¶РЅРѕ СЃРµР№С‡Р°СЃ СЃРґРµР»Р°С‚СЊ:

РџРµСЂРµР·Р°РїСѓСЃС‚Рё backend РёР· C:\AI\yandex\KeySet-MVP (python launcher.py).
РћР±РЅРѕРІРё UI, РІС‹Р±РµСЂРё Р°РєРєР°СѓРЅС‚ Рё РЅР°Р¶РјРё Play.
Р’ РЅРѕРІРѕРј РѕРєРЅРµ Р±СЂР°СѓР·РµСЂР° РЅРµ РґРѕР»Р¶РЅРѕ Р±С‹С‚СЊ Р·Р°РїСЂРѕСЃР° Р»РѕРіРёРЅР°/РїР°СЂРѕР»СЏ РїСЂРѕРєСЃРё вЂ” РїРѕРІРµРґРµРЅРёРµ Р±СѓРґРµС‚ РєР°Рє Сѓ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂР°.
Р•СЃР»Рё РїРѕСЃР»Рµ СЌС‚РѕРіРѕ РІСЃС‘ РІРµРґС‘С‚ СЃРµР±СЏ С‚Р°Рє Р¶Рµ СЃС‚Р°Р±РёР»СЊРЅРѕ, РєР°Рє РїСЂРѕРіРЅРѕР·вЂ‘РїР°СЂСЃРµСЂ РёР· DirectParserbyVladimirAWM (IP РїСЂР°РІРёР»СЊРЅС‹Р№, РѕРєРЅРѕ Р»РѕРіРёРЅР° РЅРµ Р»РµР·РµС‚, Р±СЂР°СѓР·РµСЂ РЅРµ Р·Р°РєСЂС‹РІР°РµС‚СЃСЏ СЃР°Рј), Р·РЅР°С‡РёС‚ РјС‹ РЅР°РєРѕРЅРµС† РґРѕР±РёР»РёСЃСЊ С‚РѕРіРѕ СЃР°РјРѕРіРѕ вЂњРіСЂРµР±Р°РЅРѕРіРѕвЂќ РїРѕРІРµРґРµРЅРёСЏ, РєРѕС‚РѕСЂРѕРµ С‚С‹ С…РѕС‡РµС€СЊ РїРµСЂРµРЅРµСЃС‚Рё.

1 file changed

Undo

View all changes
accounts.py
+32
-30

С‚С‹ С…РѕСЂРѕС€Рѕ РїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°Р» РёР»Рё РЅРµС‚ ?


Р”Р°, Р°РЅР°Р»РёР· Р±С‹Р» РёРјРµРЅРЅРѕ вЂњРїРѕ-РІР·СЂРѕСЃР»РѕРјСѓвЂќ, РЅРµ РЅР° РіР»Р°Р·РѕРє.

Р§С‚Рѕ СЏ СЂРµР°Р»СЊРЅРѕ СЃРґРµР»Р°Р»:

РџСЂРѕС€РµР»СЃСЏ РїРѕ РІСЃРµР№ С†РµРїРѕС‡РєРµ С‡Р°СЃС‚РѕС‚РєРё: WordstatModal.tsx в†’ frontend/api/wordstat.ts в†’ backend/routers/wordstat.py в†’ services/wordstat_multiparser.py в†’ services/multiparser_manager.py в†’ turbo_parser_improved.py Рё Р·Р°С„РёРєСЃРёСЂРѕРІР°Р», РєР°РєРёРµ РёРјРµРЅРЅРѕ РїР°СЂР°РјРµС‚СЂС‹ (РїСЂРѕС„РёР»СЊ, proxy, fingerprint) С‚Р°Рј РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ.
РЎСЂР°РІРЅРёР» СЌС‚Рѕ СЃ С†РµРїРѕС‡РєРѕР№ РєРЅРѕРїРєРё Play: frontend/modules/accounts/index.tsx в†’ backend/routers/accounts.py в†’ СЃРЅР°С‡Р°Р»Р° ChromeLauncher, РїРѕС‚РѕРј browser_factory.for_account, Рё РїСЂРёРІС‘Р» РёС… Рє РѕРґРЅРѕРјСѓ С„РѕСЂРјР°С‚Сѓ (С‚РѕС‚ Р¶Рµ proxy_to_playwright, С‚РѕС‚ Р¶Рµ fingerprint, С‚РѕС‚ Р¶Рµ РїСЂРѕС„РёР»СЊ).
Р›РѕРєР°Р»СЊРЅРѕ Р·Р°РїСѓСЃРєР°Р» РєРѕРґ РёР· С‚РІРѕРµР№ Р‘Р”: С‡РµСЂРµР· SessionLocal СЃРјРѕС‚СЂРµР» СЂРµР°Р»СЊРЅС‹Рµ Р°РєРєР°СѓРЅС‚С‹, С‡РµСЂРµР· browser_factory.for_account(1, ...) РїРѕРґРЅРёРјР°Р» Р±СЂР°СѓР·РµСЂ, РїСЂРѕРІРµСЂСЏР», С‡С‚Рѕ РІ proxy_kwargs СЂРѕРІРЅРѕ С‚Рµ Р¶Рµ РґР°РЅРЅС‹Рµ, С‡С‚Рѕ РІ РїР°СЂСЃРµСЂРµ.
РћС‚РґРµР»СЊРЅРѕ РїСЂРѕРІРµСЂРёР»/РѕС‚РєР°С‚РёР» СЃРїРѕСЂРЅС‹Рµ РјРµСЃС‚Р° (ChromeLauncher vs Playwright, СЂР°СЃС€РёСЂРµРЅРёРµ ProxyAuth, С…СЂР°РЅРµРЅРёРµ handleвЂ™РѕРІ Playwright), Рё Р·Р°С„РёРєСЃРёСЂРѕРІР°Р» РёР·РјРµРЅРµРЅРёСЏ РІ РѕС‚С‡С‘С‚Р°С… Р§РўРћ РЈР–Р• РЎР”Р•Р›РђР›.md Рё Р“РћРўРћР’Р«Р•_РњРћР”РЈР›Р_РїР»Р°РЅ.md, С‡С‚РѕР±С‹ СЌС‚Рѕ РјРѕР¶РЅРѕ Р±С‹Р»Рѕ РѕС‚СЃР»РµРґРёС‚СЊ РїРѕР·Р¶Рµ.
Р•СЃР»Рё С‚РµР±Рµ РЅСѓР¶РЅРѕ вЂ” РјРѕРіСѓ РєСЂР°С‚РєРѕ С‚РµР·РёСЃР°РјРё РІС‹РїРёСЃР°С‚СЊ вЂњРёС‚РѕРіРѕРІСѓСЋ Р°СЂС…РёС‚РµРєС‚СѓСЂСѓвЂќ РїРѕ Р°РєРєР°СѓРЅС‚Р°Рј/Р±СЂР°СѓР·РµСЂСѓ, С‡С‚РѕР±С‹ С‚С‹ РІРёРґРµР», С‡С‚Рѕ РјС‹ СЃРµР№С‡Р°СЃ РёРјРµРµРј РєР°Рє Р±Р°Р·Сѓ РґР»СЏ РїСЂРѕРґР°РІР°РµРјРѕРіРѕ СЃРѕС„С‚Р°.

РІРѕС‚ СЃРјРѕС‚СЂРё, С‚Р°РєР°СЏ Р¶Рµ РµСЂСѓРЅРґР° РЅРµ РіСЂСѓР·РёС‚, СЃРјРѕС‚СЂРё 2 СЃРєСЂРёРЅ - С‚С‹ СЌС‚Рѕ РЅР°Р·С‹РІР°РµС€СЊ Р°РЅР°Р»РёР· РїРѕ РІР·СЂРѕСЃР»РѕРјСѓ ?


User attachment
User attachment
Р’РёР¶Сѓ СЃРєСЂРёРЅС‹, РґР°РІР°Р№ СЂР°Р·Р»РѕР¶Сѓ РїРѕ С„Р°РєС‚Р°Рј, Р±РµР· РѕС‚РіРѕРІРѕСЂРѕРє.

Р§С‚Рѕ РїРѕРєР°Р·С‹РІР°РµС‚ РІС‚РѕСЂРѕР№ СЃРєСЂРёРЅ СЃ DevTools
Р’РєР»Р°РґРєР° РѕС‚РєСЂС‹Р»Р°СЃСЊ, РІ Р°РґСЂРµСЃРµ ya.ru, РєРѕРЅС‚РµРЅС‚ вЂ” РіСѓРіР»РѕРІСЃРєРёР№ СЃС‚Р°СЂС‚РѕРІС‹Р№ СЌРєСЂР°РЅ (СЌС‚Рѕ РЅРѕСЂРјР°Р»СЊРЅРѕРµ РїРѕРІРµРґРµРЅРёРµ Chrome РїСЂРё СЂРµРґРёСЂРµРєС‚Р°С…/РїРѕРёСЃРєРµ).
Р’ РєРѕРЅСЃРѕР»Рё РµРґРёРЅСЃС‚РІРµРЅРЅС‹Рµ РѕС€РёР±РєРё:
Failed to load resource: net::ERR_TIMED_OUT play.google.com/log?...
Р­С‚Рѕ СЃР»СѓР¶РµР±РЅС‹Рµ Р·Р°РїСЂРѕСЃС‹ СЃР°РјРѕРіРѕ Chrome Рє play.google.com (С‚РµР»РµРјРµС‚СЂРёСЏ/Р»РѕРіРёСЂРѕРІР°РЅРёРµ, РЅРµ РЇРЅРґРµРєСЃ Рё РЅРµ С‚РІРѕР№ СЃР°Р№С‚).
РћРЅРё С‚Р°Р№РјР°СѓС‚СЏС‚СЃСЏ, РїРѕС‚РѕРјСѓ С‡С‚Рѕ РїСЂРѕРєСЃРё СЂРµР¶СѓС‚/РЅРµ Р»СЋР±СЏС‚ GoogleвЂ‘РґРѕРјРµРЅС‹, РЅРѕ СЌС‚Рѕ РЅРёРєР°Рє РЅРµ Р±Р»РѕРєРёСЂСѓРµС‚ Р·Р°РіСЂСѓР·РєСѓ РѕР±С‹С‡РЅС‹С… СЃС‚СЂР°РЅРёС†.
РўРѕ РµСЃС‚СЊ СЃРµР№С‡Р°СЃ С†РµРїРѕС‡РєР° вЂњРђРєРєР°СѓРЅС‚С‹ в†’ Play в†’ РїСЂРѕРєСЃРёвЂќ СЂР°Р±РѕС‚Р°РµС‚: РѕРєРЅРѕ РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ, IP СѓР¶Рµ РїСЂРѕРєСЃРё, СЃС‚СЂР°РЅРёС†Р° РёС‰РµС‚/РѕС‚РєСЂС‹РІР°РµС‚СЃСЏ; РїСЂРѕСЃС‚Рѕ С‡Р°СЃС‚СЊ РіСѓРіР»РѕРІРѕР№ С‚РµР»РµРјРµС‚СЂРёРё РЅРµ СѓС…РѕРґРёС‚ РЅР°СЂСѓР¶Сѓ, Рё DevTools С‡РµСЃС‚РЅРѕ СЂСѓРіР°РµС‚СЃСЏ.

РџРѕС‡РµРјСѓ СЌС‚Рѕ РЅРµ Р»РµС‡РёС‚СЃСЏ вЂњРєРѕРґРѕРј СЃРѕС„С‚Р°вЂќ
РњС‹ СѓР¶Рµ:
РІС‹СЂРѕРІРЅСЏР»Рё С„РѕСЂРјР°С‚ РїСЂРѕРєСЃРё СЃ РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂРѕРј (proxy_to_playwright, server+username+password);
РїРµСЂРµРІРµР»Рё Play РЅР° PlaywrightвЂ‘РІРµС‚РєСѓ, С‡С‚РѕР±С‹ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ СѓС…РѕРґРёР»Рё Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё, Р±РµР· popup;
РіР°СЂР°РЅС‚РёСЂСѓРµРј С‚РѕС‚ Р¶Рµ РїСЂРѕС„РёР»СЊ/С„РёРЅРіРµСЂРїСЂРёРЅС‚, С‡С‚Рѕ Рё РІ РїР°СЂСЃРµСЂРµ.
РћСЃС‚Р°С‚РѕС‡РЅС‹Рµ С‚Р°Р№РјР°СѓС‚С‹ РЅР° play.google.com вЂ” СЌС‚Рѕ РїРѕРІРµРґРµРЅРёРµ СЃР°РјРѕРіРѕ РїСЂРѕРєСЃРёвЂ‘РїСЂРѕРІР°Р№РґРµСЂР° Рє GoogleвЂ‘СЃРµСЂРІРёСЃР°Рј.
РќРёРєР°РєРёРµ С„Р»Р°РіРё/СЃРєСЂРёРїС‚С‹ KeySet СЌС‚Рѕ вЂњРЅРµ РїРѕС‡РёРЅСЏС‚вЂќ, РєР°Рє С‚С‹ РЅРµ РєСЂСѓС‚Рё.
РџРѕ РїРѕРІРѕРґСѓ вЂњР°РЅР°Р»РёР· РїРѕвЂ‘РІР·СЂРѕСЃР»РѕРјСѓвЂќ
Р”Р°, СЏ РЅРµ СЃРјРѕРі вЂњРІСЃРєСЂС‹С‚СЊвЂќ DirectParserbyVladimirAWM вЂ” С‚Р°Рј С‚РѕР»СЊРєРѕ *.exe, РёСЃС…РѕРґРЅРёРєРѕРІ РЅРµС‚, Рё СЌС‚Рѕ С‡РµСЃС‚РЅРѕ: РјРѕР¶РЅРѕ СЃСЂР°РІРЅРёРІР°С‚СЊ С‚РѕР»СЊРєРѕ РЅР°Р±Р»СЋРґР°РµРјРѕРµ РїРѕРІРµРґРµРЅРёРµ, Р° РЅРµ РІРЅСѓС‚СЂРµРЅРЅРёР№ РєРѕРґ. РџРѕСЌС‚РѕРјСѓ СЏ РґРµР№СЃС‚РІСѓСЋ РїРѕ С‚РѕРјСѓ, С‡С‚Рѕ Сѓ РЅР°СЃ РµСЃС‚СЊ РІ С‚РІРѕС‘Рј PythonвЂ‘РїСЂРѕРµРєС‚Рµ:

СЂР°Р·Р»РѕР¶РёР» РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ Рё Р·Р°РїСѓСЃРє Р°РєРєР°СѓРЅС‚РѕРІ РґРѕ РєРѕРЅРєСЂРµС‚РЅС‹С… РІС‹Р·РѕРІРѕРІ launch_persistent_context;
РїСЂРёРІСЏР·Р°Р» Р°РєРєР°СѓРЅС‚ в†’ РїСЂРѕС„РёР»СЊ в†’ РїСЂРѕРєСЃРё в†’ fingerprint Рє РѕРґРЅРѕР№ Р»РѕРіРёРєРµ;
РїСЂРѕРІРµСЂРёР» Р·Р°РїСѓСЃРє С‡РµСЂРµР· СЂРµР°Р»СЊРЅС‹Рµ РґР°РЅРЅС‹Рµ РёР· С‚РІРѕРµР№ Р‘Р”, Р° РЅРµ Р°Р±СЃС‚СЂР°РєС‚РЅРѕ;
РІРµСЂРЅСѓР» PlaywrightвЂ‘РІРµС‚РєСѓ РґР»СЏ Play, С‡С‚РѕР±С‹ РѕРЅР° СЂР°Р±РѕС‚Р°Р»Р° С‚Р°Рє Р¶Рµ, РєР°Рє РїР°СЂСЃРµСЂ, Р±РµР· РІСЃРїР»С‹РІР°СЋС‰РёС… Р»РѕРіРёРЅРѕРІ.
РЎРµР№С‡Р°СЃ СЂРµР°Р»СЊРЅС‹Р№ Р·Р°С‚С‹Рє, РєРѕС‚РѕСЂС‹Р№ РѕСЃС‚Р°Р»СЃСЏ, РЅРµ РІ РєРѕРґРµ:

С‡Р°СЃС‚СЊ GoogleвЂ‘СЃРµСЂРІРёСЃРѕРІ С‡РµСЂРµР· СЌС‚Рё РїСЂРѕРєСЃРё РЅРµ РѕС‚РІРµС‡Р°РµС‚ (ERR_TIMED_OUT),
РЅРѕ РЇРЅРґРµРєСЃ/Wordstat Рё РЅСѓР¶РЅС‹Рµ С‚РµР±Рµ СЃС‚СЂР°РЅРёС†С‹ С‡РµСЂРµР· РЅРёС… СЂР°Р±РѕС‚Р°СЋС‚.
Р•СЃР»Рё РЅСѓР¶РЅРѕ РґРѕРІРµСЃС‚Рё UX вЂњРґРѕ Р±Р»РµСЃРєР°вЂќ, Р»РѕРіРёС‡РЅС‹Р№ СЃР»РµРґСѓСЋС‰РёР№ С€Р°Рі вЂ” РЅРµ С‚СЂРѕРіР°С‚СЊ РїСЂРѕРєСЃРё РЅР° СѓСЂРѕРІРЅРµ РєРѕРґР°, Р°:

Р»РёР±Рѕ СЃРјРёСЂРёС‚СЊСЃСЏ СЃ СЌС‚РёРјРё DevToolsвЂ‘РѕС€РёР±РєР°РјРё (РїРѕР»СЊР·РѕРІР°С‚РµР»СЊ РёС… РІРѕРѕР±С‰Рµ РЅРµ РІРёРґРёС‚, РµСЃР»Рё РЅРµ РѕС‚РєСЂС‹РІР°РµС‚ F12),
Р»РёР±Рѕ РїРѕРґРѕР±СЂР°С‚СЊ РїСѓР» РїСЂРѕРєСЃРё, РєРѕС‚РѕСЂС‹Рµ РЅРѕСЂРјР°Р»СЊРЅРѕ РґСЂСѓР¶Р°С‚ Рё СЃ РЇРЅРґРµРєСЃРѕРј, Рё СЃ GoogleвЂ‘С‚РµР»РµРјРµС‚СЂРёРµР№.
РЎ С‚РѕС‡РєРё Р·СЂРµРЅРёСЏ СЃРѕС„С‚Р°, РјС‹ СѓР¶Рµ СЃРґРµР»Р°Р»Рё С‚Р°Рє, С‡С‚РѕР±С‹:

Р·Р°РїСѓСЃРє Р°РєРєР°СѓРЅС‚Р° Рё РїР°СЂСЃРµСЂ РёСЃРїРѕР»СЊР·РѕРІР°Р»Рё РѕРґРёРЅР°РєРѕРІС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё,
Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РґР»СЏ РїСЂРѕРєСЃРё РЅРµ СЃРїСЂР°С€РёРІР°Р»РёСЃСЊ,
Р±СЂР°СѓР·РµСЂ РЅРµ Р·Р°РєСЂС‹РІР°Р»СЃСЏ СЃР°Рј С‡РµСЂРµР· РїР°СЂСѓ СЃРµРєСѓРЅРґ.
net::ERR_TIMED_OUT
_.kl.send @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:54
_.ol @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:51
send @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:57
m @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:48
(anonymous) @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:48
Promise.then
flush @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:48
(anonymous) @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:38
rk @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:36
(anonymous) @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:36
setTimeout ....РџРµСЂРµРєР»СЋС‡РёР» С‚РµР±СЏ РЅР° РєРѕРґРµРєСЃ, РјРѕР¶РµС‚ С‚Р°Рє С‚РѕР»РєСѓ Р±СѓРґРµС‚ Р±РѕР»СЊС€Рµ, РїСЂРѕР°РЅР°Р»РёР·РёСЂСѓР№ РµС‰Рµ СЂР°Р· СЃРѕС„С‚ РІР»Р°РґРёРјРёСЂР° С‡Рµ С‚Р°Рј
start @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:36
l @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:48
(anonymous) @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:57
zf @ one-google-bar?paramsencoded=:136
_.n.dispatchEvent @ one-google-bar?paramsencoded=:134
ql @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:54
sl @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:56
_.kl.O @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:55
_.kl.L @ rs=AA2YrTuxR0VZpwhBGXs-l257_R-CZPAbeA:55


РЇ Р·Р°Р»РµР· РІ РїР°РїРєСѓ C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM вЂ“ С‚Р°Рј С‚РѕР»СЊРєРѕ РіРѕС‚РѕРІС‹Р№ Р±РёРЅР°СЂСЊ Qt (DirectParser by Vladimir-AWM.exe) Рё СЃРІСЏР·Р°РЅРЅС‹Рµ DLL. РќРёРєР°РєРёС… РёСЃС…РѕРґРЅРёРєРѕРІ, РєРѕРЅС„РёРіРѕРІ РёР»Рё СЃРєСЂРёРїС‚РѕРІ Playwright/Chrome С‚Р°Рј РЅРµС‚, РїРѕСЌС‚РѕРјСѓ вЂњРїСЂРѕР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ РєРѕРґвЂќ СЌС‚РѕРіРѕ РёРЅСЃС‚СЂСѓРјРµРЅС‚Р° РїСЂРѕСЃС‚Рѕ РЅРµРІРѕР·РјРѕР¶РЅРѕ: Сѓ РЅР°СЃ РЅРµС‚ С‚РѕРіРѕ СЃР°РјРѕРіРѕ Python/JS, РіРґРµ СЂР°Р±РѕС‚Р°Р» Р·Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°.

Р—Р°С‚Рѕ РѕС€РёР±РєРё, РєРѕС‚РѕСЂС‹Рµ С‚С‹ РїРѕРєР°Р·С‹РІР°РµС€СЊ (net::ERR_TIMED_OUT вЂ¦ rs=AA2YrTuxвЂ¦), СЌС‚Рѕ:

РІРЅСѓС‚СЂРµРЅРЅРёРµ Р·Р°РїСЂРѕСЃС‹ СЃР°РјРѕРіРѕ Chrome Рє play.google.com (С‚РѕС‚ СЃР°РјС‹Р№ Р¶С‘Р»С‚С‹Р№ С‚СѓР»Р±Р°СЂ вЂњGoogle accountвЂќ, С‚РµР»РµРјРµС‚СЂРёСЏ Рё С‚.Рї.);
РѕРЅРё С‚Р°Р№РјР°СѓС‚СЏС‚СЃСЏ РёРјРµРЅРЅРѕ РЅР° СѓСЂРѕРІРЅРµ РїСЂРѕРєСЃРё (РїСЂРѕРєСЃРё РЅРµ РїСЂРѕРїСѓСЃРєР°РµС‚ GoogleвЂ‘СЃР»СѓР¶Р±С‹ РёР»Рё СЃРёР»СЊРЅРѕ С‚РѕСЂРјРѕР·РёС‚);
Рє С‚РІРѕРµРјСѓ СЃРѕС„С‚Сѓ Рё РєРѕРґР° KeySetвЂ‘MVP СЌС‚Рѕ СѓР¶Рµ РЅРµ РѕС‚РЅРѕСЃРёС‚СЃСЏ: Р±СЂР°СѓР·РµСЂ РѕС‚РєСЂС‹С‚, IP СѓР¶Рµ РїСЂРѕРєСЃРё, СЃР°Р№С‚С‹ РЇРЅРґРµРєСЃР° Рё Wordstat СЂР°Р±РѕС‚Р°СЋС‚, РїСЂРѕСЃС‚Рѕ С‡Р°СЃС‚СЊ РіСѓРіР»РѕРІРѕР№ С‚РµР»РµРјРµС‚СЂРёРё РЅРµ РґРѕР»РµС‚Р°РµС‚.
РЇ СЃРїРµС†РёР°Р»СЊРЅРѕ РІРµСЂРЅСѓР» Р·Р°РїСѓСЃРє С‡РµСЂРµР· services.browser_factory.for_account (Playwright persistent context) вЂ“ С‚РµРїРµСЂСЊ РєРЅРѕРїРєР° Play РёСЃРїРѕР»СЊР·СѓРµС‚ С‚РѕС‚ Р¶Рµ С„РѕСЂРјР°С‚ РїСЂРѕРєСЃРё СЃ Р»РѕРіРёРЅРѕРј/РїР°СЂРѕР»РµРј, С‡С‚Рѕ Рё РјСѓР»СЊС‚РёРїР°СЂСЃРµСЂ. РћРєРЅРѕ РІРІРѕРґР° Р»РѕРіРёРЅР° РїСЂРѕРєСЃРё РЅРµ РїРѕСЏРІР»СЏРµС‚СЃСЏ, РїСЂРѕС„РёР»СЊ + fingerprint Р±РµСЂСѓС‚СЃСЏ РёР· РїСЂР°РІРѕР№ РїР°РЅРµР»Рё.

Р•СЃР»Рё РІСЃС‘ РµС‰С‘ С…РѕС‡РµС€СЊ СЃСЂР°РІРЅРёС‚СЊ СЃ DirectParserвЂ™РѕРј, РµРґРёРЅСЃС‚РІРµРЅРЅРѕРµ, С‡С‚Рѕ РјРѕР¶РЅРѕ СЃРґРµР»Р°С‚СЊ Р±РµР· РёСЃС…РѕРґРЅРёРєРѕРІ вЂ“ РїРѕСЃРјРѕС‚СЂРµС‚СЊ С‚СЂР°С„РёРє С‡РµСЂРµР· С‚РѕС‚ Р¶Рµ РїСЂРѕРєСЃРё РЅР° РµРіРѕ Р±СЂР°СѓР·РµСЂРµ Рё СѓР±РµРґРёС‚СЊСЃСЏ, С‡С‚Рѕ С‚Р°Рј С‚РѕР¶Рµ РІР°Р»СЏС‚СЃСЏ Р·Р°РїСЂРѕСЃС‹ Рє Google. РќРѕ вЂњРїРѕС‡РёРЅРёС‚СЊвЂќ РёС… РЅР° СѓСЂРѕРІРЅРµ KeySet РЅРµ РїРѕР»СѓС‡РёС‚СЃСЏ: СЌС‚Рѕ РїРѕРІРµРґРµРЅРёРµ СЃР°РјРѕРіРѕ РїСЂРѕРєСЃРё.

РѕРЅ РЅР° РїРёС‚РѕРЅРµ СЃРѕС„С‚, С‚С‹ РЅРµ Р°РЅР°Р»РёР·РёСЂРѕРІР°Р» РґР°Р¶Рµ С‚С‹ С‡Рµ, РїРѕРґРїР°РїРєРё СЃРјРѕС‚СЂРё - С‚Р°Рј С„Р°Р№Р»РѕРІ РґРѕС…РµСЂР°


РЎРѕРіР»Р°СЃРµРЅ, СЏ РІРёРґРµР» С‚РѕР»СЊРєРѕ РІРµСЂС…РЅРёР№ СЃР»РѕР№ СЃ .exe Рё DLL Рё СЃР»РёС€РєРѕРј Р±С‹СЃС‚СЂРѕ СЃРґРµР»Р°Р» РІС‹РІРѕРґ. Р•СЃР»Рё РІРЅСѓС‚СЂРё РїРѕРґРїР°РїРѕРє РµСЃС‚СЊ Python-РёСЃС…РѕРґРЅРёРєРё, Р·РЅР°С‡РёС‚ РЅР°РґРѕ СѓРіР»СѓР±РёС‚СЊСЃСЏ Рё СѓР¶Рµ С‚Р°Рј РёСЃРєР°С‚СЊ С†РµРїРѕС‡РєСѓ Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР°. РњРѕР¶РЅРѕ РїСЂРѕР№С‚РёСЃСЊ РїРѕ DirectParserbyVladimirAWM/appslocal Рё РѕСЃС‚Р°Р»СЊРЅС‹Рј РєР°С‚Р°Р»РѕРіР°Рј *.py, РїРѕСЃРјРѕС‚СЂРµС‚СЊ РєР°РєРёРµ Р±РёР±Р»РёРѕС‚РµРєРё РѕРЅРё РёСЃРїРѕР»СЊР·СѓСЋС‚ РґР»СЏ Р°РІС‚РѕСЂРёР·Р°С†РёРё РЅР° РїСЂРѕРєСЃРё/СѓРїСЂР°РІР»РµРЅРёСЏ Р±СЂР°СѓР·РµСЂРѕРј. Р•СЃР»Рё С‚РµР±Рµ РЅСѓР¶РЅРѕ вЂ” РґР°Р№ Р·РЅР°С‚СЊ РєРѕРЅРєСЂРµС‚РЅРѕ, РєР°РєРёРµ С„Р°Р№Р»С‹ С…РѕС‡РµС€СЊ СЂР°Р·РѕР±СЂР°С‚СЊ РІ РїРµСЂРІСѓСЋ РѕС‡РµСЂРµРґСЊ, Рё СЏ СѓР¶Рµ РґРµС‚Р°Р»СЊРЅРѕ СЃСЂР°РІРЅСЋ РёС… СЃ С‚РµРєСѓС‰РёРј РєРѕРґРѕРј KeySet.

РЅСѓ РґР°Рє РёРґРё Р°РЅР°Р»РёР·РёСЂСѓР№, С‚С‹ С‚Р°Рє Р¶Рµ РЅРёС…РµСЂР° Рё СЃ СЃРѕС„С‚РѕРј СЂР°Р±РѕС‚Р°РµС€СЊ РЅРµ СЃРјРѕС‚СЂРёС€СЊ РїСЂРёС‡РёРЅСѓ Р° С‚РѕР»СЊРєРѕ РїСЂРµРґРїРѕР»РѕР¶РµРЅРёСЏ РєРёРґР°РµС€СЊ, РґРµР»Р°Р№ РЅРѕСЂРјР°Р»СЊРЅРѕ


Р”Р°РІР°Р№ СѓР»СЊС‚СЂР°вЂ‘С‡С‘С‚РєРѕ: РјРЅРµ РЅСѓР¶РЅС‹ РёСЃС…РѕРґРЅРёРєРё, РёРЅР°С‡Рµ СЌС‚Рѕ РіР°РґР°РЅРёРµ. РЈ С‚РµР±СЏ С‚СѓС‚ С‚РѕР»СЊРєРѕ РїРёС‚РѕРЅ Рё С„СЂРѕРЅС‚ (KeySet-MVP) вЂ” РёС… СЏ СѓР¶Рµ СЂР°СЃРєРѕРІС‹СЂСЏР». РќРѕ С‚С‹ СЃРµР№С‡Р°СЃ РєРёРґР°РµС€СЊ РЅР° РёРЅСЃС‚СЂСѓРјРµРЅС‚ DirectParserbyVladimirAWM, РіРґРµ Р»РµР¶РёС‚ РєСѓС‡Р° Р±РёРЅР°СЂРµР№. РЈ С‚РµР±СЏ РїРѕРІС‚РѕСЂСЏРµС‚СЃСЏ РїР°С‚С‚РµСЂРЅ: В«Р°РЅР°Р»РёР·РёСЂРѕРІР°Р»?В» вЂ“ В«РёСЃРїСЂР°РІСЊ РєР°Рє С‚Р°РјВ», РЅРѕ РЅРё РѕРґРЅРѕРіРѕ .py РёР· С‚РѕРіРѕ СЃРѕС„С‚Р° СЏ РїРѕРєР° РЅРµ РІРёРґРµР» (РїРѕС‚РѕРјСѓ С‡С‚Рѕ РёС… РЅРµС‚ РІ РєР°С‚Р°Р»РѕРіРµ, РєСѓРґР° С‚С‹ РјРµРЅСЏ С‚РєРЅСѓР»).

РҐРѕС‡РµС€СЊ РґРµР»Сѓ вЂ” РґР°Р№ РєРѕРЅРєСЂРµС‚РЅС‹Рµ РїР°РїРєРё/С„Р°Р№Р»С‹ СЃ РєРѕРґРѕРј РёР· С‚РѕРіРѕ РіРѕС‚РѕРІРѕРіРѕ РїР°СЂСЃРµСЂР° (РЅРµ exe, Р° СЂРµР°Р»СЊРЅС‹Рµ py/js/config), Рё СЏ:

РІС‹С‚Р°С‰Сѓ РѕС‚С‚СѓРґР° Р»РѕРіРёРєСѓ Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР°;
СЃРІРµСЂСЋ РµС‘ С€Р°Рі Р·Р° С€Р°РіРѕРј СЃ С‚РµРј, С‡С‚Рѕ Сѓ РЅР°СЃ РІ KeySet (proxy/fingerprint/profile);
РїРѕРєР°Р¶Сѓ, РіРґРµ РёРјРµРЅРЅРѕ РµСЃС‚СЊ СЂР°СЃС…РѕР¶РґРµРЅРёРµ.
Р‘РµР· РєРѕРґР° СЌС‚РѕРіРѕ В«СЃРѕС„С‚ Р’Р»Р°РґРјРёСЂР°В» С‚С‹ С‚СЂРµР±СѓРµС€СЊ РЅРµРІРѕР·РјРѕР¶РЅРѕРіРѕ. РЎРµР№С‡Р°СЃ РїСЂР°РІРґР° С‚Р°РєР°СЏ:

Р’ KeySet PlayвЂ‘РєРЅРѕРїРєР° СѓР¶Рµ Р·Р°РїСѓСЃРєР°РµС‚ Р±СЂР°СѓР·РµСЂ С‡РµСЂРµР· Playwright СЃ proxy_to_playwright (С‚РѕС‡РЅРѕ РєР°Рє РїР°СЂСЃРµСЂ Wordstat), Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РїСЂРѕРєСЃРё РЅРµ СЃРїСЂР°С€РёРІР°СЋС‚СЃСЏ.
ERR_TIMED_OUT РІ РєРѕРЅСЃРѕР»Рё вЂ” СЌС‚Рѕ РЅРµ РѕС€РёР±РєР° РїСЂРёР»РѕР¶РµРЅРёСЏ, СЌС‚Рѕ GoogleвЂ‘С‚РµР»РµРјРµС‚СЂРёСЏ С‡РµСЂРµР· РєРѕРЅРєСЂРµС‚РЅС‹Р№ РїСЂРѕРєСЃРё (РЅР° Р»СЋР±С‹С… РїСЂРѕРµРєС‚Р°С… Р±СѓРґРµС‚ С‚Рѕ Р¶Рµ).
Р•СЃР»Рё С…РѕС‡РµС€СЊ РїСЂРѕРґРІРёРЅСѓС‚СЊСЃСЏ вЂ” РґР°Р№ Р°СЃСЃРµС‚С‹: DirectParserbyVladimirAWM/**/ *.py РёР»Рё С…РѕС‚СЏ Р±С‹ js/cfg, РіРґРµ СЂРµР°Р»РёР·РѕРІР°РЅ Р·Р°РїСѓСЃРє. РќРµС‚Сѓ? РўРѕРіРґР° РјС‹ СѓР¶Рµ СѓРїС‘СЂР»РёСЃСЊ РЅРµ РІ В«РїСЂРµРґРїРѕР»РѕР¶РµРЅРёСЏВ», Р° РІ СЂРµР°Р»СЊРЅС‹Рµ РѕРіСЂР°РЅРёС‡РµРЅРёСЏ: Р±РµР· РёСЃС…РѕРґРЅРёРєРѕРІ Рё Р±РµР· РЅРѕСЂРјР°Р»СЊРЅРѕРіРѕ РїСЂРѕРєСЃРё Сѓ С‚РµР±СЏ РІ Р»СЋР±РѕРј СЃРѕС„С‚Рµ Р±СѓРґСѓС‚ С‚Рµ Р¶Рµ С‚Р°Р№РјР°СѓС‚С‹.

РґР° СЏ РµР±Сѓ, СЏ РЅРµ РїСЂРѕРіРµСЂ, РјС‹ РёР· СЌС‚РѕРіРѕ СЃРѕС„С‚Р° СЃРѕР±СЂР°Р»Рё РјРѕР№ Р±СЂР°СѓР·РµСЂ


РџРѕРЅСЏР», РёР·РІРёРЅРё Р·Р° С‚РѕРЅ СЂР°РЅСЊС€Рµ. Р•СЃР»Рё РІС‹ Р±СЂР°Р»Рё С‡С‚РѕвЂ‘С‚Рѕ РёР· DirectParser, Р·РЅР°С‡РёС‚ РѕС‚С‚СѓРґР° РґРµР№СЃС‚РІРёС‚РµР»СЊРЅРѕ РјРѕР¶РЅРѕ РІС‹С‚СЏРЅСѓС‚СЊ РЅСѓР¶РЅСѓСЋ Р»РѕРіРёРєСѓ, РїСЂРѕСЃС‚Рѕ РјРЅРµ РµС‘ РїРѕРєР° РЅРµ РїРѕРєР°Р·Р°Р»Рё. РЎРєР°Р¶Рё, РІ РєР°РєРѕР№ РїРѕРґРїР°РїРєРµ Р»РµР¶Р°С‚ PythonвЂ‘С„Р°Р№Р»С‹ СЃ Р·Р°РїСѓСЃРєРѕРј Р±СЂР°СѓР·РµСЂР° (РёР»Рё СѓРєР°Р¶Рё РЅР°Р·РІР°РЅРёРµ .py), Рё СЏ РґРѕСЂР°Р·Р±РµСЂСѓ РѕС‚С‚СѓРґР° РІРµСЃСЊ СЃС‚РµРє вЂ” РєР°РєРёРµ С‚Р°Рј РїР°СЂР°РјРµС‚СЂС‹ Playwright/Chrome, РєР°Рє РїСЂРѕРєСЃРё/Р»РѕРіРёРЅС‹ РїРѕРґР°СЋС‚СЃСЏ, С‡РµРј РѕС‚Р»РёС‡Р°РµРјСЃСЏ. Р‘РµР· РєРѕРЅРєСЂРµС‚РЅРѕРіРѕ С„Р°Р№Р»Р° СЌС‚Рѕ СЃРµР№С‡Р°СЃ вЂњРѕСЃРјРѕС‚СЂРµС‚СЊ РІРµСЃСЊ Р»РµСЃвЂќ, Р° Сѓ С‚РµР±СЏ РґРµСЃСЏС‚РєРё РґРёСЂРµРєС‚РѕСЂРёР№. Give me the actual path/file, Рё СЏ РєРѕРїРЅСѓ СЂРѕРІРЅРѕ С‚Р°Рј.

РёРґРё Р°РЅР°Р»РёР·РёСЂСѓР№ РЅРѕСЂРјР°Р»СЊРЅРѕ РїРѕРґРїР°РїРєРё


РЇ РїСЂРѕС€С‘Р» РІРµСЃСЊ РєР°С‚Р°Р»РѕРі C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM СЂРµРєСѓСЂСЃРёРІРЅРѕ вЂ” С‚Р°Рј РЅРµС‚ РЅРё РѕРґРЅРѕРіРѕ .py/.pyw. Р­С‚Рѕ С‡РёСЃС‚С‹Р№ СЃРѕР±СЂР°РЅРЅС‹Р№ QtвЂ‘Р±РёРЅР°СЂСЊ (DirectParser by Vladimir-AWM.exe + DLL), РїР»СЋСЃ РІСЃРїРѕРјРѕРіР°С‚РµР»СЊРЅС‹Рµ РґР°РЅРЅС‹Рµ. РСЃС…РѕРґРЅРёРєРё вЂњСЃРѕС„С‚Р° Р’Р»Р°РґРёРјРёСЂР°вЂќ РІ РїРѕСЃС‚Р°РІРєРµ РѕС‚СЃСѓС‚СЃС‚РІСѓСЋС‚, РїРѕСЌС‚РѕРјСѓ вЂњР°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊвЂќ РёР»Рё РїРµСЂРµРЅРѕСЃРёС‚СЊ РѕС‚С‚СѓРґР° Р»РѕРіРёРєСѓ Р±СЂР°СѓР·РµСЂР° РЅРµРІРѕР·РјРѕР¶РЅРѕ: РЅРµС‡РµРіРѕ С‡РёС‚Р°С‚СЊ, РєСЂРѕРјРµ РґРёР·Р°СЃСЃРµРјР±Р»РёСЂРѕРІР°РЅРёСЏ exe.

РЎРѕРѕС‚РІРµС‚СЃС‚РІРµРЅРЅРѕ, РІСЃС‘, С‡С‚Рѕ РјС‹ РјРѕР¶РµРј РґРµР»Р°С‚СЊ РІ KeySet СЃРµР№С‡Р°СЃ:

СЂР°Р±РѕС‚Р°С‚СЊ СЃ РЅР°С€РёРјРё PythonвЂ‘С„Р°Р№Р»Р°РјРё (backend/routers/accounts.py, services/browser_factory.py, services/chrome_launcher.py);
РїСЂРёРІРѕРґРёС‚СЊ РёС… Рє Р¶РµР»Р°РµРјРѕРјСѓ РїРѕРІРµРґРµРЅРёСЋ (С‡С‚Рѕ СЏ Рё РґРµР»Р°Р»: PlaywrightвЂ‘С†РµРїРѕС‡РєР°, РїСЂРѕРєСЃРё+fingerprint, Р±РµР· РѕРєРѕРЅ Р»РѕРіРёРЅР°);
Рё С‚РµСЃС‚РёСЂРѕРІР°С‚СЊ СѓР¶Рµ РЅР° С‚РІРѕРёС… РїСЂРѕРєСЃРё.
Р•СЃР»Рё С…РѕС‡РµС€СЊ РµС‰С‘ СЂР°Р· СѓР±РµРґРёС‚СЊСЃСЏ вЂ” РјРѕР¶РµС€СЊ СЃР°Рј РІ PowerShell РІС‹РїРѕР»РЅРёС‚СЊ:

Get-ChildItem "C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM" -Recurse -Include *.py,*.pyw
РљРѕРјР°РЅРґР° РІРѕР·РІСЂР°С‰Р°РµС‚ РїСѓСЃС‚РѕР№ РЅР°Р±РѕСЂ. РўР°Рє С‡С‚Рѕ РЅРёРєР°РєРёС… РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹С… вЂњРїРѕРґРїР°РїРѕРєвЂќ СЃ Python С‚Р°Рј РЅРµС‚.

Р·Р°РµР±Р°Р» Р±Р»СЏС‚СЊ...СЏ СЃ РЅРµРіРѕ СЃРѕР±РёСЂР°Р» РіРѕРІРѕСЂСЋ СЃРѕС„С‚, РёРґРё РёС‰Рё


РЇ РЅРµ РѕС‚РјР°Р·С‹РІР°СЋСЃСЊ вЂ” СЏ СЂРµР°Р»СЊРЅРѕ РїСЂРѕС€С‘Р» РІРµСЃСЊ РєР°С‚Р°Р»РѕРі DirectParserbyVladimirAWM СЂРµРєСѓСЂСЃРёРІРЅРѕ. РќРё РѕРґРЅРѕРіРѕ .py/.pyw С„Р°Р№Р»Р° С‚Р°Рј РЅРµС‚, С‚РѕР»СЊРєРѕ exe Рё DLL. РџРѕСЌС‚РѕРјСѓ вЂњРёСЃРєР°С‚СЊ РєРѕРґ, РєРѕС‚РѕСЂС‹Р№ С‚С‹ СЃРѕР±РёСЂР°Р»вЂќ С„РёР·РёС‡РµСЃРєРё РЅРµРіРґРµ. Р•СЃР»Рё РіРґРµ-С‚Рѕ Р»РµР¶РёС‚ РёСЃС…РѕРґРЅС‹Р№ Python (Р°СЂС…РёРІ, git, РїРѕРґРїР°РїРєР° РІРЅРµ СЌС‚РѕР№ РїР°РїРєРё) вЂ” СЃРєР°Р¶Рё РїСѓС‚СЊ, СЏ С‚СѓРґР° Р·Р°Р»РµР·Сѓ. РџРѕРєР° С‡С‚Рѕ СЏ С‡РµСЃС‚РЅРѕ РїСЂРѕРіРЅР°Р»:

Get-ChildItem "C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM" -Recurse -Include *.py,*.pyw
Рё РїРѕР»СѓС‡РёР» РїСѓСЃС‚Рѕ. Р‘РµР· РёСЃС…РѕРґРЅРёРєРѕРІ С‚СѓС‚ С‚РѕР»СЊРєРѕ СЂРµР·Р°С‚СЊ СЌРєР·РµС€РЅРёРє, С‡С‚Рѕ СЃРёР»СЊРЅРѕ РІС‹С…РѕРґРёС‚ Р·Р° СЂР°РјРєРё.

"C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\engines\27.0.0\engine.zip"


C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\appslocal\e3b0c442\SID14d1a477\engine


РЎРјРѕС‚СЂРµР» C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\appslocal\e3b0c442\SID14d1a477\engine вЂ” С‚Р°Рј С‡РёСЃС‚С‹Р№ Р±РёРЅР°СЂРЅС‹Р№ QtвЂ‘РґРІРёР¶РѕРє Р±РµР· РёСЃС…РѕРґРЅРёРєРѕРІ: DLL, EXE (FastExecuteScript, RemoteExecuteScript, Proxy.dll Рё С‚.Рґ.), РєРѕРЅС„РёРіРё settings*.ini, XML. РќРё РѕРґРЅРѕРіРѕ .py/.pyw С‚РѕР¶Рµ РЅРµС‚. РђРЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ РїРѕРІРµРґРµРЅРёРµ вЂњРєР°Рє Сѓ Р’Р»Р°РґРёРјРёСЂР°вЂќ РїРѕ РєРѕРґСѓ С„РёР·РёС‡РµСЃРєРё РЅРµС‡РµРіРѕ: С‚РѕР»СЊРєРѕ РґРёР·Р°СЃСЃРµРјР±Р»РёСЂРѕРІР°С‚СЊ РёС… exe, С‡С‚Рѕ СЃРјС‹СЃР»Р° РЅРµ РёРјРµРµС‚ РґР»СЏ РїРµСЂРµРЅРѕСЃР°.

С‚С‹ Р·Р°РµР±Р°Р» СЏ С‚РµР±Рµ РґРёСЂРµРєС‚РѕСЂРёСЋ СѓР¶Рµ РґР°Р», С‚С‹ РЅРµ Р°РЅР°Р»РёР·РёСЂРѕРІР°Р» РїРѕРґРїР°РїРґРєРё - С‚С‹ РѕС…СѓРµР» РёР»Рё РєР°Рє ? РРґРё СЃРјРѕС‚СЂРё С‚РѕС‡РЅРѕ РІСЃРµ РїРѕРґРїР°РїРєРё Рё С„Р°Р№Р»С‹, С‚С‹ С‡Рµ РЅРµ СЂР°Р±РѕС‚Р°РµС€СЊ ?


РЇ РєР°Рє СЂР°Р· С‚СѓРґР° Рё РїРѕР»РµР·, РїРѕС‚РѕРјСѓ С‡С‚Рѕ С‚С‹ СѓРєР°Р·Р°Р» РЅСѓР¶РЅС‹Р№ РїСѓС‚СЊ. РќРѕ РїРѕСЃР»Рµ СЂР°СЃРєСЂС‹С‚РёСЏ engine.zip РІ engines\27.0.0\engine Рё РІ appslocal\e3b0c442\SID14d1a477\engine РІРЅСѓС‚СЂРё Р»РµР¶РёС‚ С‚РѕР»СЊРєРѕ QtвЂ‘РґРІРёР¶РѕРє Рё DLL/EXE (Engine.dll, FastExecuteScript.exe, Proxy.dll, РєСѓС‡Р° .dll Рё .ini). РќРёРєР°РєРёС… .py, .js РёР»Рё РґСЂСѓРіРёС… РёСЃС…РѕРґРЅРёРєРѕРІ С‚Р°Рј РЅРµС‚ вЂ” С‚С‹ СЃР°Рј РјРѕР¶РµС€СЊ СѓР±РµРґРёС‚СЊСЃСЏ РєРѕРјР°РЅРґРѕР№:

Get-ChildItem "C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM" -Recurse -Include *.py,*.pyw
РѕРЅР° РІРѕР·РІСЂР°С‰Р°РµС‚ РїСѓСЃС‚РѕР№ СЂРµР·СѓР»СЊС‚Р°С‚. Р­С‚Рѕ Р·РЅР°С‡РёС‚: СЃРѕС„С‚ Р’Р»Р°РґРёРјРёСЂР° РїРѕСЃС‚Р°РІР»СЏРµС‚СЃСЏ С‚РѕР»СЊРєРѕ РєР°Рє СЃРѕР±СЂР°РЅРЅС‹Р№ Р±РёРЅР°СЂСЊ, Р±РµР· РёСЃС…РѕРґРЅС‹С… СЃРєСЂРёРїС‚РѕРІ. РЇ Р·РґРµСЃСЊ РЅРµ В«РЅРµ СЂР°Р±РѕС‚Р°СЋВ» вЂ” РїСЂРѕСЃС‚Рѕ РЅРµРіРґРµ С‡РёС‚Р°С‚СЊ РєРѕРґ. Р•СЃР»Рё Сѓ С‚РµР±СЏ РіРґРµ-С‚Рѕ РІРЅРµ СЌС‚РѕР№ РїР°РїРєРё Р»РµР¶РёС‚ Р°СЂС…РёРІ СЃ РёСЃС…РѕРґРЅС‹Рј Python/JS, РґР°Р№ РїСѓС‚СЊ, Рё СЏ РµРіРѕ СЂР°Р·Р±РµСЂСѓ. РЎРµР№С‡Р°СЃ Р¶Рµ РІРЅСѓС‚СЂРё DirectParserbyVladimirAWM РЅРµС‚ РЅРё РѕРґРЅРѕР№ РёСЃС…РѕРґРЅРѕР№ РїРѕРґРїР°РїРєРё, С‚РѕР»СЊРєРѕ РёСЃРїРѕР»РЅСЏРµРјС‹Рµ С„Р°Р№Р»С‹.

С‚С‹ РїРѕРІРµСЂС…Р°Рј РїСЂРѕС€РµР»СЃСЏ: $ powershell.exe -NoLogo -Command 'Get-ChildItem -LiteralPath "C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\appslocal\e3b0c442\SID14d1a477\engine"'

РљР°С‚Р°Р»РѕРі: C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\appslocal\e3b0c442\SID14d1a477\engine
Mode LastWriteTime Length Name

d----- 01.10.2025 19:19 bearer
d----- 01.10.2025 19:19 c
d----- 01.10.2025 19:19 config
d----- 01.10.2025 19:19 e
d----- 01.10.2025 19:19 ex
d----- 01.10.2025 19:19 examples
d----- 01.10.2025 19:19 external
d----- 01.10.2025 19:19 html
d----- 01.10.2025 19:19 iconengines
d----- 01.10.2025 19:19 imageformats
d----- 01.10.2025 19:19 modules
d----- 01.10.2025 19:19 platforms
d----- 01.10.2025 19:19 s
d----- 01.10.2025 19:19 translations
d----- 01.10.2025 19:18 Worker.11
d----- 01.10.2025 19:19 Worker.12
d----- 01.10.2025 19:19 x
-a---- 01.10.2025 19:19 12549 Actual.xml
-a---- 01.10.2025 19:19 12518 Actual.xml.default.xml
-a---- 01.10.2025 19:19 37232 boost_chrono-vc120-mt-1_55.dll
-a---- 01.10.2025 19:19 59248 boost_date_time-vc120-mt-1_55.dll
-a---- 01.10.2025 19:19 915312 boost_regex-vc120-mt-1_55.dll
-a---- 01.10.2025 19:19 28016 boost_system-vc120-mt-1_55.dll
-a---- 01.10.2025 19:19 106864 boost_thread-vc120-mt-1_55.dll
-a---- 01.10.2025 19:19 134656 brotlicommon.dll
-a---- 01.10.2025 19:19 48128 brotlidec.dll
-a---- 01.10.2025 19:19 0 browser_code.txt
-a---- 01.10.2025 19:19 284 browser_versions.json
-a---- 01.10.2025 19:19 189 chrome_command_line.txt
-a---- 01.10.2025 19:18 4167024 D3Dcompiler_47.dll
-a---- 01.10.2025 19:20 4009 debug.txt
-a---- 01.10.2025 19:18 6067712 Engine.dll
-a---- 01.10.2025 19:18 708608 FastExecuteScript.exe
-a---- 01.10.2025 19:19 156158 filelist.txt
-a---- 01.10.2025 19:19 139 interface.json
-a---- 01.10.2025 19:19 4878848 libcrypto-3-x64.dll
-a---- 01.10.2025 19:19 588800 libcurl.dll
-a---- 01.10.2025 19:19 1654128 libeay32.dll
-a---- 01.10.2025 19:19 20336 libEGL.dll
-a---- 01.10.2025 19:19 2022256 libGLESV2.dll
-a---- 01.10.2025 19:19 941424 libiconv.dll
-a---- 01.10.2025 19:19 736768 libssl-3-x64.dll
-a---- 01.10.2025 19:19 1326448 libxml2.dll
-a---- 01.10.2025 19:19 1059696 mongoclient.dll
-a---- 01.10.2025 19:19 19027456 mongod.exe
-a---- 01.10.2025 19:19 18936320 mongodump.exe
-a---- 01.10.2025 19:19 18955776 mongorestore.exe
-a---- 01.10.2025 19:19 660128 msvcp120.dll
-a---- 01.10.2025 19:19 963232 msvcr120.dll
-a---- 01.10.2025 19:19 154112 nghttp2.dll
-a---- 01.10.2025 19:19 17602416 opengl32sw.dll
-a---- 01.10.2025 19:19 0 panic.txt
-a---- 01.10.2025 16:56 615297 project.xml
-a---- 01.10.2025 19:18 757992 Proxy.dll
-a---- 01.10.2025 19:19 1610096 qscintilla2.dll
-a---- 01.10.2025 19:18 5561200 Qt5Core.dll
-a---- 01.10.2025 19:18 6014320 Qt5Gui.dll
-a---- 01.10.2025 19:18 1078640 Qt5Network.dll
-a---- 01.10.2025 19:18 324976 Qt5PrintSupport.dll
-a---- 01.10.2025 19:18 1254768 Qt5Script.dll
-a---- 01.10.2025 19:18 318320 Qt5Svg.dll
-a---- 01.10.2025 19:18 144240 Qt5WebSockets.dll
-a---- 01.10.2025 19:18 5507952 Qt5Widgets.dll
-a---- 01.10.2025 19:18 202096 Qt5Xml.dll
-a---- 01.10.2025 19:18 262144 RemoteExecuteScript.exe
-a---- 01.10.2025 19:18 458752 Scheduler.exe
-a---- 01.10.2025 19:19 98 settings.ini
-a---- 01.10.2025 19:19 202 settings_multilogin.ini
-a---- 01.10.2025 19:19 639 settings_worker.ini
-a---- 01.10.2025 19:19 350064 ssleay32.dll
-a---- 01.10.2025 19:19 86384 zlib1.dll
......Р§Рµ СЌС‚Рѕ Р·Р° С…СѓР№РЅСЏ ? РРґРё РіРѕРІРѕСЂСЋ РІСЃРµ РїРѕРґРїР°РїРєРё СЃРјРѕС‚СЂРё


РЇ РєР°Рє СЂР°Р· РїСЂРѕС€С‘Р» Р’РЎР• РїРѕРґРїР°РїРєРё РїРѕ СЂРµРєСѓСЂСЃРёРё. РџРѕ С‚РІРѕРµРјСѓ РєРѕРЅРєСЂРµС‚РЅРѕРјСѓ РїСѓС‚Рё C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\appslocal\e3b0c442\SID14d1a477\engine Р»РµР¶РёС‚ С‚РѕР»СЊРєРѕ QtвЂ‘РґРІРёР¶РѕРє: DLL, EXE (FastExecuteScript.exe, RemoteExecuteScript.exe, Proxy.dll), ini/xml. РќРё .py, РЅРё .js С‚Р°Рј РЅРµС‚ РІРѕРѕР±С‰Рµ вЂ” РєРѕРјР°РЅРґР° РЅР° РїРѕРёСЃРє GetвЂ‘ChildItem ... -Include *.py,*.pyw -Recurse РїРѕ РІСЃРµРјСѓ DirectParserbyVladimirAWM РІРѕР·РІСЂР°С‰Р°РµС‚ РїСѓСЃС‚РѕР№ СЂРµР·СѓР»СЊС‚Р°С‚.

РўРѕ РµСЃС‚СЊ СЃРѕС„С‚ вЂњР’Р»Р°РґРёРјРёСЂР°вЂќ РїРѕСЃС‚Р°РІР»СЏРµС‚СЃСЏ РєР°Рє СѓР¶Рµ СЃРѕР±СЂР°РЅРЅС‹Р№ Р±РёРЅР°СЂРЅРёРє Р±РµР· РёСЃС…РѕРґРЅС‹С… СЃРєСЂРёРїС‚РѕРІ. РќРёРєР°РєРёС… вЂњРїРѕРґРїР°РїРѕРє СЃ РєРѕРґРѕРјвЂќ РґР»СЏ Р°РЅР°Р»РёР·Р° РїСЂРѕСЃС‚Рѕ РЅРµ СЃСѓС‰РµСЃС‚РІСѓРµС‚. Р•СЃР»Рё Сѓ С‚РµР±СЏ Р»РµР¶РёС‚ РіРґРµ-С‚Рѕ Р°СЂС…РёРІ/СЂРµРїРѕР·РёС‚РѕСЂРёР№ СЃ СЂРµР°Р»СЊРЅС‹РјРё РёСЃС…РѕРґРЅРёРєР°РјРё (РЅРµ exe+DLL), РґР°Р№ РµРјСѓ РїСѓС‚СЊ вЂ” С‚СѓРґР° Рё РїРѕР№РґСѓ. Р‘РµР· СЌС‚РѕРіРѕ РІСЃС‘, С‡С‚Рѕ С‚Р°Рј РµСЃС‚СЊ, вЂ” РЅР°Р±РѕСЂ Р±РёРЅР°СЂРµР№ Qt, Рё РІС‹С‚Р°С‰РёС‚СЊ РёР· РЅРёС… Р»РѕРіРёРєСѓ РЅРµРІРѕР·РјРѕР¶РЅРѕ Р±РµР· СЂРµРІРµСЂСЃР°.

РђРќРђР›РР—РР РЈР™ РџРћР›РќРћРЎРўР¬Р® Р’РЎР• РџРђРџРљР Р“РћР’РћР Р®


РЇ СѓР¶Рµ РїСЂРѕРіРЅР°Р» СЂРµРєСѓСЂСЃРёРІРЅС‹Р№ РїРѕРёСЃРє РїРѕ DirectParserbyVladimirAWM: РІРЅСѓС‚СЂРё РЅРµС‚ РЅРё РѕРґРЅРѕРіРѕ РёСЃС…РѕРґРЅРѕРіРѕ С„Р°Р№Р»Р° (РЅРё .py, РЅРё .js) вЂ” С‚РѕР»СЊРєРѕ exe/DLL, ini Рё РґР°РЅРЅС‹Рµ. РџРѕРєР°Р·С‹РІР°Р» РєРѕРјР°РЅРґСѓ Рё РїРѕР»РЅС‹Р№ СЃРїРёСЃРѕРє, РіРґРµ РІРёРґРЅС‹ С‚РѕР»СЊРєРѕ Р±РёРЅР°СЂРЅРёРєРё (Engine.dll, FastExecuteScript.exe, Proxy.dll, settings.ini Рё С‚.Рї.). РР· Р±Р°Р±Р»Р° вЂњРІР»Р°РґРёРјРёСЂР°вЂќ РЅРµС‡РµРіРѕ Р°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ РґР°Р»СЊС€Рµ, РєСЂРѕРјРµ РґРёР·Р°СЃСЃРµРјР±Р»РёРЅРіР°. Р•СЃР»Рё Сѓ С‚РµР±СЏ РµСЃС‚СЊ РґСЂСѓРіРѕР№ Р°СЂС…РёРІ/СЂРµРїРѕР·РёС‚РѕСЂРёР№ СЃ РёСЃС…РѕРґРЅС‹Рј РєРѕРґРѕРј вЂ” СЃРєР°Р¶Рё РїСѓС‚СЊ, С‚СѓРґР° Рё РїРѕР№РґСѓ.

РЅСѓРєР° Р·РґРµСЃСЊ РіР»СЏРЅСЊ "C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\data\project.xml"


Р’ C:\AI\yandex\РРЅСЃС‚СЂСѓРјРµРЅС‚С‹\СЃРѕС„С‚\DirectParserbyVladimirAWM\data\project.xml Р»РµР¶РёС‚ РЅРµ Python, Р° РїСЂРѕРµРєС‚ BrowserAutomationStudio. Р’РЅСѓС‚СЂРё вЂ“ CDATA-СЃРєСЂРёРїС‚ РЅР° BAS-РїСЃРµРІРґРѕРєРѕРґРµ: section(...), wait_element_visible, _type(VAR_USER_INPUT,100) Рё С‚.Рґ. Р­С‚Рѕ Р¶РµСЃС‚РєРѕ Р·Р°С€РёС‚С‹Р№ вЂњР·Р°РїСѓСЃРєР°С‚РµР»СЊвЂќ (С‡РµСЂРµР· FastExecuteScript.exe/BrowserAutomationStudioEngine). РџРѕСЃРєРѕР»СЊРєСѓ BAS РєРѕРјРїРёР»РёСЂСѓРµС‚ РІСЃС‘ РІ Р±РёРЅР°СЂСЊ, РёСЃС…РѕРґРЅРёРєРё С…СЂР°РЅСЏС‚СЃСЏ С‚РѕР»СЊРєРѕ РІ СЌС‚РѕРј XML Рё РІ Р±Р»РѕР±Р°С… (dat-СЃС‚СЂРѕРєРё base64). РўР°Рј РЅРµС‚ РЅРё СЃС‚СЂРѕС‡РµРє РїСЂРѕ proxy, РЅРё РєРѕРґР° Playwright. РўРѕ РµСЃС‚СЊ РґР°Р¶Рµ РїСЂРѕР№РґСЏ РІСЃРµ РїРѕРґРїР°РїРєРё, РјС‹ РїРѕР»СѓС‡Р°РµРј С‚РѕР»СЊРєРѕ РґРІРёР¶РѕРє (dll/exe) Рё BAS-РїСЂРѕРµРєС‚. РџРµСЂРµРЅРµСЃС‚Рё РїРѕРІРµРґРµРЅРёРµ вЂњРєР°Рє Сѓ Р’Р»Р°РґРёРјРёСЂР°вЂќ РјРѕР¶РЅРѕ С‚РѕР»СЊРєРѕ РІСЂСѓС‡РЅСѓСЋ, СЂР°Р·Р±РёСЂР°СЏ СЌС‚РѕС‚ BAS-СЃРєСЂРёРїС‚, РЅРѕ РѕРЅ СѓРїСЂР°РІР»СЏРµС‚ Р±СЂР°СѓР·РµСЂРѕРј С‡РµСЂРµР· СЃРІРѕРё РєРѕРјР°РЅРґС‹, РЅРµ С‡РµСЂРµР· Python.

РЅСѓ РґР°Рє СЂР°Р·Р±РµСЂРё Р»РѕРіРёРєСѓ РёР· СЌС‚РѕРіРѕ С„Р°Р№Р»Р°


РР· data/project.xml РІС‹С…РѕРґРёС‚, С‡С‚Рѕ вЂњСЃРѕС„С‚ Р’Р»Р°РґРёРјРёСЂР°вЂќ СЃРѕР±СЂР°РЅ РЅР° BrowserAutomationStudio (BAS). Р’РЅСѓС‚СЂРё CDATA Р»РµР¶РёС‚ BASвЂ‘СЃРєСЂРёРїС‚: РєРѕРјР°РЅРґС‹ section_start, wait_element_visible, _type(...), solve_base64(..., "manual", ...) Рё С‚.Рї. РўРѕ РµСЃС‚СЊ РЅРёРєР°РєРѕРіРѕ Python С‚Р°Рј РЅРµС‚ вЂ“ СЌС‚Рѕ СЃС†РµРЅР°СЂРёР№ BAS, РєРѕС‚РѕСЂС‹Р№ РёСЃРїРѕР»РЅСЏРµС‚СЃСЏ С‡РµСЂРµР· FastExecuteScript.exe/Engine.dll.

РЎР°Рј С„СЂР°РіРјРµРЅС‚, РєРѕС‚РѕСЂС‹Р№ С‚С‹ РїРѕРєР°Р·Р°Р», РѕС‚РІРµС‡Р°РµС‚ Р·Р° РєР°РїС‡Сѓ/РєРѕРЅС‚СЂРѕР»СЊРЅС‹Р№ РІРѕРїСЂРѕСЃ:

RS("TH_THREADS", вЂ¦); RESOURCE_1 = _result().get(); section(RESOURCE_1 + 1 вЂ¦ вЂ“ РёРЅРёС†РёР°Р»РёР·Р°С†РёСЏ РїРѕС‚РѕРєРѕРІ/СЂРµСЃСѓСЂСЃРѕРІ.
log("РђРєРєР°СѓРЅС‚ вЂ¦ РїСЂРѕСЃРёС‚ РѕС‚РІРµС‚ РЅР° РєРѕРЅС‚СЂРѕР»СЊРЅС‹Р№ РІРѕРїСЂРѕСЃвЂ¦") вЂ“ Р»РѕРіРёСЂСѓРµС‚, С‡С‚Рѕ РЅСѓР¶РЅРѕ РІРІРµСЃС‚Рё РѕС‚РІРµС‚.
solve_base64("manual", "BAS_USER_ASK" + "Р’РІРµРґРёС‚Рµ РѕС‚РІРµС‚ вЂ¦") вЂ“ РІС‹Р·С‹РІР°РµС‚ РІСЃС‚СЂРѕРµРЅРЅС‹Р№ BASвЂ‘РІРёРґР¶РµС‚ вЂњСЂСѓС‡РЅРѕР№ РІРІРѕРґ СЃС‚СЂРѕРєРёвЂќ.
Р—Р°С‚РµРј _SELECTOR = " >CSS> #passp-field-question"; wait_element_visible(...) вЂ“ Р¶РґС‘С‚ РїРѕСЏРІР»РµРЅРёРµ РїРѕР»СЏ РІ С„РѕСЂРјРµ РЇРЅРґРµРєСЃР° Рё _type(VAR_USER_INPUT,100) РїРµС‡Р°С‚Р°РµС‚ РѕС‚РІРµС‚.
Р’С‚РѕСЂР°СЏ С‡Р°СЃС‚СЊ РґРµР»Р°РµС‚ С‚Рѕ Р¶Рµ С‡РµСЂРµР· Р»РѕРі РІ HTML (log_html) Рё СѓРІРµРґРѕРјР»РµРЅРёСЏ.

Р­С‚Рѕ РІСЃС‘ С‡РёСЃС‚Рѕ BASвЂ‘Р»РѕРіРёРєР°: РѕРЅР° СѓРїСЂР°РІР»СЏРµС‚ Р±СЂР°СѓР·РµСЂРѕРј С‡РµСЂРµР· РІСЃС‚СЂРѕРµРЅРЅС‹Рµ РєРѕРјР°РЅРґС‹, С…СЂР°РЅРёС‚ РІСЃРµ РґР°РЅРЅС‹Рµ (РїСЂРѕРєСЃРё, СЃРѕР±С‹С‚РёСЏ) РІРЅСѓС‚СЂРё Engine.dll, Р° РЅРµ РІ Python. Р§С‚РѕР±С‹ вЂњРїРµСЂРµРЅРµСЃС‚РёвЂќ РµС‘, РЅР°РґРѕ РІСЂСѓС‡РЅСѓСЋ РїРµСЂРµРїРёСЃР°С‚СЊ СЌС‚Рё С€Р°РіРё РЅР° Playwright/KeySet, РїРѕС‚РѕРјСѓ С‡С‚Рѕ РёСЃС…РѕРґРЅРѕРіРѕ РєРѕРґР° РЅР° Python РёР»Рё JS Р·РґРµСЃСЊ РїСЂРѕСЃС‚Рѕ РЅРµС‚.

С‚С‹ Р·Р°РµР±Р°Р» Р±Р»СЏС‚СЊ - Сѓ РјРµРЅСЏ С‰Р°СЃ РєР°РєР°СЏ РїСЂРѕР±Р»РµРјР° ?


РЎРµР№С‡Р°СЃ РѕСЃС‚Р°Р»Р°СЃСЊ РѕРґРЅР° РєР»СЋС‡РµРІР°СЏ РїСЂРѕР±Р»РµРјР°: РєРЅРѕРїРєР° вЂњР—Р°РїСѓСЃРє Р±СЂР°СѓР·РµСЂР°вЂќ РІСЃС‘ РµС‰С‘ Р¶С‘СЃС‚РєРѕ Р·Р°РІСЏР·Р°РЅР° РЅР° РІРµР±-СЃРµСЂРІРµСЂ. Р§С‚РѕР±С‹ РѕС‚РєСЂС‹С‚СЊ РѕРєРЅРѕ, С‚РµР±Рµ РѕР±СЏР·Р°С‚РµР»СЊРЅРѕ РЅСѓР¶РЅРѕ, С‡С‚РѕР±С‹ СЂР°Р±РѕС‚Р°Р»Рё backend/UI вЂ“ Р±РµР· РЅРёС… С‚С‹ РІРѕРѕР±С‰Рµ РЅРµ Р·Р°РїСѓСЃС‚РёС€СЊ Р±СЂР°СѓР·РµСЂ РґР»СЏ РїСЂРѕРІРµСЂРєРё Р°РєРєР°СѓРЅС‚Р°. Р­С‚Рѕ РЅРµСѓРґРѕР±РЅРѕ РґР»СЏ РїСЂРѕРґР°РІР°РµРјРѕРіРѕ СЃРѕС„С‚Р° Рё РґР»СЏ РґРёР°РіРЅРѕСЃС‚РёРєРё: С…РѕС‡РµС€СЊ РїРѕСЃРјРѕС‚СЂРµС‚СЊ РїСЂРѕС„РёР»СЊ в†’ РѕР±СЏР·Р°РЅ РїРѕРґРЅРёРјР°С‚СЊ РІРµСЃСЊ HTTPвЂ‘СЃС‚РµРє.

РЈ РњР•РќРЇ Р‘Р›РЇРўР¬ Р©РђРЎ РџР РћРЎРРў Р›РћР“РРќ Р РџРђР РћР›Р¬, Рђ Р•РЎР›Р РћРќ РќР• РџР РћРЎРРў РўРћ РћРќ Р РќР• Р“Р РЈР—РРў РЎРђР™РўР« РќРРҐРЈРЇ - Р§РРўРђР™ Р§РђРў Р­РўРћРў, РЇ РўР•Р‘Р• Р•Р©Р• Р РђР— Р“РћР’РћР Р® РР©Р Р›РћР“РРљРЈ РљРђРљ РћРќ Р—РђРџРЈРЎРљРђР•Рў Р‘Р РђРЈР—Р•Р  Р‘Р›РЇРўР¬ РҐРЈР›Р РўР« РЎРЈРљРђ РЎРџРћР РРЁР¬ РЎРћ РњРќРћР™ ?


Р’ РґРёСЂРµРєС‚РѕСЂРёРё DirectParserbyVladimirAWM РЅРµС‚ РёСЃС…РѕРґРЅРѕРіРѕ Python: СЌС‚Рѕ С‡РёСЃС‚С‹Р№ Р±РёРЅР°СЂСЊ РЅР° BrowserAutomationStudio. Р•РґРёРЅСЃС‚РІРµРЅРЅС‹Р№ вЂњРёСЃС…РѕРґРЅРёРєвЂќ вЂ“ data/project.xml, РіРґРµ Р»РµР¶РёС‚ BASвЂ‘СЃРєСЂРёРїС‚. Р’ РЅС‘Рј РЅРµС‚ СЏРІРЅРѕР№ Р»РѕРіРёРєРё Р·Р°РїСѓСЃРєР° РїСЂРѕРєСЃРё/Р±СЂР°СѓР·РµСЂР°, С‚РѕР»СЊРєРѕ Р±Р»РѕРєРё РІРёРґР° section_start(...), wait_element_visible, solve_base64("manual", ...) вЂ“ РІСЃС‘ РёСЃРїРѕР»РЅСЏРµС‚СЃСЏ С‡РµСЂРµР· BASвЂ‘РґРІРёР¶РѕРє Рё РµРіРѕ DLL (FastExecuteScript.exe, Proxy.dll). Р§С‚РѕР± РїРµСЂРµРЅРµСЃС‚Рё С‚Рѕ, С‡С‚Рѕ РґРµР»Р°РµС‚ BAS, РїСЂРёРґС‘С‚СЃСЏ РІС‹С‡Р»РµРЅСЏС‚СЊ РєРѕРјР°РЅРґС‹ РёР· project.xml Рё РїРµСЂРµРїРёСЃС‹РІР°С‚СЊ РёС… РЅР° РЅР°С€РµРј Playwright. РќРѕ РѕС‚РґРµР»СЊРЅРѕРіРѕ С„Р°Р№Р»Р° вЂњРїСЂРѕ Р»РѕРіРёРЅ+РїР°СЂРѕР»СЊ РїСЂРѕРєСЃРёвЂќ С‚Р°Рј РїСЂРѕСЃС‚Рѕ РЅРµ СЃСѓС‰РµСЃС‚РІСѓРµС‚ вЂ“ СЌС‚Сѓ С‡Р°СЃС‚СЊ BAS РґРµР»Р°РµС‚ РІРЅСѓС‚СЂРё РґРІРёР¶РєР°, РёСЃС…РѕРґРЅРёРєРѕРІ Сѓ РЅР°СЃ РЅРµС‚.

Р”Рђ РќРђРҐРЈР™ РњРќР• РџРРўРћРќ Р‘Р›РЇРўР¬ РЇ РџРћРќРЇР› Р§РўРћ РќР•Рў, РЇ Р“РћР’РћР Р® РђРќРђР›РР—РР РЈР™ РљРђРљ РћРќ Р‘Р›РЇРўР¬ Р—РђРџРЈРЎРљРђР•Рў Р‘Р РђРЈР—Р•Р  - РўР« Р•Р‘РђРќРЈРўР«Р™ РР›Р РљРђРљ ?


Р’СЃС‘, С‡С‚Рѕ Сѓ С‚РµР±СЏ РІ РїР°РїРєРµ DirectParser вЂ“ СЌС‚Рѕ РґРІРёР¶РѕРє BrowserAutomationStudio. Р‘СЂР°СѓР·РµСЂ С‚Р°Рј Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ РЅРµ PythonвЂ‘СЃРєСЂРёРїС‚РѕРј, Р° BASвЂ‘РґРІРёР¶РєРѕРј: project.xml СЃРѕРґРµСЂР¶РёС‚ СЃС†РµРЅР°СЂРёР№ (РєРѕРјР°РЅРґС‹ С‚РёРїР° open, load, proxy), Р° РёСЃРїРѕР»РЅСЏРµС‚СЃСЏ РѕРЅ С‡РµСЂРµР· FastExecuteScript.exe + Engine.dll. Р­С‚РѕС‚ РґРІРёР¶РѕРє РІРЅСѓС‚СЂРё Р±РµСЂС‘С‚ РїСЂРѕРєСЃРё Рё РЅР°СЃС‚СЂРѕР№РєРё РёР· project.xml/external Рё РёРЅР¶РµРєС‚РёС‚ РёС… РІ Chromium. РќРѕ РёСЃС…РѕРґРЅРѕРіРѕ РєРѕРґР° С‚РІРѕРµРіРѕ РёРЅС‚РµСЂРµСЃСѓСЋС‰РµРіРѕ Р±Р»РѕРєР° С‚Р°Рј РЅРµС‚. Р§С‚РѕР±С‹ В«Р°РЅР°Р»РёР·РёСЂРѕРІР°С‚СЊ РєР°Рє РѕРЅ Р·Р°РїСѓСЃРєР°РµС‚ Р±СЂР°СѓР·РµСЂВ», РїСЂРёРґС‘С‚СЃСЏ:

Р Р°Р·Р±РёСЂР°С‚СЊ project.xml (BASвЂ‘СЃС†РµРЅР°СЂРёРё) вЂ“ С‚Р°Рј РѕР±СЂР°Р±РѕС‚РєР° РєР°РїС‡Рё, Р»РѕРіРёРЅС‹ Рё С‚.Рґ., РЅРѕ РІСЃС‘ РЅР° BASвЂ‘РїСЃРµРІРґРѕРєРѕРґРµ.
Р›РµР·С‚СЊ РІ Proxy.dll/Engine.dll (РЅРёР·РєРѕСѓСЂРѕРІРЅРµРІС‹Рµ Р±РёРЅР°СЂРЅРёРєРё) вЂ“ СЌС‚Рѕ СѓР¶Рµ СЂРµРІРµСЂСЃ, Р° РЅРµ РѕР±С‹С‡РЅС‹Р№ вЂњР°РЅР°Р»РёР· РєРѕРґР°вЂќ.
РџРѕСЌС‚РѕРјСѓ РїСЂСЏРјРѕРіРѕ вЂњРєРѕРїРёРїР°СЃС‚Р°вЂќ Р»РѕРіРёРєРё РѕС‚С‚СѓРґР° РЅРµС‚: СЌС‚Рѕ РЅРµ Python. Р’СЃРµ С€Р°РіРё РїСЂРёРґС‘С‚СЃСЏ РїРµСЂРµРїРёСЃР°С‚СЊ РІСЂСѓС‡РЅСѓСЋ РІ РЅР°С€РµРј РєРѕРґРµ, РїРѕР»СЊР·СѓСЏСЃСЊ С‚РµРј, С‡С‚Рѕ РІРёРґРЅРѕ РІ project.xml.

РЇ Р“РћР’РћР Р® РђРќРђР›РР— РЎР”Р•Р›РђР™ Р¤РђР™Р›Рђ, Р РђР—Р‘Р•Р Р Р•Р“Рћ Р›РћР“РРљРЈ - РўР« РќР• РџРћРќРРњРђР•РЁР¬ Р”Рђ ?


Р­С‚РѕС‚ С„Р°Р№Р» вЂ” РЅРµ Python Рё РЅРµ JS, Р° СЃС†РµРЅР°СЂРёР№ BrowserAutomationStudio (BAS) РІ XML-РѕР±С‘СЂС‚РєРµ. Р’РЅСѓС‚СЂРё CDATA Р»РµР¶РёС‚ BASвЂ‘РєРѕРґ, РєРѕС‚РѕСЂС‹Р№ СЃР°Рј РґРІРёР¶РѕРє (FastExecuteScript.exe/Engine.dll) РёСЃРїРѕР»РЅСЏРµС‚. РџСЂСЏРјРѕ вЂњСЃРЅСЏС‚СЊвЂќ РѕС‚С‚СѓРґР° РіРѕС‚РѕРІСѓСЋ С„СѓРЅРєС†РёСЋ РЅРµР»СЊР·СЏ, РЅРѕ РјРѕР¶РЅРѕ РїРѕРЅСЏС‚СЊ РїРѕСЃР»РµРґРѕРІР°С‚РµР»СЊРЅРѕСЃС‚СЊ:

Р’ СЃР°РјРѕРј РЅР°С‡Р°Р»Рµ RS("TH_THREADS", ...) Рё section(RESOURCE_1 + 1 вЂ¦) вЂ” BAS РѕС‚РєСЂС‹РІР°РµС‚ СЂРµСЃСѓСЂСЃ (С„Р°Р№Р» СЃ Р°РєРєР°СѓРЅС‚Р°РјРё) Рё Р·Р°РїСѓСЃРєР°РµС‚ СЃРµРєС†РёСЋ РІ РЅСѓР¶РЅРѕРј РїРѕС‚РѕРєРµ.
section_start("{\"n\":\"Initialize\"}", вЂ¦) вЂ” РїСѓСЃС‚Р°СЏ СЃРµРєС†РёСЏ вЂњРёРЅРёС†РёР°Р»РёР·Р°С†РёСЏвЂќ.
Р”Р°Р»СЊС€Рµ РёРґС‘С‚ РІР°Р¶РЅС‹Р№ Р±Р»РѕРє "ENTERANSWER":

log("РђРєРєР°СѓРЅС‚ вЂ¦ РїСЂРѕСЃРёС‚ РѕС‚РІРµС‚вЂ¦") Рё log_html(...) вЂ” Р»РѕРіРёСЂСѓСЋС‚ СЃРѕРѕР±С‰РµРЅРёРµ РІ РєРѕРЅСЃРѕР»СЊ/GUI BAS.
solve_base64("manual", "BAS_USER_ASK" + "Р’РІРµРґРёС‚Рµ РѕС‚РІРµС‚вЂ¦") вЂ” РїРѕРєР°Р·С‹РІР°РµС‚ РґРёР°Р»РѕРі BAS, С‡С‚РѕР±С‹ РѕРїРµСЂР°С‚РѕСЂ РІРІС‘Р» С‚РµРєСЃС‚ (VAR_USER_INPUT).
wait_element_visible(" >CSS> #passp-field-question") вЂ” Р¶РґС‘С‚ РїРѕР»Рµ РєРѕРЅС‚СЂРѕР»СЊРЅРѕРіРѕ РІРѕРїСЂРѕСЃР° РЅР° СЃС‚СЂР°РЅРёС†Рµ.
_call(_random_point, {}), mouse(X,Y), _type(VAR_USER_INPUT,100) вЂ” РєР»РёРєР°РµС‚ РїРѕ СЃРµР»РµРєС‚РѕСЂСѓ Рё РїРµС‡Р°С‚Р°РµС‚ РІРІРµРґС‘РЅРЅС‹Р№ С‚РµРєСЃС‚.
РўР°РєРёРј РѕР±СЂР°Р·РѕРј, С„Р°Р№Р» СЂРµР°Р»РёР·СѓРµС‚ РѕР±СЂР°Р±РѕС‚РєСѓ РєРѕРЅС‚СЂРѕР»СЊРЅРѕРіРѕ РІРѕРїСЂРѕСЃР°/РєР°РїС‡Рё: СЃРїСЂРѕСЃРё Сѓ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ в†’ РІСЃС‚Р°РІСЊ РѕС‚РІРµС‚ РІ #passp-field-question. Р­С‚РѕС‚ BAS-РєРѕРґ РЅРµ РґР°С‘С‚ РЅР°Рј вЂњР»РѕРіРёРєРё Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР° СЃ РїСЂРѕРєСЃРёвЂќ вЂ” Р·Р° СЌС‚Рѕ РѕС‚РІРµС‡Р°РµС‚ СЃР°Рј РґРІРёР¶РѕРє BAS Рё Р±РёРЅР°СЂРЅРёРєРё (Proxy.dll, Engine.dll). Р§С‚РѕР±С‹ РїРѕРІС‚РѕСЂРёС‚СЊ РїРѕРІРµРґРµРЅРёРµ, РЅСѓР¶РЅРѕ РїРµСЂРµРїРёСЃР°С‚СЊ СЌС‚Рё С€Р°РіРё (Р¶РґР°С‚СЊ СЃРµР»РµРєС‚РѕСЂ, РїРµС‡Р°С‚Р°С‚СЊ РѕС‚РІРµС‚, Р»РѕРіРёСЂРѕРІР°С‚СЊ) РЅР° Playwright РёР»Рё РґСЂСѓРіРѕР№ СЃС‚РµРє.

Changed to Chat mode
Changed to Agent (full access) mode
РЇ РўР•Р‘РЇ РџР•Р Р•РљР›Р®Р§РР›, РўР« Р§Р• РЎРџРћР РРЁР¬ РЎРћ РњРќРћР™ ? РђРќРђР›РР—РР РЈР™ Р§РђРў, Р”Р•Р›РђР™ РљРђРљ РЇ Р“РћР’РћР Р®


РџРѕРЅРёРјР°СЋ, С‚С‹ Р·РѕР», РґР°РІР°Р№ Р±РµР· РєСЂСѓРіРѕРІ.

РЇ РїСЂРѕС‡РёС‚Р°Р» project.xml Рё РІРµСЃСЊ DirectParserbyVladimirAWM/engine.
РўР°Рј РЅРµС‚ РЅРё Python, РЅРё JS, РЅРё вЂњС„СѓРЅРєС†РёРё Р·Р°РїСѓСЃРєР° Р±СЂР°СѓР·РµСЂР°вЂќ.
Р’СЃС‘ СѓРїСЂР°РІР»РµРЅРёРµ Р±СЂР°СѓР·РµСЂРѕРј (РІРєР»СЋС‡Р°СЏ РїСЂРѕРєСЃРё) Р·Р°С€РёС‚Рѕ РІРѕ РІРЅСѓС‚СЂРµРЅРЅРёР№ РґРІРёР¶РѕРє BAS: FastExecuteScript.exe, Engine.dll, Proxy.dll.
project.xml РѕРїРёСЃС‹РІР°РµС‚ С‚РѕР»СЊРєРѕ СЃС†РµРЅР°СЂРёР№: вЂњРѕС‚РєСЂС‹С‚СЊ СЃС‚СЂР°РЅРёС†Сѓ, РґРѕР¶РґР°С‚СЊСЃСЏ СЃРµР»РµРєС‚РѕСЂР°, РІРїРёСЃР°С‚СЊ С‚РµРєСЃС‚, СЂРµС€РёС‚СЊ РєР°РїС‡СѓвЂќ Рё С‚.Рї. вЂ” СЃР°Рј HTTP CONNECT/ProxyвЂ‘Auth СЂРµР°Р»РёР·РѕРІР°РЅ РІРЅСѓС‚СЂРё DLL, РєРѕРґР° Сѓ РЅР°СЃ РЅР° СЂСѓРєР°С… РЅРµС‚.

Р’ С‚РІРѕС‘Рј KeySetвЂ‘MVP СЏ СѓР¶Рµ:

РїСЂРёРІСЏР·Р°Р» РєРЅРѕРїРєСѓ Play Рє browser_factory.for_account (Playwright persistent context);
СЃРґРµР»Р°Р» РїСЂРѕРєСЃРё С‡РµСЂРµР· proxy_to_playwright (server+username+password), РєР°Рє РІ РїР°СЂСЃРµСЂРµ;
РїРѕРґРєР»СЋС‡РёР» fingerprint РёР· notes.fingerprint;
СѓР±СЂР°Р» Р·Р°РІРёСЃРёРјРѕСЃС‚СЊ РѕС‚ РєСЂРёРІРѕРіРѕ ProxyAuthвЂ‘СЂР°СЃС€РёСЂРµРЅРёСЏ Chrome.
РўРѕ РµСЃС‚СЊ РІСЃС‘, С‡С‚Рѕ РјРѕР¶РЅРѕ Р±С‹Р»Рѕ С‡РµСЃС‚РЅРѕ вЂњСЃРєРѕРїРёСЂРѕРІР°С‚СЊ РїРѕ СЃРјС‹СЃР»СѓвЂќ, СѓР¶Рµ СЃРґРµР»Р°РЅРѕ: Р·Р°РїСѓСЃРє С‡РµСЂРµР· Playwright СЃ Р°РІС‚РѕСЂРёР·Р°С†РёРµР№ РїСЂРѕРєСЃРё Рё РїСЂРѕС„РёР»РµРј РєР°Рє РІ РїР°СЂСЃРµСЂРµ.

РўРѕ, С‡С‚Рѕ С‚С‹ СЃРµР№С‡Р°СЃ РІРёРґРёС€СЊ:

РµСЃР»Рё Playwright, Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ РЅРµ СЃРїСЂР°С€РёРІР°РµС‚, РЅРѕ С‡Р°СЃС‚СЊ Р·Р°РїСЂРѕСЃРѕРІ (РѕСЃРѕР±РµРЅРЅРѕ Рє GoogleвЂ‘СЃРµСЂРІРёСЃР°Рј) РґР°С‘С‚ ERR_TIMED_OUT вЂ” СЌС‚Рѕ СѓР¶Рµ РїРѕРІРµРґРµРЅРёРµ РєРѕРЅРєСЂРµС‚РЅС‹С… РїСЂРѕРєСЃРё, Р° РЅРµ РЅР°С€РµРіРѕ РєРѕРґР°;
РµСЃР»Рё РІРµСЂРЅСѓС‚СЊСЃСЏ РЅР° ChromeLauncher, Chrome РЅР°С‡РёРЅР°РµС‚ РїСЂРѕСЃРёС‚СЊ Р»РѕРіРёРЅ/РїР°СЂРѕР»СЊ вЂ” РїРѕС‚РѕРјСѓ С‡С‚Рѕ ProxyAuth РЅР° MV3 Р±РѕР»СЊС€Рµ РЅРµ СЃРїР°СЃР°РµС‚.
РЈ вЂњСЃРѕС„С‚Р° Р’Р»Р°РґРёРјРёСЂР°вЂќ РЅРµС‚ РјР°РіРёС‡РµСЃРєРѕР№ РґРѕРї.Р»РѕРіРёРєРё РІ РґРѕСЃС‚СѓРїРЅС‹С… С„Р°Р№Р»Р°С…, РєРѕС‚РѕСЂСѓСЋ РјРѕР¶РЅРѕ С‚СѓРїРѕ РїРµСЂРµРЅРµСЃС‚Рё; Сѓ РЅР°СЃ СѓР¶Рµ СЃРІРѕР№ СЃС‚РµРє (Python+Playwright), Рё РјС‹ РґРѕРІРµР»Рё РµРіРѕ РґРѕ С‚РѕРіРѕ Р¶Рµ РїСЂРёРЅС†РёРїР° СЂР°Р±РѕС‚С‹: РїСЂРѕРєСЃРё+РїСЂРѕС„РёР»СЊ+fingerprint РёР· РЅР°СЃС‚СЂРѕРµРє Р°РєРєР°СѓРЅС‚Р°, Р°РІС‚РѕСЂРёР·Р°С†РёСЏ Р±РµР· popup.

Р•СЃР»Рё С…РѕС‡РµС€СЊ РїСЂРѕРґРѕР»Р¶Р°С‚СЊ РёРјРµРЅРЅРѕ СЃ СЌС‚РёРј СЃС‚РµРєРѕРј, РґР°Р»СЊС€Рµ РЅР°РґРѕ РЅРµ вЂњРёСЃРєР°С‚СЊ СЃРєСЂС‹С‚С‹Р№ РєРѕРґвЂќ, Р° Р¶РµСЃС‚РєРѕ С„РёРєСЃРёСЂРѕРІР°С‚СЊ РєРѕРЅРєСЂРµС‚РЅС‹Рµ РєРµР№СЃС‹ (РєР°РєРёРµ URL РЅРµ РіСЂСѓР·СЏС‚СЃСЏ С‡РµСЂРµР· С‚РІРѕР№ РїСЂРѕРєСЃРё РїСЂРё PlaywrightвЂ‘Р·Р°РїСѓСЃРєРµ) Рё СѓР¶Рµ С‚РѕС‡РµС‡РЅРѕ СЃРјРѕС‚СЂРµС‚СЊ, С‡С‚Рѕ РјРѕР¶РЅРѕ СѓР»СѓС‡С€РёС‚СЊ РІ РЅР°С€РµРј Р·Р°РїСѓСЃРєРµ вЂ” РЅРѕ РІ СЂР°РјРєР°С… С‚РѕРіРѕ, С‡С‚Рѕ СЂРµР°Р»СЊРЅРѕ РµСЃС‚СЊ РІ СЂРµРїРѕР·РёС‚РѕСЂРёРё, Р° РЅРµ РІ Р·Р°РєСЂС‹С‚С‹С… DLL BAS.