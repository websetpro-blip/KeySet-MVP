# 05. Р РµР°Р±РёР»РёС‚Р°С†РёСЏ РІРєР»Р°РґРєРё В«Р”Р°РЅРЅС‹РµВ»

> **Р”РѕРєСѓРјРµРЅС‚Р°С†РёСЏ РІРѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРёСЏ Data Tab: СЃС‚СЂСѓРєС‚СѓСЂР° С‚Р°Р±Р»РёС†С‹, РїРѕС‚РѕРєРё РґР°РЅРЅС‹С…, UX РїР°С‚С‚РµСЂРЅС‹**

## рџ“‹ РЎРѕРґРµСЂР¶Р°РЅРёРµ

- [Р¦РµР»СЊ](#С†РµР»СЊ)
- [Р”Р»СЏ РєРѕРіРѕ](#РґР»СЏ-РєРѕРіРѕ)
- [РЎРІСЏР·Р°РЅРЅС‹Рµ РґРѕРєСѓРјРµРЅС‚С‹](#СЃРІСЏР·Р°РЅРЅС‹Рµ-РґРѕРєСѓРјРµРЅС‚С‹)
- [РђСЂС…РёС‚РµРєС‚СѓСЂР° РІРєР»Р°РґРєРё](#Р°СЂС…РёС‚РµРєС‚СѓСЂР°-РІРєР»Р°РґРєРё)
- [Р”РёР°РіСЂР°РјРјР° РІР·Р°РёРјРѕРґРµР№СЃС‚РІРёСЏ](#РґРёР°РіСЂР°РјРјР°-РІР·Р°РёРјРѕРґРµР№СЃС‚РІРёСЏ)
- [РљРѕРјРїРѕРЅРµРЅС‚С‹ РёРЅС‚РµСЂС„РµР№СЃР°](#РєРѕРјРїРѕРЅРµРЅС‚С‹-РёРЅС‚РµСЂС„РµР№СЃР°)
- [РЎРЅРёРїРїРµС‚С‹](#СЃРЅРёРїРїРµС‚С‹)
- [РўРёРїРѕРІС‹Рµ РѕС€РёР±РєРё](#С‚РёРїРѕРІС‹Рµ-РѕС€РёР±РєРё)
- [Р‘С‹СЃС‚СЂС‹Р№ СЃС‚Р°СЂС‚](#Р±С‹СЃС‚СЂС‹Р№-СЃС‚Р°СЂС‚)
- [TL;DR](#tldr)
- [Р§РµРє-Р»РёСЃС‚ РїСЂРёРјРµРЅРµРЅРёСЏ](#С‡РµРє-Р»РёСЃС‚-РїСЂРёРјРµРЅРµРЅРёСЏ)
- [РџРѕСЃР»РµРґРЅРµРµ РѕР±РЅРѕРІР»РµРЅРёРµ](#РїРѕСЃР»РµРґРЅРµРµ-РѕР±РЅРѕРІР»РµРЅРёРµ)

---

## Р¦РµР»СЊ

РћРїРёСЃР°С‚СЊ РІРѕСЃСЃС‚Р°РЅРѕРІР»РµРЅРЅСѓСЋ Р°СЂС…РёС‚РµРєС‚СѓСЂСѓ РІРєР»Р°РґРєРё В«Р”Р°РЅРЅС‹РµВ»: Р·Р°РіСЂСѓР·РєР° С„СЂР°Р·, С„РёР»СЊС‚СЂР°С†РёСЏ, СЂРµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ Рё СЃРёРЅС…СЂРѕРЅРёР·Р°С†РёСЏ СЃ backend.

## Р”Р»СЏ РєРѕРіРѕ

- Frontend СЂР°Р·СЂР°Р±РѕС‚С‡РёРєРё (React/Zustand)
- Backend СЂР°Р·СЂР°Р±РѕС‚С‡РёРєРё, РїРѕРґРґРµСЂР¶РёРІР°СЋС‰РёРµ API `/api/data`
- QA, РїСЂРѕРІРµСЂСЏСЋС‰РёРµ РіСЂР°РЅРёС‡РЅС‹Рµ СЃС†РµРЅР°СЂРёРё
- РђРЅР°Р»РёС‚РёРєРё, СЂР°Р±РѕС‚Р°СЋС‰РёРµ СЃ РІС‹РіСЂСѓР·РєРѕР№ РґР°РЅРЅС‹С…

## РЎРІСЏР·Р°РЅРЅС‹Рµ РґРѕРєСѓРјРµРЅС‚С‹

- [09_TABS_OVERVIEW.md](./09_TABS_OVERVIEW.md) вЂ” РѕР±Р·РѕСЂ РІСЃРµС… РІРєР»Р°РґРѕРє РїСЂРёР»РѕР¶РµРЅРёСЏ
- [10_API_INTEGRATION.md](./10_API_INTEGRATION.md) вЂ” СЌРЅРґРїРѕРёРЅС‚С‹ `/api/data` Рё РёРЅС‚РµРіСЂР°С†РёСЏ СЃ backend
- [11_DATA_FLOW.md](./11_DATA_FLOW.md) вЂ” РїРѕС‚РѕРє РґР°РЅРЅС‹С… UI в†” API в†” Р‘Р” Рё real-time РѕР±РЅРѕРІР»РµРЅРёСЏ

---

## РђСЂС…РёС‚РµРєС‚СѓСЂР° РІРєР»Р°РґРєРё

```mermaid
graph TD
    A[DataTabLayout] --> B[Toolbar]
    A --> C[DataTable]
    A --> D[FiltersPanel]

    B --> E[Import CSV]
    B --> F[Export]
    B --> G[Bulk Actions]

    C --> H[Zustand dataStore]
    D --> H

    H -->|fetch| I[/api/data/phrases]
    H -->|mutations| J[/api/data/bulk]

    I --> K[SQLite freq_results]
    J --> K
```

---

## Р”РёР°РіСЂР°РјРјР° РІР·Р°РёРјРѕРґРµР№СЃС‚РІРёСЏ

```mermaid
sequenceDiagram
    participant User as РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ
    participant UI as Data Tab UI
    participant Store as Zustand Store
    participant API as FastAPI /api/data
    participant DB as SQLite DB
    
    User->>UI: Р¤РёР»СЊС‚СЂ РїРѕ СЂРµРіРёРѕРЅСѓ
    UI->>Store: setFilter(region=213)
    Store->>API: GET /api/data/phrases?region=213
    API->>DB: SELECT ... WHERE region_id=213
    DB-->>API: rows
    API-->>Store: JSON data
    Store-->>UI: РѕР±РЅРѕРІР»С‘РЅРЅР°СЏ С‚Р°Р±Р»РёС†Р°
    User->>UI: Р­РєСЃРїРѕСЂС‚ CSV
    UI->>Store: exportData()
    Store->>API: GET /api/data/export
    API-->>Store: CSV stream
    Store-->>User: РЎРєР°С‡Р°С‚СЊ С„Р°Р№Р»
```

---

## РљРѕРјРїРѕРЅРµРЅС‚С‹ РёРЅС‚РµСЂС„РµР№СЃР°

1. **Toolbar** вЂ” РёРјРїРѕСЂС‚ CSV, СЌРєСЃРїРѕСЂС‚, РјР°СЃСЃРѕРІС‹Рµ РґРµР№СЃС‚РІРёСЏ
2. **FiltersPanel** вЂ” С„РёР»СЊС‚СЂС‹ РїРѕ СЂРµРіРёРѕРЅСѓ, С‚РµРіР°Рј, РґР°С‚Р°Рј
3. **DataTable** вЂ” С‚Р°Р±Р»РёС†Р° С„СЂР°Р· Рё РјРµС‚СЂРёРє
4. **DetailsDrawer** вЂ” РїРѕРґСЂРѕР±РЅРѕСЃС‚Рё РїРѕ С„СЂР°Р·Рµ (РїСЂРё РЅР°Р»РёС‡РёРё)
5. **Notifications** вЂ” СѓСЃРїРµС…/РѕС€РёР±РєР° РѕРїРµСЂР°С†РёР№

---

## РЎРЅРёРїРїРµС‚С‹

### DataTab РєРѕРјРїРѕРЅРµРЅС‚

```typescript
// С„Р°Р№Р»: frontend/src/modules/data/App.tsx:TBD-TBD
```

### РЎРµР»РµРєС‚РѕСЂ РґР°РЅРЅС‹С… РёР· store

```typescript
// С„Р°Р№Р»: frontend/src/modules/data/store/useStore.ts:TBD-TBD
```

### API СЃР»РѕР№ РґР»СЏ РґР°РЅРЅС‹С…

```typescript
// С„Р°Р№Р»: frontend/src/modules/data/api/data.ts:TBD-TBD
```

### Р­РєСЃРїРѕСЂС‚ CSV РЅР° backend

```python
# С„Р°Р№Р»: backend/routers/data.py:TBD-TBD
```

---

## РўРёРїРѕРІС‹Рµ РѕС€РёР±РєРё

### вќЊ РћС€РёР±РєР°: В«Р¤СЂР°Р·С‹ РЅРµ РїРѕРґРіСЂСѓР¶Р°СЋС‚СЃСЏВ»

**РџСЂРёС‡РёРЅР°:** РќРµРєРѕСЂСЂРµРєС‚РЅР°СЏ СЃРёРЅС…СЂРѕРЅРёР·Р°С†РёСЏ С„РёР»СЊС‚СЂРѕРІ в†’ API.

**Р РµС€РµРЅРёРµ:**
- РџСЂРѕРІРµСЂРёС‚СЊ СЃРµСЂРёР°Р»РёР·Р°С†РёСЋ РїР°СЂР°РјРµС‚СЂРѕРІ Р·Р°РїСЂРѕСЃР°
- РЈР±РµРґРёС‚СЊСЃСЏ С‡С‚Рѕ backend РїРѕРґРґРµСЂР¶РёРІР°РµС‚ С„РёР»СЊС‚СЂ
- Р›РѕРіРёСЂРѕРІР°С‚СЊ payload РїРµСЂРµРґ Р·Р°РїСЂРѕСЃРѕРј

### вќЊ РћС€РёР±РєР°: В«Р­РєСЃРїРѕСЂС‚ РїСѓСЃС‚РѕР№В»

**РџСЂРёС‡РёРЅР°:** РЎРѕСЃС‚РѕСЏРЅРёРµ store РЅРµ СЃРѕРґРµСЂР¶РёС‚ Р°РєС‚СѓР°Р»СЊРЅС‹С… РґР°РЅРЅС‹С….

**Р РµС€РµРЅРёРµ:**
- РџРµСЂРµРґ СЌРєСЃРїРѕСЂС‚РѕРј РІС‹Р·РІР°С‚СЊ `fetchPhrases`
- РџСЂРѕРІРµСЂРёС‚СЊ С„РёР»СЊС‚СЂС‹ (region, tags)
- РЈР±РµРґРёС‚СЊСЃСЏ С‡С‚Рѕ API РІРѕР·РІСЂР°С‰Р°РµС‚ СЃС‚СЂРѕРєРё

### вќЊ РћС€РёР±РєР°: В«РќРµСЃРѕРіР»Р°СЃРѕРІР°РЅРЅРѕСЃС‚СЊ РґР°РЅРЅС‹С…В»

**РџСЂРёС‡РёРЅР°:** РћС‚СЃСѓС‚СЃС‚РІСѓРµС‚ РѕР±РЅРѕРІР»РµРЅРёРµ store РїРѕСЃР»Рµ РјСѓС‚Р°С†РёРё.

**Р РµС€РµРЅРёРµ:**
- РџРѕСЃР»Рµ POST/DELETE РІС‹Р·РІР°С‚СЊ `refresh`
- РСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РѕРїС‚РёРјРёСЃС‚РёС‡РЅРѕРµ РѕР±РЅРѕРІР»РµРЅРёРµ СЃ РѕС‚РєР°С‚РѕРј
- Р”РѕР±Р°РІРёС‚СЊ WebSocket СЃРёРЅС…СЂРѕРЅРёР·Р°С†РёСЋ (РµСЃР»Рё РґРѕСЃС‚СѓРїРЅРѕ)

---

## Р‘С‹СЃС‚СЂС‹Р№ СЃС‚Р°СЂС‚

### 1. Р—Р°РіСЂСѓР·РєР° РґР°РЅРЅС‹С… РїСЂРё РјРѕРЅС‚РёСЂРѕРІР°РЅРёРё

```typescript
useEffect(() => {
  fetchPhrases();
}, [fetchPhrases]);
```

### 2. РџСЂРёРјРµРЅРµРЅРёРµ С„РёР»СЊС‚СЂР°

```typescript
setFilters((prev) => ({
  ...prev,
  regionId: selectedRegion,
}));
```

### 3. Р­РєСЃРїРѕСЂС‚

```typescript
await exportPhrases({ format: 'csv', regionId });
```

---

## TL;DR

- Р’РєР»Р°РґРєР° В«Р”Р°РЅРЅС‹РµВ» РёСЃРїРѕР»СЊР·СѓРµС‚ Zustand store + React С‚Р°Р±Р»РёС†Сѓ
- Р¤РёР»СЊС‚СЂС‹ СЃРёРЅС…СЂРѕРЅРёР·РёСЂСѓСЋС‚СЃСЏ СЃ API РїР°СЂР°РјРµС‚СЂР°РјРё
- Р­РєСЃРїРѕСЂС‚ РґР°РЅРЅС‹С… РґРѕСЃС‚СѓРїРµРЅ РІ CSV/Excel
- РџРѕСЃР»Рµ РјСѓС‚Р°С†РёР№ С‚СЂРµР±СѓРµС‚СЃСЏ РѕР±РЅРѕРІР»РµРЅРёРµ store

---

## Р§РµРє-Р»РёСЃС‚ РїСЂРёРјРµРЅРµРЅРёСЏ

- [ ] Р—Р°РіСЂСѓР·РєР° РґР°РЅРЅС‹С… СЃ СЃРµСЂРІРµСЂР° СЂР°Р±РѕС‚Р°РµС‚
- [ ] Р¤РёР»СЊС‚СЂР°С†РёСЏ РїРѕ СЂРµРіРёРѕРЅСѓ Рё С‚РµРіР°Рј РєРѕСЂСЂРµРєС‚РЅР°
- [ ] РРјРїРѕСЂС‚/СЌРєСЃРїРѕСЂС‚ CSV РїСЂРѕС‚РµСЃС‚РёСЂРѕРІР°РЅ
- [ ] РњР°СЃСЃРѕРІС‹Рµ РѕРїРµСЂР°С†РёРё РѕР±РЅРѕРІР»СЏСЋС‚ С‚Р°Р±Р»РёС†Сѓ
- [ ] РћС€РёР±РєРё РѕС‚РѕР±СЂР°Р¶Р°СЋС‚СЃСЏ С‡РµСЂРµР· notifications
- [ ] WebSocket РѕР±РЅРѕРІР»СЏРµС‚ РёР·РјРµРЅРµРЅРёСЏ (РµСЃР»Рё РІРєР»СЋС‡С‘РЅ)
- [ ] РџРµСЂРµРєР»СЋС‡РµРЅРёРµ РІРєР»Р°РґРѕРє СЃРѕС…СЂР°РЅСЏРµС‚ state

---

## РџРѕСЃР»РµРґРЅРµРµ РѕР±РЅРѕРІР»РµРЅРёРµ

- **Р”Р°С‚Р°:** 2024-11-10
- **РћС‚РІРµС‚СЃС‚РІРµРЅРЅС‹Р№:** TBD
