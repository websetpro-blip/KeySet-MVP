# ПОЛНОЕ ОПИСАНИЕ РАБОТЫ AdsCreator v4.14 (Excel)

## Дата создания документа
2025-11-16

## Назначение
Подробное описание последовательности работы в AdsCreator v4.14.xlsb для точного воспроизведения в веб-интерфейсе.

---

## 📐 СТРУКТУРА ИНТЕРФЕЙСА

### ГЛАВНЫЙ ЭКРАН (Скриншот 1.png)

**Размеры окна Excel:**
- Ширина: ~1024px
- Высота: ~768px

**Левая панель (Колонка A):**
- Ширина: ~340px
- Фон: светло-голубой (#E6F2FF)

**Центральная панель (Колонка C-D):**
- Ширина: ~300px
- Содержит ID группы и ссылки

**Правая панель (Колонка E и далее):**
- Остальное пространство
- Инструкции и подсказки

---

## 🔄 ПОСЛЕДОВАТЕЛЬНОСТЬ ШАГОВ

### ШАГ 1: Ввод ключевых фраз (Скриншот 1.png)

**Элемент интерфейса:**
```
┌────────────────────────────────────────────────┐
│ Вставьте сюда ключевики (можно                │
│ с минус-словами -максимум 8192                │
│           символа)                             │
│                                                │
│  [Большая голубая область для ввода]          │
│                                                │
│  система очистки воды из скважины для частного│
│  система умягчения и обезжелезивания воды     │
│  Очистка воды в загородном доме до питьевой   │
│  очистка воды аэрацией                        │
│  установка умягчения воды                     │
│  фильтр для воды от железа для скважины       │
│  ...                                           │
└────────────────────────────────────────────────┘
```

**Характеристики:**
- Фон: #E6F2FF (светло-голубой)
- Текст: синий, жирный
- Размер шрифта: 12pt
- Padding: 10px
- Высота: ~400px
- Multiline textarea
- Максимум символов: 8192
- Максимум строк: 1000

**Кнопки рядом:**
- "Меню" (серая, слева вверху)
- "Техподдержка" (серая, рядом с Меню)
- "Создать еще одну РК" (синяя, под Меню)

**Справа от поля ввода:**
```
┌─────────────────────────────────────────────┐
│  ID группы                                  │
│  (только если вы редактируете старые        │
│   объявления, если нет - оставьте как есть) │
│                                             │
│  Проверка длины ключевиков, максимум 8192   │
│  символа                                    │
└─────────────────────────────────────────────┘
```

**Еще правее - инструкция (желтый фон):**
```
┌─────────────────────────────────────────────┐
│ Вставляйте сюда ссылки на страницы         │
│ (если трафик идет на 1 страничку, то       │
│ просто вставьте одну ссылку к в ячейку     │
│ E3). Свои UTM-метки сюда вставлять         │
│ не надо. Они будут сгенерированы           │
│ программой.                                 │
└─────────────────────────────────────────────┘
```

**Колонки D-E показывают:**
- Колонка D: цифры (45, 45, 42, 21, 24...) - длина ключей
- Колонка E: nordkor.ru для каждого ключа

---

### ШАГ 2: Добавление к заголовку №2 (Скриншот 2.png)

**Элемент интерфейса:**
```
┌────────────────────────────────────────────────┐
│           << Введите прибавки к ЗАГОЛОВКУ №2,  │
│              до 20-ти штук                     │
│                                                │
│  Максимальная длина не более:  [30]           │
│                                                │
│  Рекомендуем в прибавках использовать самый   │
│  сильный аргумент                             │
│                                                │
│  почему клиент должен нажать именно на Ваше   │
│  объявление, так как они попадут в заголовок  │
│  объявления                                    │
│                                                │
│  либо же в самых коротких прибавках           │
│  используйте призывы к действию, как вы       │
│  видите в примере слева                       │
│                                                │
│  Также, рекомендуем писать один и тот же      │
│  аргумент все более сжато и сжато, вместо     │
│  того, чтобы в каждой строке писать что-то    │
│  разное: ведь прибавки будут подставляться в  │
│  зависимости от того, сколько свободного      │
│  места останется после основного тела         │
│  ключевика. Получится почти рандом.           │
│                                                │
│  А рандом противоречит идее о том что нужно   │
│  использовать главное приемущество!           │
│                                                │
│  Да-да, мы читали хеля Яндекса о том, что    │
│  заголовок №2 может не подтянутся, тут все   │
│  расчитано, он подтянется 100%                │
└────────────────────────────────────────────────┘
```

**Слева - таблица прибавок:**
```
┌──────────────────────────────────┬─────────┐
│ Меню       │ Техподдержка        │ Длина   │
├────────────┴─────────────────────┼─────────┤
│ система под ключ за 70 190р!     │   27    │
│ обезжелезиватели от 16 90р!      │   26    │
│ система за 70 190р!              │   18    │
│ фильтры от 16 90р!               │   17    │
│ всего за 16 90р!                 │   15    │
│ за 16 90р!                       │    9    │
└──────────────────────────────────┴─────────┘
```

**Характеристики:**
- Левая таблица: ширина ~340px
- Колонка "Длина" показывает количество символов
- Максимум 20 вариантов
- Каждый вариант - до 30 символов
- Сортировка: от длинного к короткому (это важно!)

**Кнопки навигации внизу:**
- "Назад" (серая, слева)
- "Далее" (серая, справа)

---

### ШАГ 3: Варианты текста (Скриншот 3.png)

**Элемент интерфейса:**
```
┌────────────────────────────────────────────────┐
│  Варианты текста                               │
│                                                │
│  Ответьте на 5 вопросов и узнайте стоимость   │
│  системы очистки воды в 3-х вариантах!        │
│                                                │
│  Системы очистки воды для загородного дома.   │
│  Рассчитайте стоимость на сайте!              │
│                                                │
│  Подберите систему очистки воды, которая      │
│  подойдет именно Вам!                         │
│                                                │
│  [Пустые строки для дополнительных вариантов] │
└────────────────────────────────────────────────┘
```

**Справа - лимиты:**
```
┌─────────────────────────────────────────┐
│  Введите 2 варианта ТЕКСТА ОБЪЯВЛЕНИЙ   │
│                                         │
│  << Ограничения:                        │
│  81 для Яндекс.Директ                  │
│  80 для Google Adwords                 │
│                                         │
│  Подсчёт символов для обоих систем     │
│  разный!                                │
│                                         │
│  Раньше мы рекомендовали вам           │
│  использовать в текстах самые          │
│  распространенные слова из вашей       │
│  рекламной кампании, чтобы хотя бы     │
│  одно точно попало в текст объявления. │
│                                         │
│  Теперь не рекомендуем, это теперь     │
│  работает наоборот!                    │
│                                         │
│  Также рекомендуем использовать Call   │
│  to action                              │
└─────────────────────────────────────────┘
```

**Характеристики:**
- Левая панель: textarea с вариантами текста
- Каждый вариант с новой строки
- Лимит: 81 символ для Яндекс.Директ
- Цвет текста лимита Яндекс: красный
- Цвет текста лимита Google: зеленый
- Справа - колонки ЯД и GA с подсчетом символов

**Кнопки навигации:**
- "Назад"
- "Далее"

---

### ШАГ 4: Редактирование заголовков (Скриншот 4.png)

**Элемент интерфейса (3 колонки):**

**ЛЕВАЯ КОЛОНКА (список ключей):**
```
┌──────────────────────────────────────────┐
│  Нажмите на кнопку Обработать,           │
│  редактируйте заголовок №1 используя     │
│  правила подмены и переноса или вручную  │
│                                          │
│  Система очистки воды из скважины!       │
│  Система умягчения и обезжелезивания!   │
│  Очистка воды в загородном доме!        │
│  Очистка воды аэрацией!                 │
│  Установка умягчения воды!              │
│  Фильтр для воды от железа!             │
│  ...                                     │
│                                          │
│  [Кнопка "Обработать"]                   │
└──────────────────────────────────────────┘
```

**ЦЕНТРАЛЬНАЯ КОЛОНКА (редактирование H2):**
```
┌──────────────────────────────────────────┐
│  Редактируйте заголовок №2               │
│  правила применяются к нему также        │
│                                          │
│  Для частного!                           │
│  Воды!                                   │
│  До питьевой!                            │
│                                          │
│  Для скважины!                           │
│  ...                                     │
│  Из скважины!                            │
└──────────────────────────────────────────┘
```

**Показаны 2 столбца с длинами:**
- "Длина заголовка №1 не более 35 символов" (зеленая галочка если ОК)
- "Длина №1+2 не более 65 символов" (зеленая галочка если ОК)

**ПРАВАЯ КОЛОНКА (предпросмотр):**
```
┌──────────────────────────────────────────┐
│  У вас много вопросов?                   │
│  Техподдержки не достаточно?             │
│  Индивидуальный разбор?                  │
│  Нужна консультация?                     │
│                                          │
│  [S] Заказать Skype-консультацию        │
│                                          │
│  Предпросмотр заголовков                 │
│  ────────────────────────────            │
│  Система очистки воды из скважины! —     │
│  Для частного!                           │
│                                          │
│  Система умягчения и обезжелезивания! —  │
│  Воды! - за 16 90р!                     │
│  ...                                     │
└──────────────────────────────────────────┘
```

**Кнопки навигации:**
- "Обработать" (в левой колонке)
- "Далее" (серая кнопка внизу справа)

---

### ШАГ 5: Предпросмотр как в Яндексе (Скриншот 5.png - САМЫЙ ВАЖНЫЙ!)

**Интерфейс разделен на 2 части:**

**ЛЕВАЯ ПАНЕЛЬ (управление, ~280px):**
```
┌────────────────────────────────────┐
│  [Назад]                           │
│                                    │
│  ⊕ Быстрые ссылки          →      │
│  ⊕ Отображ. ссылка         →      │
│  ⊕ Уточнения               →      │
│                                    │
│  Адреса быстрых ссылок     →      │
│  Якоря быстрых ссылок      →      │
│  ⊕ Описания быстрых ссылок →      │
│                                    │
│  [Читайте пометки ^]               │
└────────────────────────────────────┘
```

**ПРАВАЯ ПАНЕЛЬ (предпросмотр Яндекса, ~740px):**
```
┌─────────────────────────────────────────────────────────────┐
│  [Яндекс лого]  система очистки воды из скважины для частного │
│                 [поиск]                     [Найти]          │
│  ПОИСК | КАРТИНКИ | ВИДЕО | КАРТЫ | МАРКЕТ | НОВОСТИ | ЕЩЁ │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ≫ Система очистки воды из скважины! — Для частного!       │
│     (синий цвет, 18px, жирный)                             │
│                                                             │
│  [Распродажа] nordkor.ru/ скидка 30% до 15.05 | Видео отзывы | Заказать │
│     (зеленый цвет, 13px)                                   │
│     ([Распродажа] в зеленой рамке)                         │
│                                                             │
│  система очистки воды                                       │
│  Ответьте на 5 вопросов и узнайте стоимость системы очистки │
│  воды в 3-х вариантах!                                     │
│     (черный текст, 14px)                                   │
│                                                             │
│  [Быстрая доставка] [Гарантия] [Отзывы клиентов] [Без предоплат] │
│     (серые чипы, 12px, border-radius: 12px)                │
│                                                             │
│  Контактная информация · +7 (800) 0000-000 · пн-пт 9:00-18:00, сб 9:30-17:00 │
│  м. Невский Проспект · Санкт-Петербург                     │
│     (серый текст, 12px)                                    │
│                                                             │
│  ┌─────────────┬─────────────┬──────────────┬──────────────┐ │
│  │ nordkor.ru  │ nordkor.ru  │ nordkor.ru   │ nordkor.ru   │ │
│  │ #1          │ #2          │ #3           │ #4           │ │
│  │ Бесплатная  │ Подбор      │ Монтаж за    │ 15 лет на    │ │
│  │ консультация│ on-line     │ 1 день       │ рынке        │ │
│  └─────────────┴─────────────┴──────────────┴──────────────┘ │
│     (таблица 4 колонки, синие ссылки)                      │
│                                                             │
│  Отображаемая ссылка динамическая (да/нет)? да             │
│     (мелкий серый текст внизу)                             │
└─────────────────────────────────────────────────────────────┘
```

**КРИТИЧЕСКИ ВАЖНЫЕ ДЕТАЛИ:**

**Заголовок:**
- Цвет: #0066FF (синий)
- Размер: 18px
- Font-weight: bold
- Формат: `≫ {H1} — {H2}`
- Symbol `≫` обязателен!

**Отображаемая ссылка:**
- Цвет: #06884A (зеленый)
- Размер: 13px
- Формат: `[Префикс] домен/путь постфикс`
- [Префикс] в зеленой рамке (border: 1px solid #06884A)

**Текст объявления:**
- Цвет: #000 (черный)
- Размер: 14px
- Line-height: 1.4

**Уточнения (чипы):**
- Background: #F0F0F0
- Border: 1px solid #DDD
- Border-radius: 12px
- Padding: 4px 10px
- Font-size: 12px
- Margin: 4px

**Быстрые ссылки (таблица):**
- 4 колонки равной ширины
- Border: 1px solid #E0E0E0
- Padding: 8px
- Цвет домена: #06884A (зеленый)
- Цвет #1, #2, #3, #4: серый
- Цвет текста ссылки: #0066FF (синий)

**Контакты:**
- Цвет: #666 (серый)
- Размер: 12px
- Разделитель: ` · `

---

### ШАГ 6: Финальная таблица (Скриншот 6.png)

**Структура таблицы (очень широкая, горизонтальный скролл):**

**Колонки (слева направо):**
1. Техподдержка (выпадающий список)
2. Название кампании
3. Добавить в существующую группу
4. ID Кампании
5. Название группы
6. Номер группы
7. Статус "Мало показов"
8. ID фразы
9. Ключевик словами
10. Фраза (с минус словами)
11. ID Объявления
12. Заголовок 1
13. Заголовок 2
14. Текст объявления
15. Ссылка
16. Отображаемая ссылка
17. Регион
18. Ставка на Поиск
19. Статус объявления
20. Статус фразы
21. Текст
22. Ссылка
23. Отображаемая ссылка
24. Регион
25. Ставка на РСЯ
26. Статус объявления РСЯ
27. Отзывы фразы
28. Па
29. Па
30. Ме
31. т
32. Изображения
33. Уточнения
34. ...много других колонок...

**Характеристики:**
- Общая ширина таблицы: ~3000px+
- Высота заголовков: ~80px (многострочные)
- Высота строки данных: ~24px
- Font-size: 11px
- Border: 1px solid #E0E0E0
- Фон заголовков: #F8F9FA
- Фон строк: чередуется белый/светло-серый

**Данные в строках:**
- "ПОИСК:" в первой колонке (жирный)
- ID группы, ID фразы, ID объявления - пустые (заполнятся при загрузке)
- Все ключи и объявления идут построчно
- ~30+ строк видно на экране

**Внизу - вкладки:**
- "Главная"
- "AdsCreator"
- "Параметры"
- "Яндекс Директ"
- "Google Adwords"

---

## 🎨 ЦВЕТОВАЯ СХЕМА

### Основные цвета:
- **Фон панелей:** #E6F2FF (светло-голубой)
- **Фон инструкций:** #FFFACD (светло-желтый)
- **Текст заголовков:** #0066FF (синий)
- **Текст обычный:** #000000 (черный)
- **Текст подсказок:** #666666 (серый)
- **Отображаемая ссылка:** #06884A (зеленый)
- **Лимит Яндекс:** #FF0000 (красный)
- **Лимит Google:** #00AA00 (зеленый)

### Границы и рамки:
- **Border color:** #E0E0E0 (светло-серый)
- **Border width:** 1px
- **Border radius (кнопки):** 6px
- **Border radius (чипы):** 12px

---

## 📏 РАЗМЕРЫ ЭЛЕМЕНТОВ

### Кнопки:
- **Высота:** 32px
- **Padding:** 8px 16px
- **Font-size:** 12px
- **Border-radius:** 6px
- **Margin:** 4px

### Input поля:
- **Высота:** 28px
- **Padding:** 4px 8px
- **Font-size:** 12px
- **Border:** 1px solid #DDD

### Textarea:
- **Min-height:** 60px
- **Padding:** 8px
- **Font-size:** 12px
- **Line-height:** 1.4

### Таблица:
- **Header height:** 80px (multiline)
- **Row height:** 24px
- **Cell padding:** 4px 6px
- **Font-size:** 11px

---

## 🔢 ЛИМИТЫ (Яндекс.Директ)

```javascript
const LIMITS = {
  H1: 56,           // Заголовок 1
  H2: 56,           // Заголовок 2
  H1_H2_SUM: 65,    // Сумма H1 + " — " + H2
  TEXT: 81,         // Текст объявления
  PATH: 20,         // Отображаемый путь
  CLAR: 66,         // Одно уточнение
  CLAR_MAX: 4,      // Максимум уточнений
  SL_TEXT: 30,      // Текст быстрой ссылки
  SL_DESC: 60,      // Описание быстрой ссылки
  SL_MAX: 4,        // Максимум быстрых ссылок
  KEYS_CHARS: 8192, // Максимум символов в поле ключей
  KEYS_COUNT: 1000, // Максимум ключевых фраз
  H2_ADDITIONS: 20  // Максимум вариантов добавления к H2
};
```

---

## 🔄 ЛОГИКА РАЗБИЕНИЯ H1/H2

### Алгоритм:
```javascript
function splitH1H2(key, h2Additions) {
  const words = key.split(' ');
  let h1 = '';
  let i = 0;

  // Собираем H1 по словам пока <= 56
  for (; i < words.length; i++) {
    const candidate = (h1 ? h1 + ' ' : '') + words[i];
    if (candidate.length <= 56) {
      h1 = candidate;
    } else {
      break;
    }
  }

  // Остаток идет в H2
  const leftover = words.slice(i).join(' ');

  // Если есть остаток - ищем подходящую добавку
  if (leftover) {
    // Первая буква заглавная
    const leftoverCap = leftover[0].toUpperCase() + leftover.slice(1);

    // Вычисляем доступное место для H2
    const available = 65 - h1.length - 3; // -3 это " — "

    // Ищем самую длинную добавку что поместится
    let suffix = '';
    for (const addition of h2Additions) {
      if (leftoverCap.length + 3 + addition.length <= available) {
        suffix = addition;
        break;
      }
    }

    h2 = suffix ? `${leftoverCap} - ${suffix}` : leftoverCap + '!';
  } else {
    // Нет остатка - берем только добавку
    const available = 65 - h1.length - 3;
    let suffix = '';
    for (const addition of h2Additions) {
      if (addition.length <= available) {
        suffix = addition;
        break;
      }
    }
    h2 = suffix || '';
  }

  return {
    h1: h1 + '!',
    h2: h2.endsWith('!') ? h2 : h2 + '!'
  };
}
```

---

## 📋 ФОРМАТ ЭКСПОРТА CSV

### Заголовки (точный порядок):
```
Кампания;Группа;Ключевая фраза;Заголовок 1;Заголовок 2;Текст;Ссылка;Отображаемая ссылка;Уточнения;SL1;SL1 URL;SL1 Anchor;SL1 Desc;SL2;SL2 URL;SL2 Anchor;SL2 Desc;SL3;SL3 URL;SL3 Anchor;SL3 Desc;SL4;SL4 URL;SL4 Anchor;SL4 Desc
```

### Кодировка:
- UTF-8 с BOM (`\uFEFF`)
- Разделитель: `;`
- Экранирование: двойные кавычки для полей с `;` или `\n`

### Пример строки:
```csv
AUTO-2025-11-16;система очистки воды из скважины для частного;система очистки воды из скважины для частного;Система очистки воды из скважины!;Для частного!;Ответьте на 5 вопросов и узнайте стоимость системы очистки воды в 3-х вариантах!;https://nordkor.ru?utm_source=yandex&utm_medium=cpc&utm_campaign={campaign_id}&utm_term={keyword};nordkor.ru/sistema-ochistki-vody;Быстрая доставка | Гарантия | Отзывы клиентов | Без предоплат;Бесплатная консультация;https://nordkor.ru#1;catalog;Все модели;Подбор on-line;https://nordkor.ru#2;price;Акции и скидки;Монтаж за 1 день;https://nordkor.ru#3;delivery;За 1 день;15 лет на рынке;https://nordkor.ru#4;contacts;Звонок бесплатно
```

---

## ✅ ЧЕКЛИСТ ДЛЯ ВЕБ-ВЕРСИИ

### Обязательно должно быть:

1. ✅ Левая панель (280-320px) с секциями:
   - Ключевые фразы (textarea, 8192 символов)
   - Домен + UTM
   - Шаблоны H1/H2
   - Текст объявления
   - Единые настройки (раскрывающиеся блоки):
     - Быстрые ссылки (4 шт)
     - Уточнения (4 шт)
     - Отображаемая ссылка (префикс/постфикс)
     - Контакты

2. ✅ Правая панель с:
   - Toolbar (кнопки управления)
   - Excel-таблица (все колонки, inline редактирование)
   - Предпросмотр "как в Яндексе" (sticky, компактный)

3. ✅ Функциональность:
   - Генерация объявлений
   - Разбиение H1/H2 по алгоритму
   - Применение единых настроек ко всем
   - Режим копирования
   - Экспорт CSV (Direct Commander формат)
   - Кнопка "Сгенерировать с ИИ"

4. ✅ Валидация:
   - Подсветка превышения лимитов
   - Кнопка "Подрезать по лимитам"
   - Счетчики символов

5. ✅ UX:
   - Resizable columns
   - Sticky headers
   - LocalStorage для черновика
   - Быстрое копирование (TSV, только ключи)

---

## 🎯 ИТОГ

Этот документ содержит ВСЮ информацию для точного воспроизведения AdsCreator v4.14 в веб-интерфейсе:
- Размеры всех элементов
- Цвета и шрифты
- Последовательность шагов
- Алгоритмы работы
- Формат экспорта

Следующий шаг: создать HTML версию с точным соблюдением всех этих параметров.
